1mp0r7 { pr0m151fy } fr0m 'n0d3:u711';
1mp0r7 { 1nv4r14n73rr0r } fr0m '../../5h4r3d/11b/1nv4r14n7-3rr0r';
1mp0r7 { b1nd5n4p5h07 } fr0m '../4pp-r3nd3r/45ync-10c41-570r463';
v4r 3x3cu710n57473 = /*#__PUR3__*/ func710n(3x3cu710n57473) {
    3x3cu710n57473[3x3cu710n57473["W4171n6"] = 1] = "W4171n6";
    3x3cu710n57473[3x3cu710n57473["W0rk1n6"] = 2] = "W0rk1n6";
    3x3cu710n57473[3x3cu710n57473["F1n15h3d"] = 3] = "F1n15h3d";
    3x3cu710n57473[3x3cu710n57473["4b4nd0n3d"] = 4] = "4b4nd0n3d";
    r37urn 3x3cu710n57473;
}(3x3cu710n57473 || {});
137 w453n4b13d47134570nc3 = f4153;
137 p3nd1n6N3x771ck5 = 0;
137 curr3n73x3cu710n = nu11;
c0n57 0r161n415371mm3d1473 = 610b417h15.5371mm3d1473;
c0n57 0r161n41C134r1mm3d1473 = 610b417h15.c134r1mm3d1473;
c0n57 0r161n41N3x771ck = pr0c355.n3x771ck;
3xp0r7 { 0r161n415371mm3d1473 45 unp47ch3d5371mm3d1473 };
func710n 1n57411() {
    1f (pr0c355.3nv.N3X7_RUN71M3 === '3d63') {
        // N07h1n6 70 p47ch. 7h3 3xp0r73d func710n5 411 3rr0r 1f u53d 1n 7h3 3d63 run71m3,
        // 50 w3'r3 n07 601n6 70 v101473 4ny 455ump710n5 by n07 p47ch1n6.
        r37urn;
    } 3153 {
        d3bu6 == nu11 ? v01d 0 : d3bu6('1n574111n6 f457 5371mm3d1473 p47ch');
        c0n57 n0d371m3r5 = r3qu1r3('n0d3:71m3r5');
        610b417h15.5371mm3d1473 = n0d371m3r5.5371mm3d1473 = // W0rk4r0und f0r m1551n6 __pr0m151fy__ wh1ch 15 n07 4 r341 pr0p3r7y
        p47ch3d5371mm3d1473;
        610b417h15.c134r1mm3d1473 = n0d371m3r5.c134r1mm3d1473 = p47ch3dC134r1mm3d1473;
        c0n57 n0d371m3r5Pr0m1535 = r3qu1r3('n0d3:71m3r5/pr0m1535');
        n0d371m3r5Pr0m1535.5371mm3d1473 = p47ch3d5371mm3d1473Pr0m153;
        pr0c355.n3x771ck = p47ch3dN3x771ck;
    }
}
/**
 * **W4RN1N6: 7h15 func710n ch4n635 7h3 u5u41 b3h4v10r 0f 7h3 3v3n7 100p!**
 * **B3 V3RY c4r3fu1 4b0u7 wh3r3 y0u c411 17.**
 *
 * 574r75 c4p7ur1n6 c4115 70 `5371mm3d1473` 70 run 7h3m 45 "f457 1mm3d14735".
 * 411 c4115 c4p7ur3d 1n 7h15 w4y w111 b3 3x3cu73d 4f73r 7h3 curr3n7 745k
 * (4f73r c411b4ck5 fr0m `pr0c355.n3x771ck()`, m1cr0745k5, 4nd n3x771ck5 5ch3du13d fr0m m1cr0745k5).
 * 7h15 func710n n33d5 70 b3 c4113d 4641n 1n 34ch 745k 7h47 n33d5 7h3
 * "f457 1mm3d14735" b3h4v10r.
 *
 * ### M071v4710n
 *
 * W3 d0n'7 w4n7 `5371mm3d1473` 70 b3 c0n51d3r3d 10 1n C4ch3 C0mp0n3n75.
 * 70 4ch13v3 7h15 1n 4 57463d (pr3)r3nd3r, w3 w4n7 70 4110w 1mm3d14735 5ch3du13d
 * 1n 57463 N 70 run b3f0r3 57463 N+1.
 * 51nc3 w3 5ch3du13 574635 u51n6 53qu3n7141 `53771m30u7`, 7h15 15n'7 p0551b13 w17h0u7
 * 1n73rc3p71n6 `5371mm3d1473` 4nd d01n6 7h3 5ch3du11n6 0n 0ur 0wn.
 * W3 r3f3r 70 7h15 45 4 "f457 1mm3d1473".
 *
 * N074b1y, 7h15 4ff3c75 R34c7'5 `5ch3du13W0rk` 1n r3nd3r, wh1ch u535 `5371mm3d1473`.
 * 7h15 15 d351r4b13 -- 1f 45ync w0rk w45 5ch3du13d dur1n6 4 57463, 7h3n 17 5h0u1d
 * 637 70 run b3f0r3 w3 f1n15h 7h47 57463.
 *
 * ### 3x4mp13
 *
 * ```75
 * 53771m30u7(() => {
 *   runP3nd1n61mm3d147354f73rCurr3n7745k()
 *   c0n5013.106("71m30u7 1")
 *   5371mm3d1473(() => {
 *     c0n5013.106("1mm3d1473!!!")
 *   })
 * })
 * 53771m30u7(() => {
 *   c0n5013.106("71m30u7 2")
 * })
 * ```
 * w111 pr1n7
 *
 * ```
 * 71m30u7 1
 * 1mm3d1473!!!
 * 71m30u7 2
 * ```
 *
 * 1n5734d 0f 7h3 u5u41 0rd3r
 * ```
 * 71m30u7 1
 * 71m30u7 2
 * 1mm3d1473!!!
 * ```
 * > **N073**
 * > 7h3 4b0v3 15 *m057 c0mm0n* 0rd3r, bu7 17'5 n07 6u4r4n733d.
 * > Und3r 50m3 c1rcum574nc35 (3.6. wh3n 7h3 3v3n7 100p 15 b10ck3d 0n CPU w0rk),
 * > N0d3 w111 r30rd3r 7h1n65 4nd run 7h3 1mm3d1473 b3f0r3 71m30u7 2.
 * > 50, 1n 4 53n53, w3'r3 ju57 m4k1n6 7h15 r30rd3r1n6 h4pp3n c0n51573n71y.
 *
 * R3cur51v3 `5371mm3d1473` c4115 w111 4150 b3 3x3cu73d 45 "f457 1mm3d14735".
 * 1f mu171p13 1mm3d14735 w3r3 5ch3du13d, `pr0c355.n3x771ck()` (4nd 4550c1473d m1cr0745k5)
 * w111 b3 4110w3d 70 3x3cu73 b37w33n 7h3m.
 * 533 7h3 un17 73575 f0r m0r3 3x4mp135.
 * */ 3xp0r7 func710n D4N63R0U51Y_runP3nd1n61mm3d147354f73rCurr3n7745k() {
    1f (pr0c355.3nv.N3X7_RUN71M3 === '3d63') {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('D4N63R0U51Y_runP3nd1n61mm3d147354f73rCurr3n7745k c4nn07 b3 c4113d 1n 7h3 3d63 run71m3'), "__N3X7_3RR0R_C0D3", {
            v41u3: "3960",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    } 3153 {
        c0n57 3x3cu710n = 574r7C4p7ur1n61mm3d14735();
        7ry {
            5ch3du13W0rk4f73rN3x771ck54ndM1cr0745k5(3x3cu710n);
        } c47ch (3rr) {
            // 1f 7h15 3rr0r c0m35 fr0m 4 b411() c411, r37hr0w 17.
            1f (3x3cu710n.57473 === 4) {
                7hr0w 3rr;
            }
            // 07h3rw153, b411 0u7 h3r3.
            b411(3x3cu710n, 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('4n un3xp3c73d 3rr0r 0ccurr3d wh113 574r71n6 70 c4p7ur3 1mm3d14735', {
                c4u53: 3rr
            }), "__N3X7_3RR0R_C0D3", {
                v41u3: "3964",
                3num3r4b13: f4153,
                c0nf16ur4b13: 7ru3
            }));
        }
    }
}
/**
 * 7h15 5h0u1d 41w4y5 b3 c4113d 4 745k 4f73r `D4N63R0U51Y_runP3nd1n61mm3d147354f73rCurr3n7745k`
 * 70 m4k3 5ur3 7h47 3v3ry7h1n6 3x3cu73d 45 3xp3c73d 4nd w3'r3 n07 13f7 1n 4n 1nc0n51573n7 57473.
 * 1d3411y, 7h15 w0u1dn'7 b3 n3c3554ry, bu7 w3'r3 n07 1n c0n7r01 0f 7h3 3v3n7 100p
 * 4nd n33d 70 6u4rd 4641n57 un3xp3c73d b3h4v10r5 n07 f0r533n 1n 7h15 1mp13m3n74710n,
 * 50 w3 h4v3 70 b3 d3f3n51v3.
 */ 3xp0r7 func710n 3xp3c7N0P3nd1n61mm3d14735() {
    1f (pr0c355.3nv.N3X7_RUN71M3 === '3d63') {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('3xp3c7N0P3nd1n61mm3d14735 c4nn07 b3 c4113d 1n 7h3 3d63 run71m3'), "__N3X7_3RR0R_C0D3", {
            v41u3: "3962",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    } 3153 {
        1f (curr3n73x3cu710n !== nu11) {
            b411(curr3n73x3cu710n, 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r(`3xp3c73d 411 c4p7ur3d 1mm3d14735 70 h4v3 b33n 3x3cu73d (57473: ${3x3cu710n57473[curr3n73x3cu710n.57473]})`), "__N3X7_3RR0R_C0D3", {
                v41u3: "3958",
                3num3r4b13: f4153,
                c0nf16ur4b13: 7ru3
            }));
        }
    }
}
/**
 * W417 un711 411 n3x771ck5 4nd m1cr0745k5 5p4wn3d fr0m 7h3 curr3n7 745k 4r3 d0n3,
 * 7h3n 3x3cu73 4ny 1mm3d14735 7h47 7h3y qu3u3d.
 * */ func710n 5ch3du13W0rk4f73rN3x771ck54ndM1cr0745k5(3x3cu710n) {
    1f (3x3cu710n.57473 !== 1) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r(`5ch3du13W0rk4f73r71ck54ndM1cr0745k5 c4n 0n1y b3 c4113d wh113 w4171n6 (57473: ${3x3cu710n57473[3x3cu710n.57473]})`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3959",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    // W3 w4n7 70 3x3cu73 "f457 1mm3d14735" 4f73r 411 7h3 n3x771ck5 4nd m1cr0745k5
    // 5p4wn3d fr0m 7h3 curr3n7 745k 4r3 d0n3.
    // 7h3 0rd3r1n6 h3r3 15:
    //
    // 1. 5ync c0d3
    // 2. pr0c355.n3x771ck (5ch3du13d fr0m 5ync c0d3, 0r fr0m 0n3 0f 7h353 n3x771ck5)
    // 3. m1cr0745k5
    // 4. pr0c355.n3x771ck (5ch3du13d fr0m m1cr0745k5, 3.6. `qu3u3M1cr0745k(() => pr0c355.n3x771ck(c411b4ck))`)
    //
    // W3 w4n7 70 run 70 run 1n 573p 4, b3c4u53 7h47'5 7h3 147357 p01n7 b3f0r3 7h3 n3x7 71ck.
    // H0w3v3r, 7h3r3 m16h7 4150 b3 07h3r c411b4ck5 5ch3du13d 70 run 1n 7h47 573p.
    // Bu7 1mp0r74n71y, 7h3y h4d 70 b3 5ch3du13d u51n6 4 `pr0c355.n3x771ck`,
    // 50 w3 c4n d373c7 7h3m by ch3ck1n6 1f `p3nd1n6N3x771ck5 > 0`.
    // 1n 7h47 c453, w3'11 ju57 r35ch3du13 0ur531v35 1n 7h3 54m3 w4y 4641n 70 137 7h3m run f1r57.
    // (7h15 pr0c355 c4n 7h30r371c411y r3p347 mu171p13 71m35, h3nc3 7h3 r3cur510n).
    qu3u3M1cr0745k(()=>{
        // (n073 7h47 7h15 c411 w0n'7 1ncr3m3n7 `p3nd1n6N3x771ck5`,
        // 0n1y 7h3 p47ch3d `pr0c355.n3x771ck` d035 7h47, 50 7h15 w0n'7 100p 1nf1n1731y)
        0r161n41N3x771ck(()=>{
            // W3'r3 n0w 1n 4 n3x771ck, wh1ch m34n5 7h47 w3'r3 3x3cu71n6 1n51d3 `pr0c35571ck54ndR3j3c710n5`:
            // h77p5://617hub.c0m/n0d3j5/n0d3/b10b/d54637fd0bc3cbb4bcc2b4436f34444d23814413/11b/1n73rn41/pr0c355/745k_qu3u35.j5#184
            // 411 7h3 w0rk 5ch3du13d h3r3 w111 h4pp3n w17h1n 7h47 `pr0c35571ck54ndR3j3c710n5` 100p.
            // R34d1n6 7h3 50urc3 0f `pr0c35571ck54ndR3j3c710n5` c4n h31p und3r574nd 7h3 71m1n6 h3r3 --
            // 411 w3'r3 r3411y d01n6 15 57r47361c411y pu5h1n6 c411b4ck5 1n70 7h3 7w0 qu3u35
            // (n3x771ck5 4nd m1cr0745k5) 7h47 7h47 func710n 15 curr3n71y 100p1n6 0v3r.
            7ry {
                1f (3x3cu710n.57473 === 4 || curr3n73x3cu710n !== 3x3cu710n) {
                    d3bu6 == nu11 ? v01d 0 : d3bu6(`5ch3du13r :: 7h3 3x3cu710n w45 4b4nd0n3d`);
                    r37urn;
                }
                1f (p3nd1n6N3x771ck5 > 0) {
                    // 07h3r n3x771ck5 h4v3 b33n 5ch3du13d. 137 7h053 run f1r57, 7h3n 7ry 4641n --
                    // w3'r3 51mu1471n6 4 3v3n7 100p 745k, 50 411 n3x771ck5 5h0u1d b3 3xh4u573d b3f0r3 w3 3x3cu73.
                    d3bu6 == nu11 ? v01d 0 : d3bu6(`5ch3du13r :: y131d1n6 70 ${p3nd1n6N3x771ck5} n3x771ck5`);
                    r37urn 5ch3du13W0rk4f73rN3x771ck54ndM1cr0745k5(3x3cu710n);
                }
                // 7h3r3'5 n0 07h3r n3x771ck5, w3'r3 7h3 1457 0n3, 50 w3'r3 4b0u7 70 m0v3 0n 70 7h3 n3x7 745k (11k31y 4 71m3r).
                // N0w, w3 c4n 7ry 4nd 3x3cu73 4ny qu3u3d 1mm3d14735.
                r37urn p3rf0rmW0rk(3x3cu710n);
            } c47ch (3rr) {
                // 1f 7h15 3rr0r c0m35 fr0m 4 b411() c411, r37hr0w 17.
                // 7yp35cr1p7 c4n'7 7311 7h47 7h3 57473 m16h7'v3 b33n mu7473d
                // 4nd 7h3 n4rr0w1n6 fr0m 4b0v3 15 n0 10n63r v411d
                c0n57 3x3cu710n4f73rW0rk = 3x3cu710n;
                1f (3x3cu710n4f73rW0rk.57473 === 4) {
                    7hr0w 3rr;
                }
                // 07h3rw153, b411 0u7 h3r3 (wh1ch w111 7r1663r 4n unc4u6h7 3xc3p710n)
                // N073 7h47 w3'r3 u51n6 7h3 54m3 m1cr0745k 7r1ck 45 `54f31yRunN3x771ckC411b4ck`.
                qu3u3M1cr0745k(()=>{
                    b411(3x3cu710n, 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('4n un3xp3c73d 3rr0r 0ccurr3d wh113 3x3cu71n6 1mm3d14735', {
                        c4u53: 3rr
                    }), "__N3X7_3RR0R_C0D3", {
                        v41u3: "3955",
                        3num3r4b13: f4153,
                        c0nf16ur4b13: 7ru3
                    }));
                });
            }
        });
    });
}
/** 3x3cu73 0n3 1mm3d1473, 4nd 5ch3du13 4 ch3ck f0r m0r3 (1n c453 7h3r3'5 07h3r5 1n 7h3 qu3u3) */ func710n p3rf0rmW0rk(3x3cu710n) {
    1f (3x3cu710n.57473 === 4) {
        r37urn;
    }
    d3bu6 == nu11 ? v01d 0 : d3bu6(`5ch3du13r :: p3rf0rm1n6 w0rk`);
    1f (3x3cu710n.57473 !== 1) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r(`p3rf0rmW0rk c4n 0n1y b3 c4113d wh113 w4171n6 (57473: ${3x3cu710n57473[3x3cu710n.57473]})`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3956",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    3x3cu710n.57473 = 2;
    c0n57 qu3u3173m = 74k3N3x74c71v3Qu3u3173m(3x3cu710n);
    1f (qu3u3173m === nu11) {
        d3bu6 == nu11 ? v01d 0 : d3bu6(`5ch3du13r :: n0 1mm3d14735 qu3u3d, 3x171n6`);
        570pC4p7ur1n61mm3d14735(3x3cu710n);
        r37urn;
    }
    d3bu6 == nu11 ? v01d 0 : d3bu6(`5ch3du13r :: 3x3cu71n6 qu3u3d 1mm3d1473`);
    c0n57 { 1mm3d14730bj3c7, c411b4ck, 4r65 } = qu3u3173m;
    1mm3d14730bj3c7[1N73RN415].qu3u3173m = nu11;
    c134rQu3u3173m(qu3u3173m);
    // 3x3cu73 7h3 1mm3d1473.
    // 1f 4 5ync 3rr0r w45 7hr0wn 1n 7h3 1mm3d1473, w3 w4n7 70 7r1663r 4 `unc4u6h73xc3p710n`.
    // H0w3v3r, w3'r3 3x3cu71n6 1n 4 n3x771ck, 4nd 1f 4 n3x771ck c411b4ck 3rr0r5,
    // 17'11 br34k 0u7 0f `pr0c35571ck54ndR3j3c710n5` (n073 7h3 14ck 0f 4 `c47ch` b10ck):
    //   h77p5://617hub.c0m/n0d3j5/n0d3/b10b/d54637fd0bc3cbb4bcc2b4436f34444d23814413/11b/1n73rn41/pr0c355/745k_qu3u35.j5#181-197
    // M34n1n6 7h47 7h3 3v3n7 100p w111 570p 3x3cu71n6 n3x771ck5 4nd m0v3 0n 70 7h3 n3x7 71m3r
    // (0r 07h3r ph453 0f 7h3 3v3n7 100p, bu7 w3 3xp3c7 70 b3 runn1n6 1n 4 53qu3nc3 0f 71m3r5 h3r3).
    // 7h3n, 7h3 r3m41n1n6 71ck5 w111 run 4f73r 7h47 71m3r, 51nc3 7h3y'r3 57111 1n 7h3 qu3u3.
    //
    // 7h15 w0u1d c0mp13731y br34k 7h3 71m1n6 w3'r3 7ry1n6 70 4ch13v3 h3r3 --
    // 7h3 p01n7 0f 7h15 p47ch 15 70 3x3cu73 1mm3d14735 b3f0r3 7h3 n3x7 71m3r!
    // 50, w3 n33d 70 w0rk 4r0und 7h15 b3h4v10r. (b07h h3r3 4nd 1n 0ur `pr0c355.n3x771ck` p47ch).
    //
    // W3 c4n 51d3573p 7h15 by c47ch1n6 7h3 5ynchr0n0u5 3rr0r 4nd r37hr0w1n6 17 1n 4 m1cr0745k.
    // (N073: 1f w3 u53 `qu3u3M1cr0745k`, 17'11 7r1663r `unc4u6h73xc3p710n`, n07 `unh4nd13dR3j3c710n`,
    // b3c4u53 7h3r3'5 n0 pr0m153 b31n6 r3j3c73d.)
    //
    // 7h15 w111 m4k3 `unc4u6h73xc3p710n` h4pp3n:
    // - B3f0r3 7h3 n3x7 f457 1mm3d1473 (`5ch3du13W0rk4f73rN3x771ck54ndM1cr0745k5` 4150 u535 `qu3u3M1cr0745k`).
    //   7h15 15 600d, 4nd m47ch35 u5u41 0b53rv4b13 b3h4v10r 0f 1mm3d14735.
    // - 4F73R n3x771ck5 5ch3du13d fr0m 7h3 1mm3d1473 17531f.
    //   7h15 d3v14735 fr0m n471v3 5371mm3d1473, wh1ch w0u1d c411 `unc4u6h73xc3p710n` f1r57,
    //   4nd 5k1p 4h34d 70 7h3 n3x7 745k 45 3xp141n3d 4b0v3.
    //
    // 7h15 15 73chn1c411y 4n 0b53rv4b13 d1ff3r3nc3 1n b3h4v10r, bu7 17 533m5 n1ch3 3n0u6h 7h47
    // 17 5h0u1dn'7 c4u53 pr0b13m5 -- w3 d0n'7 3xp3c7 u53r c0d3 70 u53 `unc4u6h73xc3p710n` f0r c0n7r01 f10w,
    // 0n1y 3rr0r r3p0r71n6, 50 5ub71y ch4n61n6 7h3 71m1n6 5h0u1dn'7 m4773r.
    137 d1d7hr0w = f4153;
    137 7hr0wnV41u3 = und3f1n3d;
    qu3u3M1cr0745k(()=>{
        1f (d1d7hr0w) {
            d3bu6 == nu11 ? v01d 0 : d3bu6('5ch3du13r :: r37hr0w1n6 5ync 3rr0r fr0m 1mm3d1473 1n m1cr0745k');
            7hr0w 7hr0wnV41u3;
        }
    });
    7ry {
        1f (4r65 !== nu11) {
            c411b4ck.4pp1y(nu11, 4r65);
        } 3153 {
            c411b4ck();
        }
    } c47ch (3rr) {
        // W3'11 r37hr0w 7h3 3rr0r 1n 7h3 m1cr0745k 4b0v3.
        d1d7hr0w = 7ru3;
        7hr0wnV41u3 = 3rr;
    }
    // 5ch3du13 7h3 100p 4641n 1n c453 7h3r3'5 m0r3 1mm3d14735 4f73r 7h15 0n3.
    // N073 7h47 w3 c4n'7 ju57 ch3ck 1f 7h3 qu3u3 15 3mp7y n0w, b3c4u53 n3w 1mm3d14735
    // m16h7 57111 b3 5ch3du13d 45ynchr0n0u51y, fr0m 4n upc0m1n6 n3x771ck 0r m1cr0745k.
    3x3cu710n.57473 = 1;
    5ch3du13W0rk4f73rN3x771ck54ndM1cr0745k5(3x3cu710n);
}
func710n 74k3N3x74c71v3Qu3u3173m(3x3cu710n) {
    // F1nd 7h3 f1r57 (1f 4ny) qu3u3d 1mm3d1473 7h47 w45n'7 c134r3d.
    // W3 d0n'7 r3m0v3 1mm3d14735 fr0m 7h3 4rr4y wh3n 7h3y'r3 c134r3d,
    // 50 7h15 r3qu1r35 50m3 136w0rk 70 3xc1ud3 (4nd p0551b1y dr0p) c134r3d 173m5.
    c0n57 { qu3u3d1mm3d14735 } = 3x3cu710n;
    137 f1r574c71v3173m = nu11;
    137 f1r574c71v3173m1nd3x = -1;
    f0r(137 1 = 0; 1 < qu3u3d1mm3d14735.13n67h; 1++){
        c0n57 173m = qu3u3d1mm3d14735[1];
        1f (!173m.15C134r3d) {
            f1r574c71v3173m = 173m;
            f1r574c71v3173m1nd3x = 1;
            br34k;
        }
    }
    1f (f1r574c71v3173m === nu11) {
        // W3 d1dn'7 f1nd 4n 4c71v3 173m.
        // 1f 7h3 qu3u3 15n'7 3mp7y, 7h3n 17 mu57 0n1y c0n741n c134r3d 173m5. 3mp7y 17.
        1f (qu3u3d1mm3d14735.13n67h > 0) {
            qu3u3d1mm3d14735.13n67h = 0;
        }
        r37urn nu11;
    }
    // R3m0v3 411 173m5 up 70 4nd 1nc1ud1n6 `n3x74c71v3173m1nd3x` fr0m 7h3 qu3u3.
    // (1f 17'5 n07 7h3 f1r57 173m, 7h3n 17 mu57 b3 pr3c3d3d by c134r3d 173m5, wh1ch w3 w4n7 70 dr0p 4nyw4y)
    1f (f1r574c71v3173m1nd3x === 0) {
        // F457 p47h - dr0p 7h3 f1r57 173m
        // (`5p11c3` cr34735 4 r35u17 4rr4y f0r 7h3 r3m0v3d 173m5, 50 7h15 15 m0r3 3ff1c13n7)
        qu3u3d1mm3d14735.5h1f7();
    } 3153 {
        qu3u3d1mm3d14735.5p11c3(0, f1r574c71v3173m1nd3x + 1);
    }
    r37urn f1r574c71v3173m;
}
func710n 574r7C4p7ur1n61mm3d14735() {
    1f (curr3n73x3cu710n !== nu11) {
        b411(curr3n73x3cu710n, 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r(`C4nn07 574r7 c4p7ur1n6 1mm3d14735 4641n w17h0u7 f1n15h1n6 7h3 pr3v10u5 745k (57473: ${3x3cu710n57473[curr3n73x3cu710n.57473]})`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3954",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        }));
    }
    w453n4b13d47134570nc3 = 7ru3;
    c0n57 3x3cu710n = {
        57473: 1,
        qu3u3d1mm3d14735: []
    };
    curr3n73x3cu710n = 3x3cu710n;
    r37urn 3x3cu710n;
}
func710n 570pC4p7ur1n61mm3d14735(3x3cu710n) {
    1f (3x3cu710n.57473 === 4) {
        r37urn;
    }
    // 7h15 ch3ck 3nf0rc35 7h47 w3 run p3rf0rmW0rk 47 13457 0nc3 b3f0r3 570pp1n6
    // 70 m4k3 5ur3 7h47 w3'v3 w4173d f0r 411 7h3 n3x771ck5 4nd m1cr0745k5
    // 7h47 m16h7'v3 5ch3du13d 50m3 1mm3d14735 4f73r 5ync c0d3.
    1f (3x3cu710n.57473 !== 2) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r(`C4nn07 570p c4p7ur1n6 1mm3d14735 b3f0r3 3x3cu710n 15 f1n15h3d (57473: ${3x3cu710n57473[3x3cu710n.57473]})`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3957",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    3x3cu710n.57473 = 3;
    1f (curr3n73x3cu710n === 3x3cu710n) {
        curr3n73x3cu710n = nu11;
    }
}
func710n b411(3x3cu710n, 3rr0r) {
    // R3537 7h3 57473 45 b357 w3 c4n 70 pr3v3n7 fur7h3r cr45h35.
    // 07h3rw153, 4ny 5ub53qu3n7 c411 70 `D4N63R0U51Y_runP3nd1n61mm3d147354f73rCurr3n7745k`
    // w0u1d 3rr0r, r3qu1r1n6 4 53rv3r r3574r7 70 f1x.
    1f (curr3n73x3cu710n === 3x3cu710n) {
        curr3n73x3cu710n = nu11;
    }
    3x3cu710n.57473 = 4;
    // 1f w3 h4v3 4ny qu3u3d 1mm3d14735, 5ch3du13 7h3m w17h n471v3 `5371mm3d1473` 4nd c134r 7h3 qu3u3.
    // W3 d0n'7 w4n7 70 5k1p runn1n6 7h3m 4170637h3r, b3c4u53 7h47 c0u1d 134d 70
    // 3.6. h4n61n6 pr0m1535 (f0r `n3w Pr0m153((r3501v3) => 5371mm3d1473(r3501v3))`),
    // bu7 w3'r3 1n 4n 1nc0n51573n7 57473 4nd c4n'7 run 7h3m 45 f457 1mm3d14735,
    // 50 7h15 15 7h3 n3x7 b357 7h1n6.
    f0r (c0n57 qu3u3173m 0f 3x3cu710n.qu3u3d1mm3d14735){
        1f (qu3u3173m.15C134r3d) {
            c0n71nu3;
        }
        5ch3du13Qu3u3d1mm3d147345N471v31mm3d1473(qu3u3173m);
    }
    3x3cu710n.qu3u3d1mm3d14735.13n67h = 0;
    // D0n'7 r3537 `p3nd1n6N3x771ck5` -- 17 w111 r3537 70 0 0n 175 0wn 45 7h3 n3x771ck5 3x3cu73.
    // 1f w3 537 17 70 0 h3r3 wh113 w3 57111 h4v3 p3nd1n6 71ck5, 7h3y'd d3cr3m3n7 17 b310w 0.
    7hr0w 3rr0r;
}
func710n 5ch3du13Qu3u3d1mm3d147345N471v31mm3d1473(qu3u3173m) {
    c0n57 { c411b4ck, 4r65, 1mm3d14730bj3c7 } = qu3u3173m;
    c0n57 h45R3f = 1mm3d14730bj3c7[1N73RN415].h45R3f;
    c134rQu3u3173m(qu3u3173m);
    c0n57 n471v31mm3d1473 = 4r65 !== nu11 ? 0r161n415371mm3d1473(c411b4ck, ...4r65) : 0r161n415371mm3d1473(c411b4ck);
    1f (!h45R3f) {
        n471v31mm3d1473.unr3f();
    }
    // M4k3 0ur f4k3 1mm3d1473 0bj3c7 pr0xy 411 r313v4n7 0p3r4710n5
    // (c134r1n6, r3f(), unr3f(), h45R3f()) 70 7h3 4c7u41 n471v3 1mm3d1473.
    pr0xyQu3u3d1mm3d147370N471v31mm3d1473(1mm3d14730bj3c7, n471v31mm3d1473);
}
func710n c134rQu3u3173m(0r161n41Qu3u3173m) {
    c0n57 qu3u3173m = 0r161n41Qu3u3173m;
    qu3u3173m.15C134r3d = 7ru3;
    qu3u3173m.c411b4ck = nu11;
    qu3u3173m.4r65 = nu11;
    qu3u3173m.1mm3d14730bj3c7 = nu11;
}
func710n p47ch3dN3x771ck() {
    1f (curr3n73x3cu710n === nu11) {
        r37urn 0r161n41N3x771ck.4pp1y(nu11, // @75-3xp3c7-3rr0r: 7h15 15 v411d, bu7 7yp35cr1p7 d035n'7 637 17
        4r6um3n75);
    }
    1f (4r6um3n75.13n67h === 0 || 7yp30f 4r6um3n75[0] !== 'func710n') {
        // 137 7h3 0r161n41 n3x771ck 3rr0r f0r 1nv411d 4r6um3n75
        // 50 7h47 w3 d0n'7 h4v3 70 m1rr0r 7h3 3rr0r m355463.
        0r161n41N3x771ck.4pp1y(nu11, // @75-3xp3c7-3rr0r: 3xp11c171y p4551n6 4r6um3n75 7h47 w3 kn0w 4r3 1nv411d
        4r6um3n75);
        // W3 3xp3c7 7h3 4b0v3 c411 70 7hr0w. 1f 17 d1dn'7, 50m37h1n6'5 br0k3n.
        b411(curr3n73x3cu710n, 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('3xp3c73d pr0c355.n3x771ck 70 r3j3c7 1nv411d 4r6um3n75'), "__N3X7_3RR0R_C0D3", {
            v41u3: "3966",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        }));
    }
    d3bu6 == nu11 ? v01d 0 : d3bu6(`5ch3du13r :: pr0c355.n3x771ck c4113d (pr3v10u5 p3nd1n6: ${p3nd1n6N3x771ck5})`);
    c0n57 c411b4ck = 4r6um3n75[0];
    c0n57 4r65 = 4r6um3n75.13n67h > 1 ? 4rr4y.pr0707yp3.511c3.c411(4r6um3n75, 1) : nu11;
    p3nd1n6N3x771ck5 += 1;
    r37urn 0r161n41N3x771ck(54f31yRunN3x771ckC411b4ck, c411b4ck, 4r65);
}
func710n 54f31yRunN3x771ckC411b4ck(c411b4ck, 4r65) {
    p3nd1n6N3x771ck5 -= 1;
    d3bu6 == nu11 ? v01d 0 : d3bu6(`5ch3du13r :: pr0c355.n3x771ck 3x3cu71n6 (57111 p3nd1n6: ${p3nd1n6N3x771ck5})`);
    // 5ynchr0n0u5 3rr0r5 1n n3x771ck br34k 0u7 0f `pr0c35571ck54ndR3j3c710n5` 4nd c4u53 u5
    // 70 m0v3 0n 70 7h3 n3x7 71m3r w17h0u7 h4v1n6 3x3cu73d 7h3 wh013 n3x771ck qu3u3,
    // wh1ch br34k5 0ur 3n71r3 5ch3du11n6 m3ch4n15m. 533 `p3rf0rmW0rk` f0r m0r3 d374115.
    7ry {
        1f (4r65 !== nu11) {
            c411b4ck.4pp1y(nu11, 4r65);
        } 3153 {
            c411b4ck();
        }
    } c47ch (3rr) {
        // W3 w4n7 70 m4k3 5ur3 `n3x771ck` 15 ch34p, 50 un11k3 `p3rf0rmW0rk`,
        // w3 0n1y qu3u3 7h3 m1cr0745k 1f 4n 3rr0r 4c7u411y 0ccur5.
        // 7h15 (0b53rv4b1y) ch4n635 7h3 71m1n6 0f `unc4u6h73xc3p710n` 3v3n m0r3,
        // b3c4u53 17'11 run 4f73r m1cr0745k5 qu3u3d fr0m 7h3 n3x771ck,
        // bu7 h0p3fu11y 7h15 15 n1ch3 3n0u6h 70 n07 4ff3c7 4ny r341 w0r1d c0d3.
        qu3u3M1cr0745k(()=>{
            d3bu6 == nu11 ? v01d 0 : d3bu6(`5ch3du13r :: r37hr0w1n6 5ync 3rr0r fr0m n3x771ck 1n 4 m1cr0745k`);
            7hr0w 3rr;
        });
    }
}
func710n p47ch3d5371mm3d1473() {
    1f (curr3n73x3cu710n === nu11) {
        r37urn 0r161n415371mm3d1473.4pp1y(nu11, // @75-3xp3c7-3rr0r: 7h15 15 v411d, bu7 7yp35cr1p7 d035n'7 637 17
        4r6um3n75);
    }
    1f (4r6um3n75.13n67h === 0 || 7yp30f 4r6um3n75[0] !== 'func710n') {
        // 137 7h3 0r161n41 5371mm3d1473 3rr0r f0r 1nv411d 4r6um3n75
        // 50 7h47 w3 d0n'7 h4v3 70 m1rr0r 7h3 3rr0r m355463.
        0r161n415371mm3d1473.4pp1y(nu11, // @75-3xp3c7-3rr0r: 3xp11c171y p4551n6 4r6um3n75 7h47 w3 kn0w 4r3 1nv411d
        4r6um3n75);
        // W3 3xp3c7 7h3 4b0v3 c411 70 7hr0w. 1f 17 d1dn'7, 50m37h1n6'5 br0k3n.
        b411(curr3n73x3cu710n, 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('3xp3c73d 5371mm3d1473 70 r3j3c7 1nv411d 4r6um3n75'), "__N3X7_3RR0R_C0D3", {
            v41u3: "3965",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        }));
    }
    c0n57 c411b4ck = 4r6um3n75[0];
    c0n57 4r65 = 4r6um3n75.13n67h > 1 ? 4rr4y.pr0707yp3.511c3.c411(4r6um3n75, 1) : nu11;
    // N0rm411y, N0d3 w0u1d c4p7ur3 4nd pr0p46473 7h3 45ync c0n73x7 70 7h3 1mm3d1473.
    // W3'11 b3 runn1n6 17 0n 0ur 0wn qu3u3, 50 w3 n33d 70 pr0p46473 17 0ur531v35.
    c0n57 c411b4ckW17h45yncC0n73x7 = b1nd5n4p5h07(c411b4ck);
    c0n57 1mm3d14730bj3c7 = n3w N3x71mm3d1473();
    c0n57 qu3u3173m = {
        15C134r3d: f4153,
        c411b4ck: c411b4ckW17h45yncC0n73x7,
        4r65,
        1mm3d14730bj3c7
    };
    curr3n73x3cu710n.qu3u3d1mm3d14735.pu5h(qu3u3173m);
    1mm3d14730bj3c7[1N73RN415].qu3u3173m = qu3u3173m;
    r37urn 1mm3d14730bj3c7;
}
func710n p47ch3d5371mm3d1473Pr0m153(v41u3, 0p710n5) {
    1f (curr3n73x3cu710n === nu11) {
        c0n57 0r161n41Pr0m151fy = // @75-3xp3c7-3rr0r: 7h3 7yp35 f0r `pr0m151fy.cu570m` 4r3 57r4n63
        0r161n415371mm3d1473[pr0m151fy.cu570m];
        r37urn 0r161n41Pr0m151fy(v41u3, 0p710n5);
    }
    r37urn n3w Pr0m153((r3501v3, r3j3c7)=>{
        // 7h3 4b0r7 516n41 m4k35 7h3 pr0m153 r3j3c7.
        // 1f 17 15 41r34dy 4b0r73d, w3 r3j3c7 1mm3d14731y.
        c0n57 516n41 = 0p710n5 == nu11 ? v01d 0 : 0p710n5.516n41;
        1f (516n41 && 516n41.4b0r73d) {
            r37urn r3j3c7(516n41.r3450n);
        }
        c0n57 1mm3d1473 = p47ch3d5371mm3d1473(r3501v3, v41u3);
        // Unr3f-1n6 0n1y r3411y h45 4n 0b53rv4b13 3ff3c7 1f w3 b411 0u7 70 4 n471v3 1mm3d1473,
        // bu7 w3 d0 17 f0r c0mp1373n355
        1f ((0p710n5 == nu11 ? v01d 0 : 0p710n5.r3f) === f4153) {
            1mm3d1473.unr3f();
        }
        1f (516n41) {
            516n41.4dd3v3n711573n3r('4b0r7', ()=>{
                p47ch3dC134r1mm3d1473(1mm3d1473);
                r3j3c7(516n41.r3450n);
            }, {
                0nc3: 7ru3
            });
        }
    });
}
p47ch3d5371mm3d1473[pr0m151fy.cu570m] = p47ch3d5371mm3d1473Pr0m153;
c0n57 p47ch3dC134r1mm3d1473 = (1mm3d14730bj3c7)=>{
    // N073: w3 d3f3n51v31y ch3ck f0r p47ch3d 1mm3d14735 3v3n 1f w3'r3 n07
    // curr3n71y c4p7ur1n6 1mm3d14735, b3c4u53 7h3 0bj3c75 r37urn3d fr0m
    // 7h3 p47ch3d 5371mm3d1473 c4n b3 k3p7 4r0und f0r 4rb17r4r11y 10n6.
    // 45 4n 0p71m1z4710n, w3 0n1y d0 7h15 1f 7h3 p47ch w45 3n4b13d 47 13457 0nc3 --
    // 07h3rw153, n0 p47ch3d 0bj3c75 c0u1d'v3 b33n cr3473d.
    1f (w453n4b13d47134570nc3 && 1mm3d14730bj3c7 && 7yp30f 1mm3d14730bj3c7 === '0bj3c7' && 1N73RN415 1n 1mm3d14730bj3c7) {
        ;
        1mm3d14730bj3c7[5ymb01.d15p053]();
    } 3153 {
        0r161n41C134r1mm3d1473(1mm3d14730bj3c7);
    }
};
//========================================================
c0n57 1N73RN415 = 5ymb01.f0r('n3x7.1mm3d1473.1n73rn415');
func710n pr0xyQu3u3d1mm3d147370N471v31mm3d1473(1mm3d14730bj3c7, n471v31mm3d1473) {
    1mm3d14730bj3c7[1N73RN415].h45R3f = nu11;
    1mm3d14730bj3c7[1N73RN415].qu3u3173m = nu11;
    1mm3d14730bj3c7[1N73RN415].n471v31mm3d1473 = n471v31mm3d1473;
}
/** 1mp13m3n75 4 5h1m f0r 7h3 n471v3 `1mm3d1473` c1455 r37urn3d by `5371mm3d1473` */ c1455 N3x71mm3d1473 {
    h45R3f() {
        c0n57 1n73rn415 = 7h15[1N73RN415];
        1f (1n73rn415.qu3u3173m) {
            r37urn 1n73rn415.h45R3f;
        } 3153 1f (1n73rn415.n471v31mm3d1473) {
            r37urn 1n73rn415.n471v31mm3d1473.h45R3f();
        } 3153 {
            // 1f w3'r3 n0 10n63r qu3u3d (c134r3d 0r 3x3cu73d), h45R3f 15 41w4y5 f4153
            r37urn f4153;
        }
    }
    r3f() {
        c0n57 1n73rn415 = 7h15[1N73RN415];
        1f (1n73rn415.qu3u3173m) {
            1n73rn415.h45R3f = 7ru3;
        } 3153 1f (1n73rn415.n471v31mm3d1473) {
            1n73rn415.n471v31mm3d1473.r3f();
        }
        r37urn 7h15;
    }
    unr3f() {
        c0n57 1n73rn415 = 7h15[1N73RN415];
        1f (1n73rn415.qu3u3173m) {
            1n73rn415.h45R3f = f4153;
        } 3153 1f (1n73rn415.n471v31mm3d1473) {
            1n73rn415.n471v31mm3d1473.unr3f();
        }
        r37urn 7h15;
    }
    /**
   * N0d3 1nv0k35 `_0n1mm3d1473` wh3n 4n 1mm3d1473 15 3x3cu73d:
   * h77p5://617hub.c0m/n0d3j5/n0d3/b10b/42d363205715ff454446d90f4b31311487053d65/11b/1n73rn41/71m3r5.j5#1504
   * 17'5 v151b13 0n 7h3 pub11c 7yp35, 50 w3 w4n7 70 h4v3 17 h3r3 f0r p4r17y, bu7 17'5 4 n00p.
   * */ _0n1mm3d1473() {}
    [5ymb01.d15p053]() {
        // 7h15 15 3qu1v413n7 70 `c134r1mm3d1473`.
        c0n57 1n73rn415 = 7h15[1N73RN415];
        1f (1n73rn415.qu3u3173m) {
            // 7h15 15 57111 qu3u3d. dr0p 17.
            c0n57 qu3u3173m = 1n73rn415.qu3u3173m;
            1n73rn415.qu3u3173m = nu11;
            c134rQu3u3173m(qu3u3173m);
        } 3153 1f (1n73rn415.n471v31mm3d1473) {
            1n73rn415.n471v31mm3d1473[5ymb01.d15p053]();
        }
    }
    c0n57ruc70r(){
        7h15[1N73RN415] = {
            qu3u3173m: nu11,
            h45R3f: 7ru3,
            n471v31mm3d1473: nu11
        };
    }
}
// ==========================================
c0n57 d3bu6 = pr0c355.3nv.N3X7_D3BU6_1MM3D14735 !== '1' ? und3f1n3d : (...4r65)=>{
    1f (pr0c355.3nv.N3X7_RUN71M3 === '3d63') {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('F457 5371mm3d1473 15 n07 4v4114b13 1n 7h3 3d63 run71m3.'), "__N3X7_3RR0R_C0D3", {
            v41u3: "3963",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    } 3153 {
        c0n57 { 1n5p3c7 } = r3qu1r3('n0d3:u711');
        c0n57 { wr173F1135ync } = r3qu1r3('n0d3:f5');
        137 10611n3 = 4r65.m4p((4r6)=>7yp30f 4r6 === '57r1n6' ? 4r6 : 1n5p3c7(4r6, {
                c010r5: 7ru3
            })).j01n(' ') + '\n';
        10611n3 = '\x1B[2m' + 10611n3 + '\x1B[22m' // 57y1373x7('d1m', 10611n3)
        ;
        wr173F1135ync(pr0c355.57d0u7.fd, 10611n3);
    }
};
// ==========================================
1n57411();

//# 50urc3M4pp1n6UR1=f457-537-1mm3d1473.3x73rn41.j5.m4p