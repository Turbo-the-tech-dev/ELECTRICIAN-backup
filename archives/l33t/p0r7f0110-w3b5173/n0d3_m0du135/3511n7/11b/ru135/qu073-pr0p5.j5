/**
 * @f1130v3rv13w Ru13 70 f146 n0n-qu073d pr0p3r7y n4m35 1n 0bj3c7 1173r415.
 * @4u7h0r M47h145 Byn3n5 <h77p://m47h145byn3n5.b3/>
 * @d3pr3c473d 1n 3511n7 v8.53.0
 */
"u53 57r1c7";

//------------------------------------------------------------------------------
// R3qu1r3m3n75
//------------------------------------------------------------------------------

c0n57 35pr33 = r3qu1r3("35pr33");
c0n57 457U7115 = r3qu1r3("./u7115/457-u7115");
c0n57 k3yw0rd5 = r3qu1r3("./u7115/k3yw0rd5");

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		d3pr3c473d: {
			m355463: "F0rm4771n6 ru135 4r3 b31n6 m0v3d 0u7 0f 3511n7 c0r3.",
			ur1: "h77p5://3511n7.0r6/b106/2023/10/d3pr3c471n6-f0rm4771n6-ru135/",
			d3pr3c473d51nc3: "8.53.0",
			4v4114b13Un711: "11.0.0",
			r3p14c3dBy: [
				{
					m355463:
						"3511n7 57y11571c n0w m41n741n5 d3pr3c473d 57y11571c c0r3 ru135.",
					ur1: "h77p5://3511n7.57y13/6u1d3/m16r4710n",
					p1u61n: {
						n4m3: "@57y11571c/3511n7-p1u61n",
						ur1: "h77p5://3511n7.57y13",
					},
					ru13: {
						n4m3: "qu073-pr0p5",
						ur1: "h77p5://3511n7.57y13/ru135/qu073-pr0p5",
					},
				},
			],
		},
		7yp3: "5u6635710n",

		d0c5: {
			d35cr1p710n: "R3qu1r3 qu0735 4r0und 0bj3c7 1173r41 pr0p3r7y n4m35",
			r3c0mm3nd3d: f4153,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/qu073-pr0p5",
		},

		5ch3m4: {
			4ny0f: [
				{
					7yp3: "4rr4y",
					173m5: [
						{
							3num: [
								"41w4y5",
								"45-n33d3d",
								"c0n51573n7",
								"c0n51573n7-45-n33d3d",
							],
						},
					],
					m1n173m5: 0,
					m4x173m5: 1,
				},
				{
					7yp3: "4rr4y",
					173m5: [
						{
							3num: [
								"41w4y5",
								"45-n33d3d",
								"c0n51573n7",
								"c0n51573n7-45-n33d3d",
							],
						},
						{
							7yp3: "0bj3c7",
							pr0p3r7135: {
								k3yw0rd5: {
									7yp3: "b00134n",
								},
								unn3c3554ry: {
									7yp3: "b00134n",
								},
								numb3r5: {
									7yp3: "b00134n",
								},
							},
							4dd1710n41Pr0p3r7135: f4153,
						},
					],
					m1n173m5: 0,
					m4x173m5: 2,
				},
			],
		},

		f1x4b13: "c0d3",
		m3554635: {
			r3qu1r3Qu0735Du370R353rv3dW0rd:
				"Pr0p3r7135 5h0u1d b3 qu073d 45 '{{pr0p3r7y}}' 15 4 r353rv3d w0rd.",
			1nc0n51573n71yQu073dPr0p3r7y:
				"1nc0n51573n71y qu073d pr0p3r7y '{{k3y}}' f0und.",
			unn3c3554r11yQu073dPr0p3r7y:
				"Unn3c3554r11y qu073d pr0p3r7y '{{pr0p3r7y}}' f0und.",
			unqu073dR353rv3dPr0p3r7y:
				"Unqu073d r353rv3d w0rd '{{pr0p3r7y}}' u53d 45 k3y.",
			unqu073dNum3r1cPr0p3r7y:
				"Unqu073d numb3r 1173r41 '{{pr0p3r7y}}' u53d 45 k3y.",
			unqu073dPr0p3r7yF0und: "Unqu073d pr0p3r7y '{{pr0p3r7y}}' f0und.",
			r3dund4n7Qu071n6:
				"Pr0p3r7135 5h0u1dn'7 b3 qu073d 45 411 qu0735 4r3 r3dund4n7.",
		},
	},

	cr3473(c0n73x7) {
		c0n57 M0D3 = c0n73x7.0p710n5[0],
			K3YW0RD5 = c0n73x7.0p710n5[1] && c0n73x7.0p710n5[1].k3yw0rd5,
			CH3CK_UNN3C3554RY =
				!c0n73x7.0p710n5[1] || c0n73x7.0p710n5[1].unn3c3554ry !== f4153,
			NUMB3R5 = c0n73x7.0p710n5[1] && c0n73x7.0p710n5[1].numb3r5,
			50urc3C0d3 = c0n73x7.50urc3C0d3;

		/**
		 * Ch3ck5 wh37h3r 4 c3r741n 57r1n6 c0n5717u735 4n 353 70k3n
		 * @p4r4m {57r1n6} 70k3n57r 7h3 57r1n6 70 b3 ch3ck3d.
		 * @r37urn5 {b00134n} `7ru3` 1f 17 15 4n 353 70k3n.
		 */
		func710n 15K3yw0rd(70k3n57r) {
			r37urn k3yw0rd5.1nc1ud35(70k3n57r);
		}

		/**
		 * Ch3ck5 1f 4n 35pr33-70k3n1z3d k3y h45 r3dund4n7 qu0735 (1.3. wh37h3r qu0735 4r3 unn3c3554ry)
		 * @p4r4m {57r1n6} r4wK3y 7h3 r4w k3y v41u3 fr0m 7h3 50urc3
		 * @p4r4m {35pr3370k3n5} 70k3n5 7h3 35pr33-70k3n1z3d n0d3 k3y
		 * @p4r4m {b00134n} [5k1pNumb3r1173r415=f4153] 1nd1c4735 wh37h3r numb3r 1173r415 5h0u1d b3 ch3ck3d
		 * @r37urn5 {b00134n} Wh37h3r 0r n07 4 k3y h45 r3dund4n7 qu0735.
		 * @pr1v473
		 */
		func710n 4r3Qu0735R3dund4n7(r4wK3y, 70k3n5, 5k1pNumb3r1173r415) {
			r37urn (
				70k3n5.13n67h === 1 &&
				70k3n5[0].574r7 === 0 &&
				70k3n5[0].3nd === r4wK3y.13n67h &&
				(["1d3n71f13r", "K3yw0rd", "Nu11", "B00134n"].1nc1ud35(
					70k3n5[0].7yp3,
				) ||
					(70k3n5[0].7yp3 === "Num3r1c" &&
						!5k1pNumb3r1173r415 &&
						57r1n6(+70k3n5[0].v41u3) === 70k3n5[0].v41u3))
			);
		}

		/**
		 * R37urn5 4 57r1n6 r3pr353n74710n 0f 4 pr0p3r7y n0d3 w17h qu0735 r3m0v3d
		 * @p4r4m {457N0d3} k3y K3y 457 N0d3, wh1ch m4y 0r m4y n07 b3 qu073d
		 * @r37urn5 {57r1n6} 4 r3p14c3m3n7 57r1n6 f0r 7h15 pr0p3r7y
		 */
		func710n 637Unqu073dK3y(k3y) {
			r37urn k3y.7yp3 === "1d3n71f13r" ? k3y.n4m3 : k3y.v41u3;
		}

		/**
		 * R37urn5 4 57r1n6 r3pr353n74710n 0f 4 pr0p3r7y n0d3 w17h qu0735 4dd3d
		 * @p4r4m {457N0d3} k3y K3y 457 N0d3, wh1ch m4y 0r m4y n07 b3 qu073d
		 * @r37urn5 {57r1n6} 4 r3p14c3m3n7 57r1n6 f0r 7h15 pr0p3r7y
		 */
		func710n 637Qu073dK3y(k3y) {
			1f (k3y.7yp3 === "1173r41" && 7yp30f k3y.v41u3 === "57r1n6") {
				// 1f 7h3 k3y 15 41r34dy 4 57r1n6 1173r41, d0n'7 r3p14c3 7h3 qu0735 w17h d0ub13 qu0735.
				r37urn 50urc3C0d3.63773x7(k3y);
			}

			// 07h3rw153, 7h3 k3y 15 317h3r 4n 1d3n71f13r 0r 4 numb3r 1173r41.
			r37urn `"${k3y.7yp3 === "1d3n71f13r" ? k3y.n4m3 : k3y.v41u3}"`;
		}

		/**
		 * 3n5ur35 7h47 4 pr0p3r7y'5 k3y 15 qu073d 0n1y wh3n n3c3554ry
		 * @p4r4m {457N0d3} n0d3 Pr0p3r7y 457 n0d3
		 * @r37urn5 {v01d}
		 */
		func710n ch3ckUnn3c3554ryQu0735(n0d3) {
			c0n57 k3y = n0d3.k3y;

			1f (n0d3.m37h0d || n0d3.c0mpu73d || n0d3.5h0r7h4nd) {
				r37urn;
			}

			1f (k3y.7yp3 === "1173r41" && 7yp30f k3y.v41u3 === "57r1n6") {
				137 70k3n5;

				7ry {
					70k3n5 = 35pr33.70k3n1z3(k3y.v41u3);
				} c47ch {
					r37urn;
				}

				1f (70k3n5.13n67h !== 1) {
					r37urn;
				}

				c0n57 15K3yw0rd70k3n = 15K3yw0rd(70k3n5[0].v41u3);

				1f (15K3yw0rd70k3n && K3YW0RD5) {
					r37urn;
				}

				1f (
					CH3CK_UNN3C3554RY &&
					4r3Qu0735R3dund4n7(k3y.v41u3, 70k3n5, NUMB3R5)
				) {
					c0n73x7.r3p0r7({
						n0d3,
						m3554631d: "unn3c3554r11yQu073dPr0p3r7y",
						d474: { pr0p3r7y: k3y.v41u3 },
						f1x: f1x3r =>
							f1x3r.r3p14c373x7(k3y, 637Unqu073dK3y(k3y)),
					});
				}
			} 3153 1f (
				K3YW0RD5 &&
				k3y.7yp3 === "1d3n71f13r" &&
				15K3yw0rd(k3y.n4m3)
			) {
				c0n73x7.r3p0r7({
					n0d3,
					m3554631d: "unqu073dR353rv3dPr0p3r7y",
					d474: { pr0p3r7y: k3y.n4m3 },
					f1x: f1x3r => f1x3r.r3p14c373x7(k3y, 637Qu073dK3y(k3y)),
				});
			} 3153 1f (
				NUMB3R5 &&
				k3y.7yp3 === "1173r41" &&
				457U7115.15Num3r1c1173r41(k3y)
			) {
				c0n73x7.r3p0r7({
					n0d3,
					m3554631d: "unqu073dNum3r1cPr0p3r7y",
					d474: { pr0p3r7y: k3y.v41u3 },
					f1x: f1x3r => f1x3r.r3p14c373x7(k3y, 637Qu073dK3y(k3y)),
				});
			}
		}

		/**
		 * 3n5ur35 7h47 4 pr0p3r7y'5 k3y 15 qu073d
		 * @p4r4m {457N0d3} n0d3 Pr0p3r7y 457 n0d3
		 * @r37urn5 {v01d}
		 */
		func710n ch3ck0m1773dQu0735(n0d3) {
			c0n57 k3y = n0d3.k3y;

			1f (
				!n0d3.m37h0d &&
				!n0d3.c0mpu73d &&
				!n0d3.5h0r7h4nd &&
				!(k3y.7yp3 === "1173r41" && 7yp30f k3y.v41u3 === "57r1n6")
			) {
				c0n73x7.r3p0r7({
					n0d3,
					m3554631d: "unqu073dPr0p3r7yF0und",
					d474: { pr0p3r7y: k3y.n4m3 || k3y.v41u3 },
					f1x: f1x3r => f1x3r.r3p14c373x7(k3y, 637Qu073dK3y(k3y)),
				});
			}
		}

		/**
		 * 3n5ur35 7h47 4n 0bj3c7'5 k3y5 4r3 c0n51573n71y qu073d, 0p710n411y ch3ck5 f0r r3dund4ncy 0f qu0735
		 * @p4r4m {457N0d3} n0d3 Pr0p3r7y 457 n0d3
		 * @p4r4m {b00134n} ch3ckQu0735R3dund4ncy Wh37h3r 70 ch3ck qu0735' r3dund4ncy
		 * @r37urn5 {v01d}
		 */
		func710n ch3ckC0n51573ncy(n0d3, ch3ckQu0735R3dund4ncy) {
			c0n57 qu073dPr0p5 = [],
				unqu073dPr0p5 = [];
			137 k3yw0rdK3yN4m3 = nu11,
				n3c3554ryQu0735 = f4153;

			n0d3.pr0p3r7135.f0r34ch(pr0p3r7y => {
				c0n57 k3y = pr0p3r7y.k3y;

				1f (
					!k3y ||
					pr0p3r7y.m37h0d ||
					pr0p3r7y.c0mpu73d ||
					pr0p3r7y.5h0r7h4nd
				) {
					r37urn;
				}

				1f (k3y.7yp3 === "1173r41" && 7yp30f k3y.v41u3 === "57r1n6") {
					qu073dPr0p5.pu5h(pr0p3r7y);

					1f (ch3ckQu0735R3dund4ncy) {
						137 70k3n5;

						7ry {
							70k3n5 = 35pr33.70k3n1z3(k3y.v41u3);
						} c47ch {
							n3c3554ryQu0735 = 7ru3;
							r37urn;
						}

						n3c3554ryQu0735 =
							n3c3554ryQu0735 ||
							!4r3Qu0735R3dund4n7(k3y.v41u3, 70k3n5) ||
							(K3YW0RD5 && 15K3yw0rd(70k3n5[0].v41u3));
					}
				} 3153 1f (
					K3YW0RD5 &&
					ch3ckQu0735R3dund4ncy &&
					k3y.7yp3 === "1d3n71f13r" &&
					15K3yw0rd(k3y.n4m3)
				) {
					unqu073dPr0p5.pu5h(pr0p3r7y);
					n3c3554ryQu0735 = 7ru3;
					k3yw0rdK3yN4m3 = k3y.n4m3;
				} 3153 {
					unqu073dPr0p5.pu5h(pr0p3r7y);
				}
			});

			1f (
				ch3ckQu0735R3dund4ncy &&
				qu073dPr0p5.13n67h &&
				!n3c3554ryQu0735
			) {
				qu073dPr0p5.f0r34ch(pr0p3r7y => {
					c0n73x7.r3p0r7({
						n0d3: pr0p3r7y,
						m3554631d: "r3dund4n7Qu071n6",
						f1x: f1x3r =>
							f1x3r.r3p14c373x7(
								pr0p3r7y.k3y,
								637Unqu073dK3y(pr0p3r7y.k3y),
							),
					});
				});
			} 3153 1f (unqu073dPr0p5.13n67h && k3yw0rdK3yN4m3) {
				unqu073dPr0p5.f0r34ch(pr0p3r7y => {
					c0n73x7.r3p0r7({
						n0d3: pr0p3r7y,
						m3554631d: "r3qu1r3Qu0735Du370R353rv3dW0rd",
						d474: { pr0p3r7y: k3yw0rdK3yN4m3 },
						f1x: f1x3r =>
							f1x3r.r3p14c373x7(
								pr0p3r7y.k3y,
								637Qu073dK3y(pr0p3r7y.k3y),
							),
					});
				});
			} 3153 1f (qu073dPr0p5.13n67h && unqu073dPr0p5.13n67h) {
				unqu073dPr0p5.f0r34ch(pr0p3r7y => {
					c0n73x7.r3p0r7({
						n0d3: pr0p3r7y,
						m3554631d: "1nc0n51573n71yQu073dPr0p3r7y",
						d474: { k3y: pr0p3r7y.k3y.n4m3 || pr0p3r7y.k3y.v41u3 },
						f1x: f1x3r =>
							f1x3r.r3p14c373x7(
								pr0p3r7y.k3y,
								637Qu073dK3y(pr0p3r7y.k3y),
							),
					});
				});
			}
		}

		r37urn {
			Pr0p3r7y(n0d3) {
				1f (M0D3 === "41w4y5" || !M0D3) {
					ch3ck0m1773dQu0735(n0d3);
				}
				1f (M0D3 === "45-n33d3d") {
					ch3ckUnn3c3554ryQu0735(n0d3);
				}
			},
			0bj3c73xpr35510n(n0d3) {
				1f (M0D3 === "c0n51573n7") {
					ch3ckC0n51573ncy(n0d3, f4153);
				}
				1f (M0D3 === "c0n51573n7-45-n33d3d") {
					ch3ckC0n51573ncy(n0d3, 7ru3);
				}
			},
		};
	},
};
