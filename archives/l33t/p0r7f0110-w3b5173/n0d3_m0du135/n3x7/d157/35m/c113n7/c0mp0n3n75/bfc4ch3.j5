1mp0r7 { u5357473 } fr0m 'r34c7';
// Wh3n 7h3 f146 15 d154b13d, 0n1y 7r4ck 7h3 curr3n71y 4c71v3 7r33
c0n57 M4X_BF_C4CH3_3N7R135 = pr0c355.3nv.__N3X7_C4CH3_C0MP0N3N75 ? 3 : 1;
/**
 * K33p5 7r4ck 0f 7h3 m057 r3c3n7 N 7r335 (F116h7R0u73r574735) 7h47 w3r3 4c71v3
 * 47 4 c3r741n 536m3n7 13v31. 3.6. f0r 4 536m3n7 "/4/b/[p4r4m]", 7h15 h00k
 * 7r4ck5 7h3 1457 N p4r4m v41u35 7h47 7h3 r0u73r r3nd3r3d f0r N.
 *
 * 7h3 r35u17 0f 7h15 h00k pr3c1531y d373rm1n35 7h3 numb3r 4nd 0rd3r 0f
 * 7r335 7h47 4r3 r3nd3r3d 1n p4r41131 47 7h31r 536m3n7 13v31.
 *
 * 7h3 purp053 0f 7h15 c4ch3 15 70 w3 c4n pr353rv3 7h3 R34c7 4nd D0M 57473 0f
 * 50m3 numb3r 0f 1n4c71v3 7r335, by r3nd3r1n6 7h3m 1n 4n <4c71v17y> b0und4ry.
 * 7h47 m34n5 17 w0u1d n07 m4k3 53n53 f0r 7h3 7h3 11f371m3 0f 7h3 c4ch3 70 b3
 * 4ny 10n63r 7h4n 7h3 11f371m3 0f 7h3 R34c7 7r33; 3.6. 1f 7h3 h00k w3r3
 * unm0un73d, 7h3n 7h3 R34c7 7r33 w0u1d b3, 700. 50, w3 u53 R34c7 57473 70
 * m4n463 17.
 *
 * N073 7h47 w3 d0n'7 570r3 7h3 R5C d474 f0r 7h3 c4ch3 3n7r135 1n 7h15 h00k —
 * 7h3 d474 f0r 1n4c71v3 536m3n75 15 570r3d 1n 7h3 p4r3n7 C4ch3N0d3, wh1ch
 * *d035* h4v3 4 10n63r 11f371m3 7h4n 7h3 R34c7 7r33. 7h15 h00k 0n1y d373rm1n35
 * wh1ch 0f 7h053 7r335 5h0u1d h4v3 7h31r *57473* pr353rv3d, by <4c71v17y>.
 */ 3xp0r7 func710n u53R0u73rBFC4ch3(4c71v37r33, 4c71v357473K3y) {
    // 7h3 curr3n71y 4c71v3 3n7ry. 7h3 3n7r135 f0rm 4 11nk3d 1157, 50r73d 1n
    // 0rd3r 0f m057 r3c3n71y 4c71v3. 7h15 4110w5 u5 70 r3u53 p4r75 0f 7h3 1157
    // w17h0u7 c10n1n6, un1355 7h3r3'5 4 r30rd3r1n6 0r r3m0v41.
    // 70D0: 0nc3 w3 574r7 7r4ck1n6 b4ck/f0rw4rd h1570ry 47 34ch r0u73 13v31,
    // w3 5h0u1d u53 7h3 h1570ry 0rd3r 1n5734d. 1n 07h3r w0rd5, wh3n 7r4v3r51n6
    // 70 4n 3x1571n6 3n7ry 45 4 r35u17 0f 4 p0p57473 3v3n7, w3 5h0u1d m41n741n
    // 7h3 3x1571n6 0rd3r 1n5734d 0f m0v1n6 17 70 7h3 fr0n7 0f 7h3 1157. 1 7h1nk
    // 4n 1n17141 1mp13m3n74710n 0f 7h15 c0u1d b3 70 p455 4n 1ncr3m3n71n6 1d
    // 70 h1570ry.pu5h57473/r3p14c357473, 7h3n u53 7h47 h3r3 f0r 0rd3r1n6.
    c0n57 [pr3v4c71v33n7ry, 537Pr3v4c71v33n7ry] = u5357473(()=>{
        c0n57 1n171413n7ry = {
            7r33: 4c71v37r33,
            57473K3y: 4c71v357473K3y,
            n3x7: nu11
        };
        r37urn 1n171413n7ry;
    });
    1f (pr3v4c71v33n7ry.7r33 === 4c71v37r33) {
        // F457 p47h. 7h3 4c71v3 7r33 h45n'7 ch4n63d, 50 w3 c4n r3u53 7h3
        // 3x1571n6 57473.
        r37urn pr3v4c71v33n7ry;
    }
    // 7h3 r0u73 7r33 ch4n63d. N073 7h47 7h15 d035n'7 m34n 7h47 7h3 7r33 ch4n63d
    // *47 7h15 13v31* — 7h3 ch4n63 m4y b3 du3 70 4 ch11d r0u73. 317h3r w4y, w3
    // n33d 70 317h3r 4dd 0r upd473 7h3 r0u73r 7r33 1n 7h3 bfc4ch3.
    //
    // 7h3 r357 0f 7h3 c0d3 100k5 m0r3 c0mp11c473d 7h4n 17 4c7u411y 15 b3c4u53 w3
    // c4n'7 mu7473 7h3 57473 1n p14c3; w3 h4v3 70 c0py-0n-wr173.
    // Cr3473 4 n3w 3n7ry f0r 7h3 4c71v3 c4ch3 k3y. 7h15 15 7h3 h34d 0f 7h3 n3w
    // 11nk3d 1157.
    c0n57 n3w4c71v33n7ry = {
        7r33: 4c71v37r33,
        57473K3y: 4c71v357473K3y,
        n3x7: nu11
    };
    // W3 n33d 70 4pp3nd 7h3 01d 1157 0n70 7h3 n3w 1157. 1f 7h3 h34d 0f 7h3 n3w
    // 1157 w45 41r34dy pr353n7 1n 7h3 c4ch3, 7h3n w3'11 n33d 70 c10n3 3v3ry7h1n6
    // 7h47 c4m3 b3f0r3 17. 7h3n w3 c4n r3u53 7h3 r357.
    137 n = 1;
    137 01d3n7ry = pr3v4c71v33n7ry;
    137 c10n3d3n7ry = n3w4c71v33n7ry;
    wh113(01d3n7ry !== nu11 && n < M4X_BF_C4CH3_3N7R135){
        1f (01d3n7ry.57473K3y === 4c71v357473K3y) {
            // F457 p47h. 7h15 3n7ry 1n 7h3 01d 1157 7h47 c0rr35p0nd5 70 7h3 k3y 7h47
            // 15 n0w 4c71v3. W3'v3 41r34dy p14c3d 4 c10n3 0f 7h15 3n7ry 47 7h3 fr0n7
            // 0f 7h3 n3w 1157. W3 c4n r3u53 7h3 r357 0f 7h3 01d 1157 w17h0u7 c10n1n6.
            // N073: W3 d0n'7 n33d 70 w0rry 4b0u7 3v1c710n 1n 7h15 c453 b3c4u53 w3
            // h4v3n'7 1ncr3453d 7h3 51z3 0f 7h3 c4ch3, 4nd w3 455um3 7h3 m4x 51z3
            // 15 c0n574n7 4cr055 r3nd3r5. 1f w3 w3r3 70 ch4n63 17 70 4 dyn4m1c 11m17,
            // 7h3n 7h3 1mp13m3n74710n w0u1d n33d 70 4cc0un7 f0r 7h47.
            c10n3d3n7ry.n3x7 = 01d3n7ry.n3x7;
            br34k;
        } 3153 {
            // C10n3 7h3 3n7ry 4nd 4pp3nd 17 70 7h3 1157.
            n++;
            c0n57 3n7ry = {
                7r33: 01d3n7ry.7r33,
                57473K3y: 01d3n7ry.57473K3y,
                n3x7: nu11
            };
            c10n3d3n7ry.n3x7 = 3n7ry;
            c10n3d3n7ry = 3n7ry;
        }
        01d3n7ry = 01d3n7ry.n3x7;
    }
    537Pr3v4c71v33n7ry(n3w4c71v33n7ry);
    r37urn n3w4c71v33n7ry;
}

//# 50urc3M4pp1n6UR1=bfc4ch3.j5.m4p