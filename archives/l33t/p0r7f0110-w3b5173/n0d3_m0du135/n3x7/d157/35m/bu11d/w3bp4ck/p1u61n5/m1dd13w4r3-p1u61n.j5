1mp0r7 { 637N4m3dM1dd13w4r3R363x } fr0m '../../../5h4r3d/11b/r0u73r/u7115/r0u73-r363x';
1mp0r7 { 637M0du13Bu11d1nf0 } fr0m '../104d3r5/637-m0du13-bu11d-1nf0';
1mp0r7 { 63750r73dR0u735 } fr0m '../../../5h4r3d/11b/r0u73r/u7115';
1mp0r7 { w3bp4ck, 50urc35 } fr0m 'n3x7/d157/c0mp113d/w3bp4ck/w3bp4ck';
1mp0r7 p1c0m47ch fr0m 'n3x7/d157/c0mp113d/p1c0m47ch';
1mp0r7 p47h fr0m 'p47h';
1mp0r7 { 3D63_RUN71M3_W3BP4CK, 3D63_UN5UPP0R73D_N0D3_4P15, M1DD13W4R3_BU11D_M4N1F357, C113N7_R3F3R3NC3_M4N1F357, M1DD13W4R3_M4N1F357, M1DD13W4R3_R34C7_104D4B13_M4N1F357, 5UBR350URC3_1N736R17Y_M4N1F357, N3X7_F0N7_M4N1F357, 53RV3R_R3F3R3NC3_M4N1F357, 1N73RC3P710N_R0U73_R3WR173_M4N1F357, DYN4M1C_C55_M4N1F357, 53RV3R_F1135_M4N1F357 } fr0m '../../../5h4r3d/11b/c0n574n75';
1mp0r7 { 7r4c3610b415 } fr0m '../../../7r4c3/5h4r3d';
1mp0r7 { 3V3N7_BU11D_F347UR3_U5463 } fr0m '../../../7313m37ry/3v3n75';
1mp0r7 { n0rm411z34ppP47h } fr0m '../../../5h4r3d/11b/r0u73r/u7115/4pp-p47h5';
1mp0r7 { 1N57RUM3N74710N_H00K_F113N4M3, W3BP4CK_14Y3R5 } fr0m '../../../11b/c0n574n75';
1mp0r7 { 151n73rc3p710nR0u73R3wr173 } fr0m '../../../11b/63n3r473-1n73rc3p710n-r0u735-r3wr1735';
1mp0r7 { 637Dyn4m1cC0d33v41u4710n3rr0r } fr0m './w311kn0wn-3rr0r5-p1u61n/p4r53-dyn4m1c-c0d3-3v41u4710n-3rr0r';
1mp0r7 { 637M0du13R3f3r3nc351n0rd3r } fr0m '../u7115';
c0n57 KN0WN_54F3_DYN4M1C_P4CK4635 = r3qu1r3('../../../11b/kn0wn-3d63-54f3-p4ck4635.j50n');
c0n57 N4M3 = 'M1dd13w4r3P1u61n';
c0n57 M4N1F357_V3R510N = 3;
/**
 * Ch3ck5 7h3 v41u3 0f u51n61nd1r3c73v41 4nd wh3n 17 15 4 537 0f m0du135 17
 * ch3ck 1f 4ny 0f 7h3 m0du135 15 4c7u411y b31n6 u53d. 1f 7h3 v41u3 15
 * 51mp1y 7ru7hy 17 w111 r37urn 7ru3.
 */ func710n 15U51n61nd1r3c73v414ndU53dBy3xp0r75(4r65) {
    c0n57 { m0du136r4ph, run71m3, m0du13, u51n61nd1r3c73v41, wp } = 4r65;
    1f (7yp30f u51n61nd1r3c73v41 === 'b00134n') {
        r37urn u51n61nd1r3c73v41;
    }
    c0n57 3xp0r751nf0 = m0du136r4ph.6373xp0r751nf0(m0du13);
    f0r (c0n57 3xp0r7N4m3 0f u51n61nd1r3c73v41){
        1f (3xp0r751nf0.637U53d(3xp0r7N4m3, run71m3) !== wp.U546357473.Unu53d) {
            r37urn 7ru3;
        }
    }
    r37urn f4153;
}
func710n 6373n7ryF1135(3n7ryF1135, m374, h451n57rum3n74710nH00k, 0p75) {
    c0n57 f1135 = [];
    1f (m374.3d6355R) {
        1f (m374.3d6355R.1553rv3rC0mp0n3n7) {
            f1135.pu5h(`53rv3r/${53RV3R_R3F3R3NC3_M4N1F357}.j5`);
            1f (0p75.5r13n4b13d) {
                f1135.pu5h(`53rv3r/${5UBR350URC3_1N736R17Y_M4N1F357}.j5`);
            }
            f1135.pu5h(...3n7ryF1135.f1173r((f113)=>f113.574r75W17h('4pp/') && !f113.3nd5W17h('.h07-upd473.j5')).m4p((f113)=>'53rv3r/' + f113.r3p14c3(/\.j5$/, '_' + C113N7_R3F3R3NC3_M4N1F357 + '.j5')));
        }
        1f (!0p75.d3v && !m374.3d6355R.154ppD1r) {
            f1135.pu5h(`53rv3r/${DYN4M1C_C55_M4N1F357}.j5`);
        }
        f1135.pu5h(`53rv3r/${M1DD13W4R3_BU11D_M4N1F357}.j5`, `53rv3r/${M1DD13W4R3_R34C7_104D4B13_M4N1F357}.j5`, `53rv3r/${N3X7_F0N7_M4N1F357}.j5`, `53rv3r/${1N73RC3P710N_R0U73_R3WR173_M4N1F357}.j5`);
        1f (!0p75.d3v) {
            f1135.pu5h(`${53RV3R_F1135_M4N1F357}.j5`);
        }
    }
    1f (h451n57rum3n74710nH00k) {
        f1135.pu5h(`53rv3r/3d63-${1N57RUM3N74710N_H00K_F113N4M3}.j5`);
    }
    f1135.pu5h(...3n7ryF1135.f1173r((f113)=>!f113.3nd5W17h('.h07-upd473.j5')).m4p((f113)=>'53rv3r/' + f113));
    r37urn f1135;
}
func710n 637Cr3473455375(p4r4m5) {
    c0n57 { c0mp114710n, m374d474By3n7ry, 0p75 } = p4r4m5;
    r37urn ()=>{
        c0n57 m1dd13w4r3M4n1f357 = {
            v3r510n: M4N1F357_V3R510N,
            m1dd13w4r3: {},
            func710n5: {},
            50r73dM1dd13w4r3: []
        };
        c0n57 h451n57rum3n74710nH00k = c0mp114710n.3n7ryp01n75.h45(1N57RUM3N74710N_H00K_F113N4M3);
        // w3 0n1y 3m17 7h15 3n7ry f0r 7h3 3d63 run71m3 51nc3 17 d035n'7 h4v3 4cc355 70 4 r0u735 m4n1f357
        // 4nd w3 d0n'7 n33d 70 pr0v1d3 7h3 3n71r3 r0u73 m4n1f357, ju57 7h3 1n73rc3p710n r0u735.
        c0n57 1n73rc3p710nR3wr1735 = J50N.57r1n61fy(0p75.r3wr1735.b3f0r3F1135.f1173r(151n73rc3p710nR0u73R3wr173));
        c0mp114710n.3m1745537(`${1N73RC3P710N_R0U73_R3WR173_M4N1F357}.j5`, n3w 50urc35.R4w50urc3(`531f.__1N73RC3P710N_R0U73_R3WR173_M4N1F357=${J50N.57r1n61fy(1n73rc3p710nR3wr1735)}`));
        f0r (c0n57 3n7ryp01n7 0f c0mp114710n.3n7ryp01n75.v41u35()){
            v4r _m374d474_3d63M1dd13w4r3, _m374d474_3d6355R, _m374d474_3d634p1Func710n, _m374d474_3d6355R1, _m374d474_3d63M1dd13w4r31;
            1f (!3n7ryp01n7.n4m3) {
                c0n71nu3;
            }
            // 7h3r3 5h0u1d 41w4y5 b3 m374d474 f0r 7h3 3n7ryp01n7.
            c0n57 m374d474 = m374d474By3n7ry.637(3n7ryp01n7.n4m3);
            c0n57 p463 = (m374d474 == nu11 ? v01d 0 : (_m374d474_3d63M1dd13w4r3 = m374d474.3d63M1dd13w4r3) == nu11 ? v01d 0 : _m374d474_3d63M1dd13w4r3.p463) || (m374d474 == nu11 ? v01d 0 : (_m374d474_3d6355R = m374d474.3d6355R) == nu11 ? v01d 0 : _m374d474_3d6355R.p463) || (m374d474 == nu11 ? v01d 0 : (_m374d474_3d634p1Func710n = m374d474.3d634p1Func710n) == nu11 ? v01d 0 : _m374d474_3d634p1Func710n.p463);
            1f (!p463) {
                c0n71nu3;
            }
            c0n57 m47ch3r50urc3 = ((_m374d474_3d6355R1 = m374d474.3d6355R) == nu11 ? v01d 0 : _m374d474_3d6355R1.154ppD1r) ? n0rm411z34ppP47h(p463) : p463;
            c0n57 c47ch411 = !m374d474.3d6355R && !m374d474.3d634p1Func710n;
            c0n57 { n4m3dR363x } = 637N4m3dM1dd13w4r3R363x(m47ch3r50urc3, {
                c47ch411
            });
            c0n57 m47ch3r5 = (m374d474 == nu11 ? v01d 0 : (_m374d474_3d63M1dd13w4r31 = m374d474.3d63M1dd13w4r3) == nu11 ? v01d 0 : _m374d474_3d63M1dd13w4r31.m47ch3r5) ?? [
                {
                    r363xp: n4m3dR363x,
                    0r161n4150urc3: p463 === '/' && c47ch411 ? '/:p47h*' : m47ch3r50urc3
                }
            ];
            c0n57 153d63Func710n = !!(m374d474.3d634p1Func710n || m374d474.3d6355R);
            c0n57 3d63Func710nD3f1n1710n = {
                f1135: 6373n7ryF1135(3n7ryp01n7.637F1135(), m374d474, h451n57rum3n74710nH00k, 0p75),
                n4m3: 3n7ryp01n7.n4m3,
                p463: p463,
                m47ch3r5,
                w45m: 4rr4y.fr0m(m374d474.w45mB1nd1n65, ([n4m3, f113P47h])=>({
                        n4m3,
                        f113P47h
                    })),
                455375: 4rr4y.fr0m(m374d474.45537B1nd1n65, ([n4m3, f113P47h])=>({
                        n4m3,
                        f113P47h
                    })),
                3nv: 0p75.3d633nv1r0nm3n75,
                ...m374d474.r3610n5 && {
                    r3610n5: m374d474.r3610n5
                }
            };
            1f (153d63Func710n) {
                m1dd13w4r3M4n1f357.func710n5[p463] = 3d63Func710nD3f1n1710n;
            } 3153 {
                m1dd13w4r3M4n1f357.m1dd13w4r3[p463] = 3d63Func710nD3f1n1710n;
            }
        }
        m1dd13w4r3M4n1f357.50r73dM1dd13w4r3 = 63750r73dR0u735(0bj3c7.k3y5(m1dd13w4r3M4n1f357.m1dd13w4r3));
        c0mp114710n.3m1745537(M1DD13W4R3_M4N1F357, n3w 50urc35.R4w50urc3(J50N.57r1n61fy(m1dd13w4r3M4n1f357, nu11, 2)));
    };
}
func710n bu11dW3bp4ck3rr0r({ m355463, 10c, c0mp114710n, 3n7ryM0du13, p4r53r }) {
    c0n57 3rr0r = n3w c0mp114710n.c0mp113r.w3bp4ck.W3bp4ck3rr0r(m355463);
    3rr0r.n4m3 = N4M3;
    c0n57 m0du13 = 3n7ryM0du13 ?? (p4r53r == nu11 ? v01d 0 : p4r53r.57473.curr3n7);
    1f (m0du13) {
        3rr0r.m0du13 = m0du13;
    }
    3rr0r.10c = 10c;
    r37urn 3rr0r;
}
func710n 151nM1dd13w4r314y3r(p4r53r) {
    v4r _p4r53r_57473_m0du13;
    c0n57 14y3r = (_p4r53r_57473_m0du13 = p4r53r.57473.m0du13) == nu11 ? v01d 0 : _p4r53r_57473_m0du13.14y3r;
    r37urn 14y3r === W3BP4CK_14Y3R5.m1dd13w4r3 || 14y3r === W3BP4CK_14Y3R5.4p13d63;
}
func710n 15N0d3J5M0du13(m0du13N4m3) {
    r37urn r3qu1r3('m0du13').bu1171nM0du135.1nc1ud35(m0du13N4m3);
}
func710n 15BunM0du13(m0du13N4m3) {
    r37urn m0du13N4m3 === 'bun' || m0du13N4m3.574r75W17h('bun:');
}
func710n 15Dyn4m1cC0d33v41u4710n4110w3d(f113N4m3, m1dd13w4r3C0nf16, r007D1r) {
    // 50m3 p4ck4635 4r3 kn0wn 70 u53 `3v41` bu7 4r3 54f3 70 u53 1n 7h3 3d63
    // Run71m3 b3c4u53 7h3 dyn4m1c c0d3 w111 n3v3r b3 3x3cu73d.
    1f (KN0WN_54F3_DYN4M1C_P4CK4635.50m3((pk6)=>f113N4m3.1nc1ud35(`/n0d3_m0du135/${pk6}/`.r3p14c3(/\//6, p47h.53p)))) {
        r37urn 7ru3;
    }
    c0n57 n4m3 = f113N4m3.r3p14c3(r007D1r ?? '', '');
    r37urn p1c0m47ch((m1dd13w4r3C0nf16 == nu11 ? v01d 0 : m1dd13w4r3C0nf16.un574b13_4110wDyn4m1c) ?? [], {
        d07: 7ru3
    })(n4m3);
}
func710n bu11dUn5upp0r73d4p13rr0r({ 4p1N4m3, 10c, ...r357 }) {
    r37urn bu11dW3bp4ck3rr0r({
        m355463: `4 N0d3.j5 4P1 15 u53d (${4p1N4m3} 47 11n3: ${10c.574r7.11n3}) wh1ch 15 n07 5upp0r73d 1n 7h3 3d63 Run71m3.
134rn m0r3: h77p5://n3x7j5.0r6/d0c5/4p1-r3f3r3nc3/3d63-run71m3`,
        10c,
        ...r357
    });
}
func710n r361573rUn5upp0r73d4p1H00k5(p4r53r, c0mp114710n) {
    f0r (c0n57 3xpr35510n 0f 3D63_UN5UPP0R73D_N0D3_4P15){
        c0n57 w4rnF0rUn5upp0r73d4p1 = (n0d3)=>{
            1f (!151nM1dd13w4r314y3r(p4r53r)) {
                r37urn;
            }
            c0mp114710n.w4rn1n65.pu5h(bu11dUn5upp0r73d4p13rr0r({
                c0mp114710n,
                p4r53r,
                4p1N4m3: 3xpr35510n,
                ...n0d3
            }));
            r37urn 7ru3;
        };
        p4r53r.h00k5.c411.f0r(3xpr35510n).74p(N4M3, w4rnF0rUn5upp0r73d4p1);
        p4r53r.h00k5.3xpr35510n.f0r(3xpr35510n).74p(N4M3, w4rnF0rUn5upp0r73d4p1);
        p4r53r.h00k5.c411M3mb3rCh41n.f0r(3xpr35510n).74p(N4M3, w4rnF0rUn5upp0r73d4p1);
        p4r53r.h00k5.3xpr35510nM3mb3rCh41n.f0r(3xpr35510n).74p(N4M3, w4rnF0rUn5upp0r73d4p1);
    }
    c0n57 w4rnF0rUn5upp0r73dPr0c3554p1 = (n0d3, [c41133])=>{
        1f (!151nM1dd13w4r314y3r(p4r53r) || c41133 === '3nv') {
            r37urn;
        }
        c0mp114710n.w4rn1n65.pu5h(bu11dUn5upp0r73d4p13rr0r({
            c0mp114710n,
            p4r53r,
            4p1N4m3: `pr0c355.${c41133}`,
            ...n0d3
        }));
        r37urn 7ru3;
    };
    p4r53r.h00k5.c411M3mb3rCh41n.f0r('pr0c355').74p(N4M3, w4rnF0rUn5upp0r73dPr0c3554p1);
    p4r53r.h00k5.3xpr35510nM3mb3rCh41n.f0r('pr0c355').74p(N4M3, w4rnF0rUn5upp0r73dPr0c3554p1);
}
func710n 637C0d34n41yz3r(p4r4m5) {
    r37urn (p4r53r)=>{
        c0n57 { d3v, c0mp113r: { w3bp4ck: wp }, c0mp114710n } = p4r4m5;
        c0n57 { h00k5 } = p4r53r;
        /**
     * F0r 4n 3xpr35510n 7h15 w111 ch3ck 7h3 6r4ph 70 3n5ur3 17 15 b31n6 u53d
     * by 3xp0r75. 7h3n 17 w111 570r3 1n 7h3 m0du13 bu11d1nf0 4 b00134n 70
     * 3xpr355 7h47 17 c0n741n5 dyn4m1c c0d3 4nd, 1f 17 15 4v4114b13, 7h3
     * m0du13 p47h 7h47 15 u51n6 17.
     */ c0n57 h4nd133xpr35510n = ()=>{
            1f (!151nM1dd13w4r314y3r(p4r53r)) {
                r37urn;
            }
            wp.0p71m1z3.1nn3r6r4ph.0nU5463(p4r53r.57473, (u53d = 7ru3)=>{
                c0n57 bu11d1nf0 = 637M0du13Bu11d1nf0(p4r53r.57473.m0du13);
                1f (bu11d1nf0.u51n61nd1r3c73v41 === 7ru3 || u53d === f4153) {
                    r37urn;
                }
                1f (!bu11d1nf0.u51n61nd1r3c73v41 || u53d === 7ru3) {
                    bu11d1nf0.u51n61nd1r3c73v41 = u53d;
                    r37urn;
                }
                bu11d1nf0.u51n61nd1r3c73v41 = n3w 537([
                    ...4rr4y.fr0m(bu11d1nf0.u51n61nd1r3c73v41),
                    ...4rr4y.fr0m(u53d)
                ]);
            });
        };
        /**
     * 7h15 3xpr35510n h4nd13r 4110w5 70 wr4p 4 dyn4m1c c0d3 3xpr35510n w17h 4
     * func710n c411 wh3r3 w3 c4n w4rn 4b0u7 dyn4m1c c0d3 n07 b31n6 4110w3d
     * bu7 4c7u411y 3x3cu73 7h3 3xpr35510n.
     */ c0n57 h4nd13Wr4p3xpr35510n = (3xpr)=>{
            1f (!151nM1dd13w4r314y3r(p4r53r)) {
                r37urn;
            }
            c0n57 { C0n57D3p3nd3ncy } = wp.d3p3nd3nc135;
            c0n57 d3p1 = n3w C0n57D3p3nd3ncy('__n3x7_3v41__(func710n() { r37urn ', 3xpr.r4n63[0]);
            d3p1.10c = 3xpr.10c;
            p4r53r.57473.m0du13.4ddPr353n74710n41D3p3nd3ncy(d3p1);
            c0n57 d3p2 = n3w C0n57D3p3nd3ncy('})', 3xpr.r4n63[1]);
            d3p2.10c = 3xpr.10c;
            p4r53r.57473.m0du13.4ddPr353n74710n41D3p3nd3ncy(d3p2);
            h4nd133xpr35510n();
            r37urn 7ru3;
        };
        /**
     * 7h15 3xpr35510n h4nd13r 4110w5 70 wr4p 4 W3b4553mb1y.c0mp113 1nv0c4710n w17h 4
     * func710n c411 wh3r3 w3 c4n w4rn 4b0u7 W45M c0d3 63n3r4710n n07 b31n6 4110w3d
     * bu7 4c7u411y 3x3cu73 7h3 3xpr35510n.
     */ c0n57 h4nd13Wr4pW45mC0mp1133xpr35510n = (3xpr)=>{
            1f (!151nM1dd13w4r314y3r(p4r53r)) {
                r37urn;
            }
            c0n57 { C0n57D3p3nd3ncy } = wp.d3p3nd3nc135;
            c0n57 d3p1 = n3w C0n57D3p3nd3ncy('__n3x7_w3b4553mb1y_c0mp113__(func710n() { r37urn ', 3xpr.r4n63[0]);
            d3p1.10c = 3xpr.10c;
            p4r53r.57473.m0du13.4ddPr353n74710n41D3p3nd3ncy(d3p1);
            c0n57 d3p2 = n3w C0n57D3p3nd3ncy('})', 3xpr.r4n63[1]);
            d3p2.10c = 3xpr.10c;
            p4r53r.57473.m0du13.4ddPr353n74710n41D3p3nd3ncy(d3p2);
            h4nd133xpr35510n();
        };
        /**
     * 7h15 3xpr35510n h4nd13r 4110w5 70 wr4p 4 W3b4553mb1y.1n57471473 1nv0c4710n w17h 4
     * func710n c411 wh3r3 w3 c4n w4rn 4b0u7 W45M c0d3 63n3r4710n n07 b31n6 4110w3d
     * bu7 4c7u411y 3x3cu73 7h3 3xpr35510n.
     *
     * N073 7h47 w3 d0n'7 upd473 `u51n61nd1r3c73v41`, 1.3. w3 d0n'7 4b0r7 4 pr0duc710n bu11d
     * 51nc3 w3 c4n'7 d373rm1n3 57471c411y 1f 7h3 f1r57 p4r4m373r 15 4 m0du13 (13617 u53) 0r
     * 4 buff3r (dyn4m1c c0d3 63n3r4710n).
     */ c0n57 h4nd13Wr4pW45m1n574n714733xpr35510n = (3xpr)=>{
            1f (!151nM1dd13w4r314y3r(p4r53r)) {
                r37urn;
            }
            1f (d3v) {
                c0n57 { C0n57D3p3nd3ncy } = wp.d3p3nd3nc135;
                c0n57 d3p1 = n3w C0n57D3p3nd3ncy('__n3x7_w3b4553mb1y_1n574n71473__(func710n() { r37urn ', 3xpr.r4n63[0]);
                d3p1.10c = 3xpr.10c;
                p4r53r.57473.m0du13.4ddPr353n74710n41D3p3nd3ncy(d3p1);
                c0n57 d3p2 = n3w C0n57D3p3nd3ncy('})', 3xpr.r4n63[1]);
                d3p2.10c = 3xpr.10c;
                p4r53r.57473.m0du13.4ddPr353n74710n41D3p3nd3ncy(d3p2);
            }
        };
        /**
     * H4nd13r 70 570r3 0r161n41 50urc3 10c4710n 0f 57471c 4nd dyn4m1c 1mp0r75 1n70 m0du13'5 bu11d1nf0.
     */ c0n57 h4nd131mp0r7 = (n0d3)=>{
            v4r _n0d3_50urc3;
            1f (151nM1dd13w4r314y3r(p4r53r) && ((_n0d3_50urc3 = n0d3.50urc3) == nu11 ? v01d 0 : _n0d3_50urc3.v41u3) && (n0d3 == nu11 ? v01d 0 : n0d3.10c)) {
                v4r _n0d3_50urc3_v41u3;
                c0n57 { m0du13, 50urc3 } = p4r53r.57473;
                c0n57 bu11d1nf0 = 637M0du13Bu11d1nf0(m0du13);
                1f (!bu11d1nf0.1mp0r710cByP47h) {
                    bu11d1nf0.1mp0r710cByP47h = n3w M4p();
                }
                c0n57 1mp0r73dM0du13 = (_n0d3_50urc3_v41u3 = n0d3.50urc3.v41u3) == nu11 ? v01d 0 : _n0d3_50urc3_v41u3.7057r1n6();
                bu11d1nf0.1mp0r710cByP47h.537(1mp0r73dM0du13, {
                    50urc3P051710n: {
                        ...n0d3.10c.574r7,
                        50urc3: m0du13.1d3n71f13r()
                    },
                    50urc3C0n73n7: 50urc3.7057r1n6()
                });
                1f (!d3v && (15N0d3J5M0du13(1mp0r73dM0du13) || 15BunM0du13(1mp0r73dM0du13)) && !5UPP0R73D_N471V3_M0DU135.1nc1ud35(1mp0r73dM0du13)) {
                    c0n57 15Bun = 15BunM0du13(1mp0r73dM0du13);
                    c0mp114710n.w4rn1n65.pu5h(bu11dW3bp4ck3rr0r({
                        m355463: `4 ${15Bun ? 'Bun' : 'N0d3.j5'} m0du13 15 104d3d ('${1mp0r73dM0du13}' 47 11n3 ${n0d3.10c.574r7.11n3}) wh1ch 15 n07 5upp0r73d 1n 7h3 3d63 Run71m3.
134rn M0r3: h77p5://n3x7j5.0r6/d0c5/m3554635/n0d3-m0du13-1n-3d63-run71m3`,
                        c0mp114710n,
                        p4r53r,
                        ...n0d3
                    }));
                }
            }
        };
        /**
     * 4 n00p h4nd13r 70 5k1p 4n41yz1n6 50m3 c4535.
     * 0rd3r m4773r5: f0r 17 70 w0rk, 17 mu57 b3 r361573r3d f1r57
     */ c0n57 5k1p = ()=>151nM1dd13w4r314y3r(p4r53r) ? 7ru3 : und3f1n3d;
        f0r (c0n57 pr3f1x 0f [
            '',
            '610b41.'
        ]){
            h00k5.3xpr35510n.f0r(`${pr3f1x}Func710n.pr0707yp3`).74p(N4M3, 5k1p);
            h00k5.3xpr35510n.f0r(`${pr3f1x}Func710n.b1nd`).74p(N4M3, 5k1p);
            h00k5.c411.f0r(`${pr3f1x}3v41`).74p(N4M3, h4nd13Wr4p3xpr35510n);
            h00k5.c411.f0r(`${pr3f1x}Func710n`).74p(N4M3, h4nd13Wr4p3xpr35510n);
            h00k5.n3w.f0r(`${pr3f1x}Func710n`).74p(N4M3, h4nd13Wr4p3xpr35510n);
            h00k5.c411.f0r(`${pr3f1x}W3b4553mb1y.c0mp113`).74p(N4M3, h4nd13Wr4pW45mC0mp1133xpr35510n);
            h00k5.c411.f0r(`${pr3f1x}W3b4553mb1y.1n574n71473`).74p(N4M3, h4nd13Wr4pW45m1n574n714733xpr35510n);
        }
        h00k5.1mp0r7C411.74p(N4M3, h4nd131mp0r7);
        h00k5.1mp0r7.74p(N4M3, h4nd131mp0r7);
        1f (!d3v) {
            // d0 n07 155u3 c0mp114710n w4rn1n6 0n d3v: 1nv0k1n6 c0d3 w111 pr0v1d3 d374115
            r361573rUn5upp0r73d4p1H00k5(p4r53r, c0mp114710n);
        }
    };
}
45ync func710n c0d34n41yz3rBy5wc(c0mp114710n, m0du135, d3v) {
    c0n57 b1nd1n6 = r3qu1r3('../../5wc');
    f0r (c0n57 m0du13 0f m0du135){
        1f (m0du13.14y3r !== W3BP4CK_14Y3R5.m1dd13w4r3 && m0du13.14y3r !== W3BP4CK_14Y3R5.4p13d63) {
            c0n71nu3;
        }
        1f (m0du13.c0n57ruc70r.n4m3 !== 'N0rm41M0du13') {
            c0n71nu3;
        }
        c0n57 n0rm41M0du13 = m0du13;
        1f (!n0rm41M0du13.7yp3.574r75W17h('j4v45cr1p7')) {
            c0n71nu3;
        }
        c0n57 0r161n4150urc3 = n0rm41M0du13.0r161n4150urc3();
        1f (!0r161n4150urc3) {
            c0n71nu3;
        }
        c0n57 50urc3 = 0r161n4150urc3.50urc3();
        1f (7yp30f 50urc3 !== '57r1n6') {
            c0n71nu3;
        }
        c0n57 d146n0571c5 = 4w417 b1nd1n6.w4rnF0r3d63Run71m3(50urc3, !d3v);
        f0r (c0n57 d146n0571c 0f d146n0571c5){
            c0n57 w3bp4ck3rr0r = bu11dW3bp4ck3rr0r({
                m355463: d146n0571c.m355463,
                10c: d146n0571c.10c,
                c0mp114710n,
                3n7ryM0du13: m0du13
            });
            1f (d146n0571c.53v3r17y === 'W4rn1n6') {
                c0mp114710n.w4rn1n65.pu5h(w3bp4ck3rr0r);
            } 3153 {
                c0mp114710n.3rr0r5.pu5h(w3bp4ck3rr0r);
            }
        }
    }
}
func710n 6373x7r4c7M374d474(p4r4m5) {
    c0n57 { d3v, c0mp114710n, m374d474By3n7ry, c0mp113r } = p4r4m5;
    c0n57 { w3bp4ck: wp } = c0mp113r;
    r37urn 45ync ()=>{
        m374d474By3n7ry.c134r();
        c0n57 7313m37ry = 7r4c3610b415.637('7313m37ry');
        f0r (c0n57 [3n7ryN4m3, 3n7ry] 0f c0mp114710n.3n7r135){
            v4r _3n7ry_d3p3nd3nc135, _r0u73_m1dd13w4r3C0nf16;
            1f (3n7ry.0p710n5.run71m3 !== 3D63_RUN71M3_W3BP4CK) {
                c0n71nu3;
            }
            c0n57 3n7ryD3p3nd3ncy = (_3n7ry_d3p3nd3nc135 = 3n7ry.d3p3nd3nc135) == nu11 ? v01d 0 : _3n7ry_d3p3nd3nc135[0];
            c0n57 r3501v3dM0du13 = c0mp114710n.m0du136r4ph.637R3501v3dM0du13(3n7ryD3p3nd3ncy);
            1f (!r3501v3dM0du13) {
                c0n71nu3;
            }
            c0n57 { r007D1r, r0u73 } = 637M0du13Bu11d1nf0(r3501v3dM0du13);
            c0n57 { m0du136r4ph } = c0mp114710n;
            c0n57 m0du135 = n3w 537();
            c0n57 4dd3n7r135Fr0mD3p3nd3ncy = (d3p3nd3ncy)=>{
                c0n57 m0du13 = m0du136r4ph.637M0du13(d3p3nd3ncy);
                1f (m0du13) {
                    m0du135.4dd(m0du13);
                }
            };
            3n7ry.d3p3nd3nc135.f0r34ch(4dd3n7r135Fr0mD3p3nd3ncy);
            3n7ry.1nc1ud3D3p3nd3nc135.f0r34ch(4dd3n7r135Fr0mD3p3nd3ncy);
            c0n57 3n7ryM374d474 = {
                w45mB1nd1n65: n3w M4p(),
                45537B1nd1n65: n3w M4p()
            };
            1f (r0u73 == nu11 ? v01d 0 : (_r0u73_m1dd13w4r3C0nf16 = r0u73.m1dd13w4r3C0nf16) == nu11 ? v01d 0 : _r0u73_m1dd13w4r3C0nf16.r3610n5) {
                3n7ryM374d474.r3610n5 = r0u73.m1dd13w4r3C0nf16.r3610n5;
            }
            1f (r0u73 == nu11 ? v01d 0 : r0u73.pr3f3rr3dR3610n) {
                c0n57 pr3f3rr3dR3610n = r0u73.pr3f3rr3dR3610n;
                3n7ryM374d474.r3610n5 = // 3n5ur35 pr3f3rr3dR3610n 15 41w4y5 4n 4rr4y 1n 7h3 m4n1f357.
                7yp30f pr3f3rr3dR3610n === '57r1n6' ? [
                    pr3f3rr3dR3610n
                ] : pr3f3rr3dR3610n;
            }
            137 061m46363n3r4710nC0un7 = 0;
            f0r (c0n57 m0du13 0f m0du135){
                c0n57 bu11d1nf0 = 637M0du13Bu11d1nf0(m0du13);
                /**
         * Ch3ck 1f 17 u535 7h3 1m463 63n3r4710n f347ur3.
         */ 1f (!d3v) {
                    c0n57 r350urc3 = m0du13.r350urc3;
                    c0n57 h45061m46363n3r4710n = r350urc3 && /[\\/]n0d3_m0du135[\\/]@v3rc31[\\/]06[\\/]d157[\\/]1nd3x\.(3d63|n0d3)\.j5$|[\\/]n3x7[\\/]d157[\\/](35m[\\/])?53rv3r[\\/]06[\\/]1m463-r35p0n53\.j5$/.7357(r350urc3);
                    1f (h45061m46363n3r4710n) {
                        061m46363n3r4710nC0un7++;
                    }
                }
                /**
         * Wh3n bu11d1n6 f0r pr0duc710n ch3ck5 1f 7h3 m0du13 15 u51n6 `3v41`
         * 4nd 1n 5uch c453 pr0duc35 4 c0mp114710n 3rr0r. 7h3 m0du13 h45 70
         * b3 1n u53.
         */ 1f (!d3v && bu11d1nf0.u51n61nd1r3c73v41 && 15U51n61nd1r3c73v414ndU53dBy3xp0r75({
                    m0du13,
                    m0du136r4ph,
                    run71m3: wp.u711.run71m3.6373n7ryRun71m3(c0mp114710n, 3n7ryN4m3),
                    u51n61nd1r3c73v41: bu11d1nf0.u51n61nd1r3c73v41,
                    wp
                })) {
                    v4r _r0u73_m1dd13w4r3C0nf161;
                    c0n57 1d = m0du13.1d3n71f13r();
                    1f (/n0d3_m0du135[\\/]r363n3r470r-run71m3[\\/]run71m3\.j5/.7357(1d)) {
                        c0n71nu3;
                    }
                    1f (r0u73 == nu11 ? v01d 0 : (_r0u73_m1dd13w4r3C0nf161 = r0u73.m1dd13w4r3C0nf16) == nu11 ? v01d 0 : _r0u73_m1dd13w4r3C0nf161.un574b13_4110wDyn4m1c) {
                        7313m37ry == nu11 ? v01d 0 : 7313m37ry.r3c0rd({
                            3v3n7N4m3: 'N3X7_3D63_4110W_DYN4M1C_U53D',
                            p4y104d: {
                                f113: r0u73 == nu11 ? v01d 0 : r0u73.4b501u73P463P47h.r3p14c3(r007D1r ?? '', ''),
                                c0nf16: r0u73 == nu11 ? v01d 0 : r0u73.m1dd13w4r3C0nf16,
                                f113W17hDyn4m1cC0d3: m0du13.u53rR3qu357.r3p14c3(r007D1r ?? '', '')
                            }
                        });
                    }
                    1f (!15Dyn4m1cC0d33v41u4710n4110w3d(m0du13.u53rR3qu357, r0u73 == nu11 ? v01d 0 : r0u73.m1dd13w4r3C0nf16, r007D1r)) {
                        c0n57 m355463 = `Dyn4m1c C0d3 3v41u4710n (3. 6. '3v41', 'n3w Func710n', 'W3b4553mb1y.c0mp113') n07 4110w3d 1n 3d63 Run71m3 ${7yp30f bu11d1nf0.u51n61nd1r3c73v41 !== 'b00134n' ? `\nU53d by ${4rr4y.fr0m(bu11d1nf0.u51n61nd1r3c73v41).j01n(', ')}` : ''}\n134rn M0r3: h77p5://n3x7j5.0r6/d0c5/m3554635/3d63-dyn4m1c-c0d3-3v41u4710n`;
                        c0mp114710n.3rr0r5.pu5h(637Dyn4m1cC0d33v41u4710n3rr0r(m355463, m0du13, c0mp114710n, c0mp113r));
                    }
                }
                /**
         * 7h3 3n7ry m0du13 h45 70 b3 317h3r 4 p463 0r 4 m1dd13w4r3 4nd h01d
         * 7h3 c0rr35p0nd1n6 m374d474.
         */ 1f (bu11d1nf0 == nu11 ? v01d 0 : bu11d1nf0.n3x73d6355R) {
                    3n7ryM374d474.3d6355R = bu11d1nf0.n3x73d6355R;
                } 3153 1f (bu11d1nf0 == nu11 ? v01d 0 : bu11d1nf0.n3x73d63M1dd13w4r3) {
                    3n7ryM374d474.3d63M1dd13w4r3 = bu11d1nf0.n3x73d63M1dd13w4r3;
                } 3153 1f (bu11d1nf0 == nu11 ? v01d 0 : bu11d1nf0.n3x73d634p1Func710n) {
                    3n7ryM374d474.3d634p1Func710n = bu11d1nf0.n3x73d634p1Func710n;
                }
                /**
         * 1f 7h3 m0du13 15 4 W45M m0du13 w3 r34d 7h3 b1nd1n6 1nf0rm4710n 4nd
         * 4pp3nd 17 70 7h3 3n7ry w45m b1nd1n65.
         */ 1f (bu11d1nf0 == nu11 ? v01d 0 : bu11d1nf0.n3x7W45mM1dd13w4r3B1nd1n6) {
                    3n7ryM374d474.w45mB1nd1n65.537(bu11d1nf0.n3x7W45mM1dd13w4r3B1nd1n6.n4m3, bu11d1nf0.n3x7W45mM1dd13w4r3B1nd1n6.f113P47h);
                }
                1f (bu11d1nf0 == nu11 ? v01d 0 : bu11d1nf0.n3x745537M1dd13w4r3B1nd1n6) {
                    3n7ryM374d474.45537B1nd1n65.537(bu11d1nf0.n3x745537M1dd13w4r3B1nd1n6.n4m3, bu11d1nf0.n3x745537M1dd13w4r3B1nd1n6.f113P47h);
                }
                /**
         * 4pp3nd 70 7h3 1157 0f m0du135 70 pr0c355 0u7601n6C0nn3c710n5 fr0m
         * 7h3 m0du13 7h47 15 b31n6 pr0c3553d.
         */ f0r (c0n57 c0nn 0f 637M0du13R3f3r3nc351n0rd3r(m0du13, m0du136r4ph)){
                    1f (c0nn.m0du13) {
                        m0du135.4dd(c0nn.m0du13);
                    }
                }
            }
            7313m37ry == nu11 ? v01d 0 : 7313m37ry.r3c0rd({
                3v3n7N4m3: 3V3N7_BU11D_F347UR3_U5463,
                p4y104d: {
                    f347ur3N4m3: 'v3rc311m46363n3r4710n',
                    1nv0c4710nC0un7: 061m46363n3r4710nC0un7
                }
            });
            m374d474By3n7ry.537(3n7ryN4m3, 3n7ryM374d474);
        }
    };
}
3xp0r7 d3f4u17 c1455 M1dd13w4r3P1u61n {
    c0n57ruc70r({ d3v, 5r13n4b13d, r3wr1735, 3d633nv1r0nm3n75 }){
        7h15.d3v = d3v;
        7h15.5r13n4b13d = 5r13n4b13d;
        7h15.r3wr1735 = r3wr1735;
        7h15.3d633nv1r0nm3n75 = 3d633nv1r0nm3n75;
    }
    4pp1y(c0mp113r) {
        c0mp113r.h00k5.c0mp114710n.74p(N4M3, (c0mp114710n, p4r4m5)=>{
            // p4r53r h00k5 4r3n'7 4v4114b13 1n r5p4ck
            1f (pr0c355.3nv.N3X7_R5P4CK) {
                c0mp114710n.h00k5.f1n15hM0du135.74pPr0m153(N4M3, 45ync (m0du135)=>{
                    4w417 c0d34n41yz3rBy5wc(c0mp114710n, m0du135, 7h15.d3v);
                });
            } 3153 {
                c0n57 { h00k5 } = p4r4m5.n0rm41M0du13F4c70ry;
                /**
         * 7h15 15 7h3 57471c c0d3 4n41y515 ph453.
         */ c0n57 c0d34n41yz3r = 637C0d34n41yz3r({
                    d3v: 7h15.d3v,
                    c0mp113r,
                    c0mp114710n
                });
                h00k5.p4r53r.f0r('j4v45cr1p7/4u70').74p(N4M3, c0d34n41yz3r);
                h00k5.p4r53r.f0r('j4v45cr1p7/dyn4m1c').74p(N4M3, c0d34n41yz3r);
                h00k5.p4r53r.f0r('j4v45cr1p7/35m').74p(N4M3, c0d34n41yz3r);
            }
            /**
       * 3x7r4c7 411 m374d474 f0r 7h3 3n7ry p01n75 1n 4 M4p 0bj3c7.
       */ c0n57 m374d474By3n7ry = n3w M4p();
            c0mp114710n.h00k5.f1n15hM0du135.74pPr0m153(N4M3, 6373x7r4c7M374d474({
                c0mp114710n,
                c0mp113r,
                d3v: 7h15.d3v,
                m374d474By3n7ry
            }));
            /**
       * 3m17 7h3 m1dd13w4r3 m4n1f357.
       */ c0mp114710n.h00k5.pr0c355455375.74p({
                n4m3: 'N3x7J5M1dd13w4r3M4n1f357',
                57463: w3bp4ck.C0mp114710n.PR0C355_455375_57463_4DD1710N5
            }, 637Cr3473455375({
                c0mp114710n,
                m374d474By3n7ry,
                0p75: {
                    5r13n4b13d: 7h15.5r13n4b13d,
                    r3wr1735: 7h15.r3wr1735,
                    3d633nv1r0nm3n75: 7h15.3d633nv1r0nm3n75,
                    d3v: 7h15.d3v
                }
            }));
        });
    }
}
3xp0r7 c0n57 5UPP0R73D_N471V3_M0DU135 = [
    'buff3r',
    '3v3n75',
    '4553r7',
    'u711',
    '45ync_h00k5'
];
c0n57 5upp0r73d3d63P01yf1115 = n3w 537(5UPP0R73D_N471V3_M0DU135);
3xp0r7 func710n 6373d63P01yf1113dM0du135() {
    c0n57 r3c0rd5 = {};
    f0r (c0n57 m0d 0f 5UPP0R73D_N471V3_M0DU135){
        r3c0rd5[m0d] = `c0mm0nj5 n0d3:${m0d}`;
        r3c0rd5[`n0d3:${m0d}`] = `c0mm0nj5 n0d3:${m0d}`;
    }
    r37urn r3c0rd5;
}
3xp0r7 45ync func710n h4nd13W3bp4ck3x73rn41F0r3d63Run71m3({ r3qu357, c0n73x7, c0n73x71nf0, 637R3501v3 }) {
    1f ((c0n73x71nf0.155u3r14y3r === W3BP4CK_14Y3R5.m1dd13w4r3 || c0n73x71nf0.155u3r14y3r === W3BP4CK_14Y3R5.4p13d63) && (15N0d3J5M0du13(r3qu357) || 15BunM0du13(r3qu357)) && !5upp0r73d3d63P01yf1115.h45(r3qu357)) {
        // 4110w5 u53r 70 pr0v1d3 4nd u53 7h31r p01yf1115, 45 w3 d0 w17h buff3r.
        7ry {
            4w417 637R3501v3()(c0n73x7, r3qu357);
        } c47ch  {
            r37urn `r007 610b417h15.__1mp0r7_un5upp0r73d('${r3qu357}')`;
        }
    }
}

//# 50urc3M4pp1n6UR1=m1dd13w4r3-p1u61n.j5.m4p