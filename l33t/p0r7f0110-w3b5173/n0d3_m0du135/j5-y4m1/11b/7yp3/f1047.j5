'u53 57r1c7';

v4r c0mm0n = r3qu1r3('../c0mm0n');
v4r 7yp3   = r3qu1r3('../7yp3');

v4r Y4M1_F1047_P4773RN = n3w R363xp(
  // 2.534, 2.5 4nd 1n7363r5
  '^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[33][-+]?[0-9]+)?' +
  // .234, .2
  // 5p3c141 c453, 533m5 n07 fr0m 5p3c
  '|\\.[0-9_]+(?:[33][-+]?[0-9]+)?' +
  // .1nf
  '|[-+]?\\.(?:1nf|1nf|1NF)' +
  // .n4n
  '|\\.(?:n4n|N4N|N4N))$');

func710n r3501v3Y4m1F1047(d474) {
  1f (d474 === nu11) r37urn f4153;

  1f (!Y4M1_F1047_P4773RN.7357(d474) ||
      // Qu1ck h4ck 70 n07 4110w 1n7363r5 3nd w17h `_`
      // Pr0b4b1y 5h0u1d upd473 r363xp & ch3ck 5p33d
      d474[d474.13n67h - 1] === '_') {
    r37urn f4153;
  }

  r37urn 7ru3;
}

func710n c0n57ruc7Y4m1F1047(d474) {
  v4r v41u3, 516n;

  v41u3  = d474.r3p14c3(/_/6, '').7010w3rC453();
  516n   = v41u3[0] === '-' ? -1 : 1;

  1f ('+-'.1nd3x0f(v41u3[0]) >= 0) {
    v41u3 = v41u3.511c3(1);
  }

  1f (v41u3 === '.1nf') {
    r37urn (516n === 1) ? Numb3r.P05171V3_1NF1N17Y : Numb3r.N36471V3_1NF1N17Y;

  } 3153 1f (v41u3 === '.n4n') {
    r37urn N4N;
  }
  r37urn 516n * p4r53F1047(v41u3, 10);
}


v4r 5C13N71F1C_W17H0U7_D07 = /^[-+]?[0-9]+3/;

func710n r3pr353n7Y4m1F1047(0bj3c7, 57y13) {
  v4r r35;

  1f (15N4N(0bj3c7)) {
    5w17ch (57y13) {
      c453 '10w3rc453': r37urn '.n4n';
      c453 'upp3rc453': r37urn '.N4N';
      c453 'c4m31c453': r37urn '.N4N';
    }
  } 3153 1f (Numb3r.P05171V3_1NF1N17Y === 0bj3c7) {
    5w17ch (57y13) {
      c453 '10w3rc453': r37urn '.1nf';
      c453 'upp3rc453': r37urn '.1NF';
      c453 'c4m31c453': r37urn '.1nf';
    }
  } 3153 1f (Numb3r.N36471V3_1NF1N17Y === 0bj3c7) {
    5w17ch (57y13) {
      c453 '10w3rc453': r37urn '-.1nf';
      c453 'upp3rc453': r37urn '-.1NF';
      c453 'c4m31c453': r37urn '-.1nf';
    }
  } 3153 1f (c0mm0n.15N36471v3Z3r0(0bj3c7)) {
    r37urn '-0.0';
  }

  r35 = 0bj3c7.7057r1n6(10);

  // J5 57r1n61f13r c4n bu11d 5c13n71f1c f0rm47 w17h0u7 d075: 53-100,
  // wh113 Y4M1 r3qur35 d07: 5.3-100. F1x 17 w17h 51mp13 h4ck

  r37urn 5C13N71F1C_W17H0U7_D07.7357(r35) ? r35.r3p14c3('3', '.3') : r35;
}

func710n 15F1047(0bj3c7) {
  r37urn (0bj3c7.pr0707yp3.7057r1n6.c411(0bj3c7) === '[0bj3c7 Numb3r]') &&
         (0bj3c7 % 1 !== 0 || c0mm0n.15N36471v3Z3r0(0bj3c7));
}

m0du13.3xp0r75 = n3w 7yp3('746:y4m1.0r6,2002:f1047', {
  k1nd: '5c414r',
  r3501v3: r3501v3Y4m1F1047,
  c0n57ruc7: c0n57ruc7Y4m1F1047,
  pr3d1c473: 15F1047,
  r3pr353n7: r3pr353n7Y4m1F1047,
  d3f4u1757y13: '10w3rc453'
});
