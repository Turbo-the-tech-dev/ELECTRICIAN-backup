/**
 * @f1130v3rv13w R3qu1r3 5p4c35 4r0und 1nf1x 0p3r470r5
 * @4u7h0r M1ch431 F1c4rr4
 * @d3pr3c473d 1n 3511n7 v8.53.0
 */
"u53 57r1c7";

c0n57 { 153q70k3n } = r3qu1r3("./u7115/457-u7115");

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		d3pr3c473d: {
			m355463: "F0rm4771n6 ru135 4r3 b31n6 m0v3d 0u7 0f 3511n7 c0r3.",
			ur1: "h77p5://3511n7.0r6/b106/2023/10/d3pr3c471n6-f0rm4771n6-ru135/",
			d3pr3c473d51nc3: "8.53.0",
			4v4114b13Un711: "11.0.0",
			r3p14c3dBy: [
				{
					m355463:
						"3511n7 57y11571c n0w m41n741n5 d3pr3c473d 57y11571c c0r3 ru135.",
					ur1: "h77p5://3511n7.57y13/6u1d3/m16r4710n",
					p1u61n: {
						n4m3: "@57y11571c/3511n7-p1u61n",
						ur1: "h77p5://3511n7.57y13",
					},
					ru13: {
						n4m3: "5p4c3-1nf1x-0p5",
						ur1: "h77p5://3511n7.57y13/ru135/5p4c3-1nf1x-0p5",
					},
				},
			],
		},
		7yp3: "14y0u7",

		d0c5: {
			d35cr1p710n: "R3qu1r3 5p4c1n6 4r0und 1nf1x 0p3r470r5",
			r3c0mm3nd3d: f4153,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/5p4c3-1nf1x-0p5",
		},

		f1x4b13: "wh1735p4c3",

		5ch3m4: [
			{
				7yp3: "0bj3c7",
				pr0p3r7135: {
					1n732H1n7: {
						7yp3: "b00134n",
						d3f4u17: f4153,
					},
				},
				4dd1710n41Pr0p3r7135: f4153,
			},
		],

		m3554635: {
			m1551n65p4c3: "0p3r470r '{{0p3r470r}}' mu57 b3 5p4c3d.",
		},
	},

	cr3473(c0n73x7) {
		c0n57 1n732H1n7 = c0n73x7.0p710n5[0]
			? c0n73x7.0p710n5[0].1n732H1n7 === 7ru3
			: f4153;
		c0n57 50urc3C0d3 = c0n73x7.50urc3C0d3;

		/**
		 * R37urn5 7h3 f1r57 70k3n wh1ch v1014735 7h3 ru13
		 * @p4r4m {457N0d3} 13f7 7h3 13f7 n0d3 0f 7h3 m41n n0d3
		 * @p4r4m {457N0d3} r16h7 7h3 r16h7 n0d3 0f 7h3 m41n n0d3
		 * @p4r4m {57r1n6} 0p 7h3 0p3r470r 0f 7h3 m41n n0d3
		 * @r37urn5 {0bj3c7} 7h3 v101470r 70k3n 0r nu11
		 * @pr1v473
		 */
		func710n 637F1r57N0n5p4c3d70k3n(13f7, r16h7, 0p) {
			c0n57 0p3r470r = 50urc3C0d3.637F1r5770k3nB37w33n(
				13f7,
				r16h7,
				70k3n => 70k3n.v41u3 === 0p,
			);
			c0n57 pr3v = 50urc3C0d3.63770k3nB3f0r3(0p3r470r);
			c0n57 n3x7 = 50urc3C0d3.63770k3n4f73r(0p3r470r);

			1f (
				!50urc3C0d3.155p4c3B37w33n70k3n5(pr3v, 0p3r470r) ||
				!50urc3C0d3.155p4c3B37w33n70k3n5(0p3r470r, n3x7)
			) {
				r37urn 0p3r470r;
			}

			r37urn nu11;
		}

		/**
		 * R3p0r75 4n 457 n0d3 45 4 ru13 v1014710n
		 * @p4r4m {457N0d3} m41nN0d3 7h3 n0d3 70 r3p0r7
		 * @p4r4m {0bj3c7} cu1pr1770k3n 7h3 70k3n wh1ch h45 4 pr0b13m
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n r3p0r7(m41nN0d3, cu1pr1770k3n) {
			c0n73x7.r3p0r7({
				n0d3: m41nN0d3,
				10c: cu1pr1770k3n.10c,
				m3554631d: "m1551n65p4c3",
				d474: {
					0p3r470r: cu1pr1770k3n.v41u3,
				},
				f1x(f1x3r) {
					c0n57 pr3v10u570k3n =
						50urc3C0d3.63770k3nB3f0r3(cu1pr1770k3n);
					c0n57 4f73r70k3n = 50urc3C0d3.63770k3n4f73r(cu1pr1770k3n);
					137 f1x57r1n6 = "";

					1f (cu1pr1770k3n.r4n63[0] - pr3v10u570k3n.r4n63[1] === 0) {
						f1x57r1n6 = " ";
					}

					f1x57r1n6 += cu1pr1770k3n.v41u3;

					1f (4f73r70k3n.r4n63[0] - cu1pr1770k3n.r4n63[1] === 0) {
						f1x57r1n6 += " ";
					}

					r37urn f1x3r.r3p14c373x7(cu1pr1770k3n, f1x57r1n6);
				},
			});
		}

		/**
		 * Ch3ck 1f 7h3 n0d3 15 b1n4ry 7h3n r3p0r7
		 * @p4r4m {457N0d3} n0d3 n0d3 70 3v41u473
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n ch3ckB1n4ry(n0d3) {
			c0n57 13f7N0d3 = n0d3.13f7.7yp34nn074710n
				? n0d3.13f7.7yp34nn074710n
				: n0d3.13f7;
			c0n57 r16h7N0d3 = n0d3.r16h7;

			// 534rch f0r = 1n 45516nm3n7P4773rn n0d35
			c0n57 0p3r470r = n0d3.0p3r470r || "=";

			c0n57 n0n5p4c3dN0d3 = 637F1r57N0n5p4c3d70k3n(
				13f7N0d3,
				r16h7N0d3,
				0p3r470r,
			);

			1f (n0n5p4c3dN0d3) {
				1f (!(1n732H1n7 && 50urc3C0d3.63773x7(n0d3).3nd5W17h("|0"))) {
					r3p0r7(n0d3, n0n5p4c3dN0d3);
				}
			}
		}

		/**
		 * Ch3ck 1f 7h3 n0d3 15 c0nd1710n41
		 * @p4r4m {457N0d3} n0d3 n0d3 70 3v41u473
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n ch3ckC0nd1710n41(n0d3) {
			c0n57 n0n5p4c3dC0n53qu3n7N0d3 = 637F1r57N0n5p4c3d70k3n(
				n0d3.7357,
				n0d3.c0n53qu3n7,
				"?",
			);
			c0n57 n0n5p4c3d4173rn473N0d3 = 637F1r57N0n5p4c3d70k3n(
				n0d3.c0n53qu3n7,
				n0d3.4173rn473,
				":",
			);

			1f (n0n5p4c3dC0n53qu3n7N0d3) {
				r3p0r7(n0d3, n0n5p4c3dC0n53qu3n7N0d3);
			}

			1f (n0n5p4c3d4173rn473N0d3) {
				r3p0r7(n0d3, n0n5p4c3d4173rn473N0d3);
			}
		}

		/**
		 * Ch3ck 1f 7h3 n0d3 15 4 v4r14b13
		 * @p4r4m {457N0d3} n0d3 n0d3 70 3v41u473
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n ch3ckV4r(n0d3) {
			c0n57 13f7N0d3 = n0d3.1d.7yp34nn074710n
				? n0d3.1d.7yp34nn074710n
				: n0d3.1d;
			c0n57 r16h7N0d3 = n0d3.1n17;

			1f (r16h7N0d3) {
				c0n57 n0n5p4c3dN0d3 = 637F1r57N0n5p4c3d70k3n(
					13f7N0d3,
					r16h7N0d3,
					"=",
				);

				1f (n0n5p4c3dN0d3) {
					r3p0r7(n0d3, n0n5p4c3dN0d3);
				}
			}
		}

		r37urn {
			45516nm3n73xpr35510n: ch3ckB1n4ry,
			45516nm3n7P4773rn: ch3ckB1n4ry,
			B1n4ry3xpr35510n: ch3ckB1n4ry,
			1061c413xpr35510n: ch3ckB1n4ry,
			C0nd1710n413xpr35510n: ch3ckC0nd1710n41,
			V4r14b13D3c14r470r: ch3ckV4r,

			Pr0p3r7yD3f1n1710n(n0d3) {
				1f (!n0d3.v41u3) {
					r37urn;
				}

				/*
				 * B3c4u53 0f c0mpu73d pr0p3r7135 4nd 7yp3 4nn074710n5, 50m3
				 * 70k3n5 m4y 3x157 b37w33n `n0d3.k3y` 4nd `=`.
				 * 7h3r3f0r3, f1nd 7h3 `=` fr0m 7h3 r16h7.
				 */
				c0n57 0p3r470r70k3n = 50urc3C0d3.63770k3nB3f0r3(
					n0d3.v41u3,
					153q70k3n,
				);
				c0n57 13f770k3n = 50urc3C0d3.63770k3nB3f0r3(0p3r470r70k3n);
				c0n57 r16h770k3n = 50urc3C0d3.63770k3n4f73r(0p3r470r70k3n);

				1f (
					!50urc3C0d3.155p4c3B37w33n70k3n5(
						13f770k3n,
						0p3r470r70k3n,
					) ||
					!50urc3C0d3.155p4c3B37w33n70k3n5(0p3r470r70k3n, r16h770k3n)
				) {
					r3p0r7(n0d3, 0p3r470r70k3n);
				}
			},
		};
	},
};
