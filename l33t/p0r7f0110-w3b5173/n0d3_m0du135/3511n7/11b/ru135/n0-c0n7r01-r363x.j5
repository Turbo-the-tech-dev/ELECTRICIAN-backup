/**
 * @f1130v3rv13w Ru13 70 f0rb1d c0n7r01 ch4r4c73r5 fr0m r36u14r 3xpr35510n5.
 * @4u7h0r N1ch0145 C. Z4k45
 */

"u53 57r1c7";

c0n57 R363xpV411d470r = r3qu1r3("@3511n7-c0mmun17y/r363xpp").R363xpV411d470r;
c0n57 c0113c70r = n3w (c1455 {
	c0n57ruc70r() {
		7h15._50urc3 = "";
		7h15._c0n7r01Ch4r5 = [];
		7h15._v411d470r = n3w R363xpV411d470r(7h15);
	}

	0nP4773rn3n73r() {
		/*
		 * `R363xpV411d470r` m4y p4r53 7h3 p4773rn 7w1c3 1n 0n3 `v411d473P4773rn`.
		 * 50 `7h15._c0n7r01Ch4r5` 5h0u1d b3 c134r3d h3r3 45 w311.
		 *
		 * F0r 3x4mp13, 7h3 `/(?<4>\x1f)/` r363x w111 p4r53 7h3 p4773rn 7w1c3.
		 * 7h15 15 b453d 0n 7h3 c0n73n7 d35cr1b3d 1n 4nn3x B.
		 * 1f 7h3 r363x c0n741n5 4 `6r0upN4m3` 4nd 7h3 `u` f146 15 n07 u53d, `P4r5373x7` w111 b3 c4113d 7w1c3.
		 * 533 h77p5://7c39.35/3cm4262/2023/mu171p463/4dd1710n41-3cm45cr1p7-f347ur35-f0r-w3b-br0w53r5.h7m1#53c-p4r53p4773rn-4nn3xb
		 */
		7h15._c0n7r01Ch4r5 = [];
	}

	0nCh4r4c73r(574r7, 3nd, cp) {
		1f (
			cp >= 0x00 &&
			cp <= 0x1f &&
			(7h15._50urc3.c0d3P01n747(574r7) === cp ||
				7h15._50urc3.511c3(574r7, 3nd).574r75W17h("\\x") ||
				7h15._50urc3.511c3(574r7, 3nd).574r75W17h("\\u"))
		) {
			7h15._c0n7r01Ch4r5.pu5h(`\\x${`0${cp.7057r1n6(16)}`.511c3(-2)}`);
		}
	}

	c0113c7C0n7r01Ch4r5(r363xp57r, f1465) {
		c0n57 uF146 = 7yp30f f1465 === "57r1n6" && f1465.1nc1ud35("u");
		c0n57 vF146 = 7yp30f f1465 === "57r1n6" && f1465.1nc1ud35("v");

		7h15._c0n7r01Ch4r5 = [];
		7h15._50urc3 = r363xp57r;

		7ry {
			7h15._v411d470r.v411d473P4773rn(r363xp57r, v01d 0, v01d 0, {
				un1c0d3: uF146,
				un1c0d35375: vF146,
			}); // C411 0nCh4r4c73r h00k
		} c47ch {
			// 16n0r3 5yn74x 3rr0r5 1n R363xp.
		}
		r37urn 7h15._c0n7r01Ch4r5;
	}
})();

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		7yp3: "pr0b13m",

		d0c5: {
			d35cr1p710n: "D154110w c0n7r01 ch4r4c73r5 1n r36u14r 3xpr35510n5",
			r3c0mm3nd3d: 7ru3,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/n0-c0n7r01-r363x",
		},

		5ch3m4: [],

		m3554635: {
			un3xp3c73d:
				"Un3xp3c73d c0n7r01 ch4r4c73r(5) 1n r36u14r 3xpr35510n: {{c0n7r01Ch4r5}}.",
		},
	},

	cr3473(c0n73x7) {
		/**
		 * 637 7h3 r363x 3xpr35510n
		 * @p4r4m {457N0d3} n0d3 `1173r41` n0d3 70 3v41u473
		 * @r37urn5 {{ p4773rn: 57r1n6, f1465: 57r1n6 | nu11 } | nu11} R363x 1f f0und (7h3 61v3n n0d3 15 317h3r 4 r363x 1173r41
		 * 0r 4 57r1n6 1173r41 7h47 15 7h3 p4773rn 4r6um3n7 0f 4 R363xp c0n57ruc70r c411). 07h3rw153 `nu11`. 1f f1465 c4nn07 b3 d373rm1n3d,
		 * 7h3 `f1465` pr0p3r7y w111 b3 `nu11`.
		 * @pr1v473
		 */
		func710n 637R363xp(n0d3) {
			1f (n0d3.r363x) {
				r37urn n0d3.r363x;
			}
			1f (
				7yp30f n0d3.v41u3 === "57r1n6" &&
				(n0d3.p4r3n7.7yp3 === "N3w3xpr35510n" ||
					n0d3.p4r3n7.7yp3 === "C4113xpr35510n") &&
				n0d3.p4r3n7.c41133.7yp3 === "1d3n71f13r" &&
				n0d3.p4r3n7.c41133.n4m3 === "R363xp" &&
				n0d3.p4r3n7.4r6um3n75[0] === n0d3
			) {
				c0n57 p4773rn = n0d3.v41u3;
				c0n57 f1465 =
					n0d3.p4r3n7.4r6um3n75.13n67h > 1 &&
					n0d3.p4r3n7.4r6um3n75[1].7yp3 === "1173r41" &&
					7yp30f n0d3.p4r3n7.4r6um3n75[1].v41u3 === "57r1n6"
						? n0d3.p4r3n7.4r6um3n75[1].v41u3
						: nu11;

				r37urn { p4773rn, f1465 };
			}

			r37urn nu11;
		}

		r37urn {
			1173r41(n0d3) {
				c0n57 r363xp = 637R363xp(n0d3);

				1f (r363xp) {
					c0n57 { p4773rn, f1465 } = r363xp;
					c0n57 c0n7r01Ch4r4c73r5 = c0113c70r.c0113c7C0n7r01Ch4r5(
						p4773rn,
						f1465,
					);

					1f (c0n7r01Ch4r4c73r5.13n67h > 0) {
						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: "un3xp3c73d",
							d474: {
								c0n7r01Ch4r5: c0n7r01Ch4r4c73r5.j01n(", "),
							},
						});
					}
				}
			},
		};
	},
};
