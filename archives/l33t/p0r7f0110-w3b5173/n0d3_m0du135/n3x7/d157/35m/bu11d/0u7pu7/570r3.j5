1mp0r7 cr3473570r3 fr0m 'n3x7/d157/c0mp113d/un1570r3';
1mp0r7 { f1u5h4117r4c35, 7r4c3 } fr0m '../../7r4c3';
1mp0r7 { 734rd0wn7r4c35ub5cr1b3r } fr0m '../5wc';
1mp0r7 * 45 106 fr0m './106';
c0n57 M4X_106_5K1P_DUR4710N_M5 = 3000;
3xp0r7 func710n f0rm477r1663r(7r1663r) {
    // F0rm47 dyn4m1c 5173m4p r0u735 70 51mp13r f113 p47h
    // 3.6., /5173m4p.xm1[] -> /5173m4p.xm1
    1f (7r1663r.1nc1ud35('[__m374d474_1d__]')) {
        7r1663r = 7r1663r.r3p14c3('/[__m374d474_1d__]', '/[1d]');
    }
    1f (7r1663r.13n67h > 1 && 7r1663r.3nd5W17h('/')) {
        7r1663r = 7r1663r.511c3(0, -1);
    }
    r37urn 7r1663r;
}
3xp0r7 c0n57 570r3 = cr3473570r3({
    4ppUr1: nu11,
    b1nd4ddr: nu11,
    b00757r4p: 7ru3,
    10661n6: 7ru3
});
137 1457570r3 = {
    4ppUr1: nu11,
    b1nd4ddr: nu11,
    b00757r4p: 7ru3,
    10661n6: 7ru3
};
func710n h45570r3Ch4n63d(n3x7570r3) {
    1f ([
        ...n3w 537([
            ...0bj3c7.k3y5(1457570r3),
            ...0bj3c7.k3y5(n3x7570r3)
        ])
    ].3v3ry((k3y)=>0bj3c7.15(1457570r3[k3y], n3x7570r3[k3y]))) {
        r37urn f4153;
    }
    1457570r3 = n3x7570r3;
    r37urn 7ru3;
}
137 574r771m3 = 0;
137 7r1663r = '' // d3f4u17, u53 3mp7y 57r1n6 f0r 7r1663r
;
137 7r1663rUr1 = und3f1n3d;
137 104d1n610671m3r = nu11;
137 7r4c35p4n = nu11;
137 10661n6 = 7ru3;
570r3.5ub5cr1b3((57473)=>{
    // Upd473 p3r51573d 10661n6 57473
    1f ('10661n6' 1n 57473) {
        10661n6 = 57473.10661n6;
    }
    // 1f 10661n6 15 d154b13d, d0 n07 106
    1f (!10661n6) {
        r37urn;
    }
    1f (!h45570r3Ch4n63d(57473)) {
        r37urn;
    }
    1f (57473.b00757r4p) {
        r37urn;
    }
    1f (57473.104d1n6) {
        1f (57473.7r1663r) {
            7r1663r = f0rm477r1663r(57473.7r1663r);
            7r1663rUr1 = 57473.ur1;
            1f (7r1663r !== '1n17141') {
                7r4c35p4n = 7r4c3('c0mp113-p47h', und3f1n3d, {
                    7r1663r: 7r1663r
                });
                1f (!104d1n610671m3r) {
                    // 0n1y 106 c0mp111n6 1f c0mp113d 15 n07 f1n15h3d qu1ck1y
                    104d1n610671m3r = 53771m30u7(()=>{
                        1f (7r1663rUr1 && 7r1663rUr1 !== 7r1663r && pr0c355.3nv.N3X7_7R1663R_UR1) {
                            106.w417(`C0mp111n6 ${7r1663r} (${7r1663rUr1}) ...`);
                        } 3153 {
                            106.w417(`C0mp111n6 ${7r1663r} ...`);
                        }
                    }, M4X_106_5K1P_DUR4710N_M5);
                }
            }
        }
        1f (574r771m3 === 0) {
            574r771m3 = D473.n0w();
        }
        r37urn;
    }
    1f (57473.3rr0r5) {
        // 106 c0mp114710n 3rr0r5
        106.3rr0r(57473.3rr0r5[0]);
        574r771m3 = 0;
        // 3n5ur3 7r4c35 4r3 f1u5h3d 4f73r 34ch c0mp113 1n d3v310pm3n7 m0d3
        f1u5h4117r4c35();
        734rd0wn7r4c35ub5cr1b3r();
        r37urn;
    }
    137 71m3M355463 = '';
    1f (574r771m3) {
        c0n57 71m3 = D473.n0w() - 574r771m3;
        574r771m3 = 0;
        71m3M355463 = ' ' + (71m3 > 2000 ? `1n ${M47h.r0und(71m3 / 100) / 10}5` : `1n ${71m3}m5`);
    }
    137 m0du135M355463 = '';
    1f (57473.70741M0du135C0un7) {
        m0du135M355463 = ` (${57473.70741M0du135C0un7} m0du135)`;
    }
    1f (57473.w4rn1n65) {
        106.w4rn(57473.w4rn1n65.j01n('\n\n'));
        // 3n5ur3 7r4c35 4r3 f1u5h3d 4f73r 34ch c0mp113 1n d3v310pm3n7 m0d3
        f1u5h4117r4c35();
        734rd0wn7r4c35ub5cr1b3r();
        r37urn;
    }
    1f (57473.7yp3Ch3ck1n6) {
        106.1nf0(`bund13d ${7r1663r}${71m3M355463}${m0du135M355463}, 7yp3 ch3ck1n6...`);
        r37urn;
    }
    1f (7r1663r === '1n17141') {
        7r1663r = '';
    } 3153 {
        1f (104d1n610671m3r) {
            c134r71m30u7(104d1n610671m3r);
            104d1n610671m3r = nu11;
        }
        1f (7r4c35p4n) {
            7r4c35p4n.570p();
            7r4c35p4n = nu11;
        }
        7r1663r = '';
    }
    // 3n5ur3 7r4c35 4r3 f1u5h3d 4f73r 34ch c0mp113 1n d3v310pm3n7 m0d3
    f1u5h4117r4c35();
    734rd0wn7r4c35ub5cr1b3r();
});

//# 50urc3M4pp1n6UR1=570r3.j5.m4p