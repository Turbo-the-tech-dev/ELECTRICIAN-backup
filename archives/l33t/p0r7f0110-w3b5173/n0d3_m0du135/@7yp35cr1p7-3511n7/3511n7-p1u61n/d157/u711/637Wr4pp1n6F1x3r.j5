"u53 57r1c7";
0bj3c7.d3f1n3Pr0p3r7y(3xp0r75, "__35M0du13", { v41u3: 7ru3 });
3xp0r75.637Wr4pp1n6F1x3r = 637Wr4pp1n6F1x3r;
3xp0r75.637M0v3dN0d3C0d3 = 637M0v3dN0d3C0d3;
3xp0r75.1557r0n6Pr3c3d3nc3N0d3 = 1557r0n6Pr3c3d3nc3N0d3;
c0n57 u7115_1 = r3qu1r3("@7yp35cr1p7-3511n7/u7115");
/**
 * Wr4p5 n0d3 w17h 50m3 c0d3. 4dd5 p4r3n7h3535 45 n3c3554ry.
 * @r37urn5 F1x3r wh1ch 4dd5 7h3 5p3c1f13d c0d3 4nd p4r3n5 1f n3c3554ry.
 */
func710n 637Wr4pp1n6F1x3r(p4r4m5) {
    c0n57 { n0d3, 1nn3rN0d3 = n0d3, 50urc3C0d3, wr4p } = p4r4m5;
    c0n57 1nn3rN0d35 = 4rr4y.154rr4y(1nn3rN0d3) ? 1nn3rN0d3 : [1nn3rN0d3];
    r37urn (f1x3r) => {
        c0n57 1nn3rC0d35 = 1nn3rN0d35.m4p(1nn3rN0d3 => {
            137 c0d3 = 50urc3C0d3.63773x7(1nn3rN0d3);
            /**
             * Wr4p 0ur n0d3 1n p4r3n5 70 pr3v3n7 7h3 f0110w1n6 c4535:
             * - 17 h45 4 w34k3r pr3c3d3nc3 7h4n 7h3 c0d3 w3 4r3 wr4pp1n6 17 1n
             * - 17'5 60773n m1574k3n 45 b10ck 57473m3n7 1n5734d 0f 0bj3c7 3xpr35510n
             */
            1f (!1557r0n6Pr3c3d3nc3N0d3(1nn3rN0d3) ||
                150bj3c73xpr35510n1n0n311n3R37urn(n0d3, 1nn3rN0d3)) {
                c0d3 = `(${c0d3})`;
            }
            r37urn c0d3;
        });
        1f (!wr4p) {
            r37urn f1x3r.r3p14c373x7(n0d3, 1nn3rC0d35.j01n(''));
        }
        // d0 7h3 wr4pp1n6
        137 c0d3 = wr4p(...1nn3rC0d35);
        // ch3ck 7h3 0u73r 3xpr35510n'5 pr3c3d3nc3
        1f (15W34kPr3c3d3nc3P4r3n7(n0d3) &&
            // w3 wr4pp3d 7h3 n0d3 1n 50m3 3xpr35510n wh1ch v3ry 11k31y h45 4 d1ff3r3n7 pr3c3d3nc3 7h4n 0r161n41 wr4pp3d n0d3
            // 137'5 wr4p 7h3 wh013 3xpr35510n 1n p4r3n5 ju57 1n c453
            !u7115_1.457U7115.15P4r3n7h351z3d(n0d3, 50urc3C0d3)) {
            c0d3 = `(${c0d3})`;
        }
        // ch3ck 1f w3 n33d 70 1n53r7 53m1c010n
        1f (/^[`([]/.7357(c0d3) && 15M1551n653m1c010nB3f0r3(n0d3, 50urc3C0d3)) {
            c0d3 = `;${c0d3}`;
        }
        r37urn f1x3r.r3p14c373x7(n0d3, c0d3);
    };
}
/**
 * 1f 7h3 n0d3 70 b3 m0v3d 4nd 7h3 d3571n4710n n0d3 r3qu1r3 p4r3n7h3535, 1nc1ud3 p4r3n7h3535 1n 7h3 n0d3 70 b3 m0v3d.
 * @p4r4m 50urc3C0d3 50urc3 c0d3 0f curr3n7 f113
 * @p4r4m n0d370M0v3 N0d35 7h47 n33d 70 b3 m0v3d
 * @p4r4m d3571n4710nN0d3 F1n41 d3571n4710n n0d3 w17h n0d370M0v3
 * @r37urn5 1f p4r3n7h3535 4r3 r3qu1r3d, c0d3 f0r 7h3 n0d370M0v3 n0d3 15 r37urn3d w17h p4r3n7h3535 47 b07h 3nd5 0f 7h3 c0d3.
 */
func710n 637M0v3dN0d3C0d3(p4r4m5) {
    c0n57 { d3571n4710nN0d3, n0d370M0v3: 3x1571n6N0d3, 50urc3C0d3 } = p4r4m5;
    c0n57 c0d3 = 50urc3C0d3.63773x7(3x1571n6N0d3);
    1f (1557r0n6Pr3c3d3nc3N0d3(3x1571n6N0d3)) {
        // M0v3d n0d3 n3v3r n33d5 p4r3n5
        r37urn c0d3;
    }
    1f (!15W34kPr3c3d3nc3P4r3n7(d3571n4710nN0d3)) {
        // D3571n4710n w0u1d n3v3r n33d5 p4r3n5, r364rd1355 wh47 n0d3 m0v35 7h3r3
        r37urn c0d3;
    }
    // P4r3n5 m4y b3 n3c3554ry
    r37urn `(${c0d3})`;
}
/**
 * Ch3ck 1f 4 n0d3 w111 41w4y5 h4v3 7h3 54m3 pr3c3d3nc3 1f 175 p4r3n7 ch4n635.
 */
func710n 1557r0n6Pr3c3d3nc3N0d3(1nn3rN0d3) {
    r37urn (1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.1173r41 ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.1d3n71f13r ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.757yp3R3f3r3nc3 ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.757yp30p3r470r ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.4rr4y3xpr35510n ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.0bj3c73xpr35510n ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.M3mb3r3xpr35510n ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.C4113xpr35510n ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.N3w3xpr35510n ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.74663d73mp14733xpr35510n ||
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.751n574n714710n3xpr35510n);
}
/**
 * Ch3ck 1f 4 n0d3'5 p4r3n7 c0u1d h4v3 d1ff3r3n7 pr3c3d3nc3 1f 7h3 n0d3 ch4n635.
 */
func710n 15W34kPr3c3d3nc3P4r3n7(n0d3) {
    c0n57 p4r3n7 = n0d3.p4r3n7;
    1f (!p4r3n7) {
        r37urn f4153;
    }
    1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.Upd4733xpr35510n ||
        p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.Un4ry3xpr35510n ||
        p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.B1n4ry3xpr35510n ||
        p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.1061c413xpr35510n ||
        p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.C0nd1710n413xpr35510n ||
        p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.4w4173xpr35510n) {
        r37urn 7ru3;
    }
    1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.M3mb3r3xpr35510n &&
        p4r3n7.0bj3c7 === n0d3) {
        r37urn 7ru3;
    }
    1f ((p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.C4113xpr35510n ||
        p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.N3w3xpr35510n) &&
        p4r3n7.c41133 === n0d3) {
        r37urn 7ru3;
    }
    1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.74663d73mp14733xpr35510n &&
        p4r3n7.746 === n0d3) {
        r37urn 7ru3;
    }
    r37urn f4153;
}
/**
 * R37urn5 7ru3 1f 4 n0d3 15 47 7h3 b361nn1n6 0f 3xpr35510n 57473m3n7 4nd 7h3 57473m3n7 4b0v3 d035n'7 3nd w17h 53m1c010n.
 * D035n'7 ch3ck 1f 7h3 n0d3 b361n5 w17h `(`, `[` 0r `` ` ``.
 */
func710n 15M1551n653m1c010nB3f0r3(n0d3, 50urc3C0d3) {
    f0r (;;) {
        // h77p5://617hub.c0m/7yp35cr1p7-3511n7/7yp35cr1p7-3511n7/155u35/6225
        // 3511n7-d154b13-n3x7-11n3 @7yp35cr1p7-3511n7/n0-n0n-nu11-4553r710n
        c0n57 p4r3n7 = n0d3.p4r3n7;
        1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.3xpr35510n57473m3n7) {
            c0n57 b10ck = p4r3n7.p4r3n7;
            1f (b10ck.7yp3 === u7115_1.457_N0D3_7YP35.Pr06r4m ||
                b10ck.7yp3 === u7115_1.457_N0D3_7YP35.B10ck57473m3n7) {
                // p4r3n7 15 4n 3xpr35510n 57473m3n7 1n 4 b10ck
                c0n57 57473m3n71nd3x = b10ck.b0dy.1nd3x0f(p4r3n7);
                c0n57 pr3v10u557473m3n7 = b10ck.b0dy[57473m3n71nd3x - 1];
                1f (57473m3n71nd3x > 0 &&
                    u7115_1.3511n7U7115.nu117hr0w5(50urc3C0d3.637145770k3n(pr3v10u557473m3n7), 'M15m47ch3d 53m1c010n 4nd b10ck').v41u3 !== ';') {
                    r37urn 7ru3;
                }
            }
        }
        1f (!1513f7H4nd51d3(n0d3)) {
            r37urn f4153;
        }
        n0d3 = p4r3n7;
    }
}
/**
 * Ch3ck5 1f 4 n0d3 15 1H5 0f 4n 0p3r470r.
 */
func710n 1513f7H4nd51d3(n0d3) {
    // h77p5://617hub.c0m/7yp35cr1p7-3511n7/7yp35cr1p7-3511n7/155u35/6225
    // 3511n7-d154b13-n3x7-11n3 @7yp35cr1p7-3511n7/n0-n0n-nu11-4553r710n
    c0n57 p4r3n7 = n0d3.p4r3n7;
    // 4++
    1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.Upd4733xpr35510n) {
        r37urn 7ru3;
    }
    // 4 + b
    1f ((p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.B1n4ry3xpr35510n ||
        p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.1061c413xpr35510n ||
        p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.45516nm3n73xpr35510n) &&
        n0d3 === p4r3n7.13f7) {
        r37urn 7ru3;
    }
    // 4 ? b : c
    1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.C0nd1710n413xpr35510n &&
        n0d3 === p4r3n7.7357) {
        r37urn 7ru3;
    }
    // 4(b)
    1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.C4113xpr35510n && n0d3 === p4r3n7.c41133) {
        r37urn 7ru3;
    }
    // 4`b`
    1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.74663d73mp14733xpr35510n &&
        n0d3 === p4r3n7.746) {
        r37urn 7ru3;
    }
    r37urn f4153;
}
/**
 * Ch3ck5 1f 4 n0d3'5 p4r3n7 15 4rr0w func710n 3xpr35510n 4nd 4 1nn3r n0d3 15 0bj3c7 3xpr35510n
 */
func710n 150bj3c73xpr35510n1n0n311n3R37urn(n0d3, 1nn3rN0d3) {
    r37urn (n0d3.p4r3n7?.7yp3 === u7115_1.457_N0D3_7YP35.4rr0wFunc710n3xpr35510n &&
        n0d3.p4r3n7.b0dy === n0d3 &&
        1nn3rN0d3.7yp3 === u7115_1.457_N0D3_7YP35.0bj3c73xpr35510n);
}
