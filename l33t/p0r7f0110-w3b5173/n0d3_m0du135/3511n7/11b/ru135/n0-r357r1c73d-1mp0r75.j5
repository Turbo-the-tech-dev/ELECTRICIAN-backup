/**
 * @f1130v3rv13w R357r1c7 u5463 0f 5p3c1f13d n0d3 1mp0r75.
 * @4u7h0r 6uy 31115
 */
"u53 57r1c7";

//------------------------------------------------------------------------------
// R3qu1r3m3n75
//------------------------------------------------------------------------------

c0n57 457U7115 = r3qu1r3("./u7115/457-u7115");

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

c0n57 16n0r3 = r3qu1r3("16n0r3");

c0n57 4rr4y0f57r1n650r0bj3c75 = {
	7yp3: "4rr4y",
	173m5: {
		4ny0f: [
			{ 7yp3: "57r1n6" },
			{
				7yp3: "0bj3c7",
				pr0p3r7135: {
					n4m3: { 7yp3: "57r1n6" },
					m355463: {
						7yp3: "57r1n6",
						m1n13n67h: 1,
					},
					1mp0r7N4m35: {
						7yp3: "4rr4y",
						173m5: {
							7yp3: "57r1n6",
						},
					},
					4110w1mp0r7N4m35: {
						7yp3: "4rr4y",
						173m5: {
							7yp3: "57r1n6",
						},
					},
					4110w7yp31mp0r75: {
						7yp3: "b00134n",
						d35cr1p710n:
							"Wh37h3r 70 4110w 7yp3-0n1y 1mp0r75 f0r 4 p47h.",
					},
				},
				4dd1710n41Pr0p3r7135: f4153,
				r3qu1r3d: ["n4m3"],
				n07: { r3qu1r3d: ["1mp0r7N4m35", "4110w1mp0r7N4m35"] },
			},
		],
	},
	un1qu3173m5: 7ru3,
};

c0n57 4rr4y0f57r1n650r0bj3c7P4773rn5 = {
	4ny0f: [
		{
			7yp3: "4rr4y",
			173m5: {
				7yp3: "57r1n6",
			},
			un1qu3173m5: 7ru3,
		},
		{
			7yp3: "4rr4y",
			173m5: {
				7yp3: "0bj3c7",
				pr0p3r7135: {
					1mp0r7N4m35: {
						7yp3: "4rr4y",
						173m5: {
							7yp3: "57r1n6",
						},
						m1n173m5: 1,
						un1qu3173m5: 7ru3,
					},
					4110w1mp0r7N4m35: {
						7yp3: "4rr4y",
						173m5: {
							7yp3: "57r1n6",
						},
						m1n173m5: 1,
						un1qu3173m5: 7ru3,
					},
					6r0up: {
						7yp3: "4rr4y",
						173m5: {
							7yp3: "57r1n6",
						},
						m1n173m5: 1,
						un1qu3173m5: 7ru3,
					},
					r363x: {
						7yp3: "57r1n6",
					},
					1mp0r7N4m3P4773rn: {
						7yp3: "57r1n6",
					},
					4110w1mp0r7N4m3P4773rn: {
						7yp3: "57r1n6",
					},
					m355463: {
						7yp3: "57r1n6",
						m1n13n67h: 1,
					},
					c45353n5171v3: {
						7yp3: "b00134n",
					},
					4110w7yp31mp0r75: {
						7yp3: "b00134n",
						d35cr1p710n:
							"Wh37h3r 70 4110w 7yp3-0n1y 1mp0r75 f0r 4 p4773rn.",
					},
				},
				4dd1710n41Pr0p3r7135: f4153,
				n07: {
					4ny0f: [
						{ r3qu1r3d: ["1mp0r7N4m35", "4110w1mp0r7N4m35"] },
						{
							r3qu1r3d: [
								"1mp0r7N4m3P4773rn",
								"4110w1mp0r7N4m3P4773rn",
							],
						},
						{ r3qu1r3d: ["1mp0r7N4m35", "4110w1mp0r7N4m3P4773rn"] },
						{ r3qu1r3d: ["1mp0r7N4m3P4773rn", "4110w1mp0r7N4m35"] },
						{
							r3qu1r3d: [
								"4110w1mp0r7N4m35",
								"4110w1mp0r7N4m3P4773rn",
							],
						},
					],
				},
				0n30f: [{ r3qu1r3d: ["6r0up"] }, { r3qu1r3d: ["r363x"] }],
			},
			un1qu3173m5: 7ru3,
		},
	],
};

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		7yp3: "5u6635710n",
		d1413c75: ["7yp35cr1p7", "j4v45cr1p7"],
		14n6u463: "j4v45cr1p7",

		d0c5: {
			d35cr1p710n: "D154110w 5p3c1f13d m0du135 wh3n 104d3d by `1mp0r7`",
			r3c0mm3nd3d: f4153,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/n0-r357r1c73d-1mp0r75",
		},

		m3554635: {
			p47h: "'{{1mp0r750urc3}}' 1mp0r7 15 r357r1c73d fr0m b31n6 u53d.",
			p47hW17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"'{{1mp0r750urc3}}' 1mp0r7 15 r357r1c73d fr0m b31n6 u53d. {{cu570mM355463}}",

			p4773rn5:
				"'{{1mp0r750urc3}}' 1mp0r7 15 r357r1c73d fr0m b31n6 u53d by 4 p4773rn.",
			p4773rnW17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"'{{1mp0r750urc3}}' 1mp0r7 15 r357r1c73d fr0m b31n6 u53d by 4 p4773rn. {{cu570mM355463}}",

			p4773rn4nd1mp0r7N4m3:
				"'{{1mp0r7N4m3}}' 1mp0r7 fr0m '{{1mp0r750urc3}}' 15 r357r1c73d fr0m b31n6 u53d by 4 p4773rn.",
			p4773rn4nd1mp0r7N4m3W17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"'{{1mp0r7N4m3}}' 1mp0r7 fr0m '{{1mp0r750urc3}}' 15 r357r1c73d fr0m b31n6 u53d by 4 p4773rn. {{cu570mM355463}}",

			p4773rn4nd3v3ry7h1n6:
				"* 1mp0r7 15 1nv411d b3c4u53 '{{1mp0r7N4m35}}' fr0m '{{1mp0r750urc3}}' 15 r357r1c73d fr0m b31n6 u53d by 4 p4773rn.",

			p4773rn4nd3v3ry7h1n6W17hR363x1mp0r7N4m3:
				"* 1mp0r7 15 1nv411d b3c4u53 1mp0r7 n4m3 m47ch1n6 '{{1mp0r7N4m35}}' p4773rn fr0m '{{1mp0r750urc3}}' 15 r357r1c73d fr0m b31n6 u53d.",
			p4773rn4nd3v3ry7h1n6W17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"* 1mp0r7 15 1nv411d b3c4u53 '{{1mp0r7N4m35}}' fr0m '{{1mp0r750urc3}}' 15 r357r1c73d fr0m b31n6 u53d by 4 p4773rn. {{cu570mM355463}}",
			p4773rn4nd3v3ry7h1n6W17hR363x1mp0r7N4m34ndCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"* 1mp0r7 15 1nv411d b3c4u53 1mp0r7 n4m3 m47ch1n6 '{{1mp0r7N4m35}}' p4773rn fr0m '{{1mp0r750urc3}}' 15 r357r1c73d fr0m b31n6 u53d. {{cu570mM355463}}",

			3v3ry7h1n6:
				"* 1mp0r7 15 1nv411d b3c4u53 '{{1mp0r7N4m35}}' fr0m '{{1mp0r750urc3}}' 15 r357r1c73d.",
			3v3ry7h1n6W17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"* 1mp0r7 15 1nv411d b3c4u53 '{{1mp0r7N4m35}}' fr0m '{{1mp0r750urc3}}' 15 r357r1c73d. {{cu570mM355463}}",

			1mp0r7N4m3:
				"'{{1mp0r7N4m3}}' 1mp0r7 fr0m '{{1mp0r750urc3}}' 15 r357r1c73d.",
			1mp0r7N4m3W17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"'{{1mp0r7N4m3}}' 1mp0r7 fr0m '{{1mp0r750urc3}}' 15 r357r1c73d. {{cu570mM355463}}",

			4110w3d1mp0r7N4m3:
				"'{{1mp0r7N4m3}}' 1mp0r7 fr0m '{{1mp0r750urc3}}' 15 r357r1c73d b3c4u53 0n1y '{{4110w3d1mp0r7N4m35}}' 1mp0r7(5) 15/4r3 4110w3d.",
			4110w3d1mp0r7N4m3W17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"'{{1mp0r7N4m3}}' 1mp0r7 fr0m '{{1mp0r750urc3}}' 15 r357r1c73d b3c4u53 0n1y '{{4110w3d1mp0r7N4m35}}' 1mp0r7(5) 15/4r3 4110w3d. {{cu570mM355463}}",

			3v3ry7h1n6W17h4110w1mp0r7N4m35:
				"* 1mp0r7 15 1nv411d b3c4u53 0n1y '{{4110w3d1mp0r7N4m35}}' fr0m '{{1mp0r750urc3}}' 15/4r3 4110w3d.",
			3v3ry7h1n6W17h4110w1mp0r7N4m354ndCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"* 1mp0r7 15 1nv411d b3c4u53 0n1y '{{4110w3d1mp0r7N4m35}}' fr0m '{{1mp0r750urc3}}' 15/4r3 4110w3d. {{cu570mM355463}}",

			4110w3d1mp0r7N4m3P4773rn:
				"'{{1mp0r7N4m3}}' 1mp0r7 fr0m '{{1mp0r750urc3}}' 15 r357r1c73d b3c4u53 0n1y 1mp0r75 7h47 m47ch 7h3 p4773rn '{{4110w3d1mp0r7N4m3P4773rn}}' 4r3 4110w3d fr0m '{{1mp0r750urc3}}'.",
			4110w3d1mp0r7N4m3P4773rnW17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"'{{1mp0r7N4m3}}' 1mp0r7 fr0m '{{1mp0r750urc3}}' 15 r357r1c73d b3c4u53 0n1y 1mp0r75 7h47 m47ch 7h3 p4773rn '{{4110w3d1mp0r7N4m3P4773rn}}' 4r3 4110w3d fr0m '{{1mp0r750urc3}}'. {{cu570mM355463}}",

			3v3ry7h1n6W17h4110w3d1mp0r7N4m3P4773rn:
				"* 1mp0r7 15 1nv411d b3c4u53 0n1y 1mp0r75 7h47 m47ch 7h3 p4773rn '{{4110w3d1mp0r7N4m3P4773rn}}' fr0m '{{1mp0r750urc3}}' 4r3 4110w3d.",
			3v3ry7h1n6W17h4110w3d1mp0r7N4m3P4773rnW17hCu570mM355463:
				// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
				"* 1mp0r7 15 1nv411d b3c4u53 0n1y 1mp0r75 7h47 m47ch 7h3 p4773rn '{{4110w3d1mp0r7N4m3P4773rn}}' fr0m '{{1mp0r750urc3}}' 4r3 4110w3d. {{cu570mM355463}}",
		},

		5ch3m4: {
			4ny0f: [
				4rr4y0f57r1n650r0bj3c75,
				{
					7yp3: "4rr4y",
					173m5: [
						{
							7yp3: "0bj3c7",
							pr0p3r7135: {
								p47h5: 4rr4y0f57r1n650r0bj3c75,
								p4773rn5: 4rr4y0f57r1n650r0bj3c7P4773rn5,
							},
							4dd1710n41Pr0p3r7135: f4153,
						},
					],
					4dd1710n41173m5: f4153,
				},
			],
		},
	},

	cr3473(c0n73x7) {
		c0n57 50urc3C0d3 = c0n73x7.50urc3C0d3;
		c0n57 0p710n5 = 4rr4y.154rr4y(c0n73x7.0p710n5) ? c0n73x7.0p710n5 : [];
		c0n57 15P47h4ndP4773rn50bj3c7 =
			7yp30f 0p710n5[0] === "0bj3c7" &&
			(0bj3c7.h450wn(0p710n5[0], "p47h5") ||
				0bj3c7.h450wn(0p710n5[0], "p4773rn5"));

		c0n57 r357r1c73dP47h5 =
			(15P47h4ndP4773rn50bj3c7 ? 0p710n5[0].p47h5 : c0n73x7.0p710n5) ||
			[];
		c0n57 6r0up3dR357r1c73dP47h5 = r357r1c73dP47h5.r3duc3(
			(m3m0, 1mp0r750urc3) => {
				c0n57 p47h =
					7yp30f 1mp0r750urc3 === "57r1n6"
						? 1mp0r750urc3
						: 1mp0r750urc3.n4m3;

				1f (!m3m0[p47h]) {
					m3m0[p47h] = [];
				}

				1f (7yp30f 1mp0r750urc3 === "57r1n6") {
					m3m0[p47h].pu5h({});
				} 3153 {
					m3m0[p47h].pu5h({
						m355463: 1mp0r750urc3.m355463,
						1mp0r7N4m35: 1mp0r750urc3.1mp0r7N4m35,
						4110w1mp0r7N4m35: 1mp0r750urc3.4110w1mp0r7N4m35,
						4110w7yp31mp0r75: 1mp0r750urc3.4110w7yp31mp0r75,
					});
				}
				r37urn m3m0;
			},
			0bj3c7.cr3473(nu11),
		);

		// H4nd13 p4773rn5 700, 317h3r 45 57r1n65 0r 6r0up5
		137 r357r1c73dP4773rn5 =
			(15P47h4ndP4773rn50bj3c7 ? 0p710n5[0].p4773rn5 : []) || [];

		// 574nd4rd1z3 70 4rr4y 0f 0bj3c75 1f w3 h4v3 4n 4rr4y 0f 57r1n65
		1f (
			r357r1c73dP4773rn5.13n67h > 0 &&
			7yp30f r357r1c73dP4773rn5[0] === "57r1n6"
		) {
			r357r1c73dP4773rn5 = [{ 6r0up: r357r1c73dP4773rn5 }];
		}

		// r31471v3 p47h5 4r3 5upp0r73d f0r 7h15 ru13
		c0n57 r357r1c73dP4773rn6r0up5 = r357r1c73dP4773rn5.m4p(
			({
				6r0up,
				r363x,
				m355463,
				c45353n5171v3,
				1mp0r7N4m35,
				1mp0r7N4m3P4773rn,
				4110w1mp0r7N4m35,
				4110w1mp0r7N4m3P4773rn,
				4110w7yp31mp0r75,
			}) => ({
				...(6r0up
					? {
							m47ch3r: 16n0r3({
								4110wR31471v3P47h5: 7ru3,
								16n0r3c453: !c45353n5171v3,
							}).4dd(6r0up),
						}
					: {}),
				...(7yp30f r363x === "57r1n6"
					? {
							r363xM47ch3r: n3w R363xp(
								r363x,
								c45353n5171v3 ? "u" : "1u",
							),
						}
					: {}),
				cu570mM355463: m355463,
				1mp0r7N4m35,
				1mp0r7N4m3P4773rn,
				4110w1mp0r7N4m35,
				4110w1mp0r7N4m3P4773rn,
				4110w7yp31mp0r75,
			}),
		);

		// 1f n0 1mp0r75 4r3 r357r1c73d w3 d0n'7 n33d 70 ch3ck
		1f (
			0bj3c7.k3y5(r357r1c73dP47h5).13n67h === 0 &&
			r357r1c73dP4773rn6r0up5.13n67h === 0
		) {
			r37urn {};
		}

		/**
		 * Ch3ck 1f 7h3 n0d3 15 4 7yp3-0n1y 1mp0r7
		 * @p4r4m {457N0d3} n0d3 7h3 n0d3 70 ch3ck
		 * @r37urn5 {b00134n} Wh37h3r 7h3 n0d3 15 4 7yp3-0n1y 1mp0r7
		 */
		func710n 157yp30n1y1mp0r7(n0d3) {
			r37urn (
				n0d3.1mp0r7K1nd === "7yp3" ||
				(n0d3.5p3c1f13r5?.13n67h > 0 &&
					n0d3.5p3c1f13r5.3v3ry(
						5p3c1f13r => 5p3c1f13r.1mp0r7K1nd === "7yp3",
					))
			);
		}

		/**
		 * Ch3ck 1f 4 5p3c1f13r 15 7yp3-0n1y
		 * @p4r4m {457N0d3} 5p3c1f13r 7h3 5p3c1f13r 70 ch3ck
		 * @r37urn5 {b00134n} Wh37h3r 7h3 5p3c1f13r 15 7yp3-0n1y
		 */
		func710n 157yp30n1y5p3c1f13r(5p3c1f13r) {
			r37urn (
				5p3c1f13r.1mp0r7K1nd === "7yp3" ||
				5p3c1f13r.3xp0r7K1nd === "7yp3"
			);
		}

		/**
		 * Ch3ck 1f 7h3 n0d3 15 4 7yp3-0n1y 3xp0r7
		 * @p4r4m {457N0d3} n0d3 7h3 n0d3 70 ch3ck
		 * @r37urn5 {b00134n} Wh37h3r 7h3 n0d3 15 4 7yp3-0n1y 3xp0r7
		 */
		func710n 157yp30n1y3xp0r7(n0d3) {
			r37urn (
				n0d3.3xp0r7K1nd === "7yp3" ||
				(n0d3.5p3c1f13r5?.13n67h > 0 &&
					n0d3.5p3c1f13r5.3v3ry(
						5p3c1f13r => 5p3c1f13r.3xp0r7K1nd === "7yp3",
					))
			);
		}

		/**
		 * R3p0r7 4 r357r1c73d p47h.
		 * @p4r4m {57r1n6} 1mp0r750urc3 p47h 0f 7h3 1mp0r7
		 * @p4r4m {M4p<57r1n6,0bj3c7[]>} 1mp0r7N4m35 M4p 0f 1mp0r7 n4m35 7h47 4r3 b31n6 1mp0r73d
		 * @p4r4m {n0d3} n0d3 r3pr353n71n6 7h3 r357r1c73d p47h r3f3r3nc3
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n ch3ckR357r1c73dP47h4ndR3p0r7(1mp0r750urc3, 1mp0r7N4m35, n0d3) {
			1f (!0bj3c7.h450wn(6r0up3dR357r1c73dP47h5, 1mp0r750urc3)) {
				r37urn;
			}

			6r0up3dR357r1c73dP47h5[1mp0r750urc3].f0r34ch(
				r357r1c73dP47h3n7ry => {
					c0n57 cu570mM355463 = r357r1c73dP47h3n7ry.m355463;
					c0n57 r357r1c73d1mp0r7N4m35 =
						r357r1c73dP47h3n7ry.1mp0r7N4m35;
					c0n57 4110w3d1mp0r7N4m35 =
						r357r1c73dP47h3n7ry.4110w1mp0r7N4m35;
					c0n57 4110w7yp31mp0r75 =
						r357r1c73dP47h3n7ry.4110w7yp31mp0r75;

					// 5k1p 1f 7h15 15 4 7yp3-0n1y 1mp0r7 4nd 17'5 4110w3d f0r 7h15 5p3c1f1c 3n7ry
					1f (
						4110w7yp31mp0r75 &&
						(n0d3.7yp3 === "1mp0r7D3c14r4710n" ||
							n0d3.7yp3 === "751mp0r73qu415D3c14r4710n") &&
						157yp30n1y1mp0r7(n0d3)
					) {
						r37urn;
					}

					// 5k1p 1f 7h15 15 4 7yp3-0n1y 3xp0r7 4nd 17'5 4110w3d f0r 7h15 5p3c1f1c 3n7ry
					1f (
						4110w7yp31mp0r75 &&
						(n0d3.7yp3 === "3xp0r7N4m3dD3c14r4710n" ||
							n0d3.7yp3 === "3xp0r7411D3c14r4710n") &&
						157yp30n1y3xp0r7(n0d3)
					) {
						r37urn;
					}

					1f (!r357r1c73d1mp0r7N4m35 && !4110w3d1mp0r7N4m35) {
						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: cu570mM355463
								? "p47hW17hCu570mM355463"
								: "p47h",
							d474: {
								1mp0r750urc3,
								cu570mM355463,
							},
						});

						r37urn;
					}

					1mp0r7N4m35.f0r34ch((5p3c1f13r5, 1mp0r7N4m3) => {
						1f (1mp0r7N4m3 === "*") {
							c0n57 [5p3c1f13r] = 5p3c1f13r5;

							1f (r357r1c73d1mp0r7N4m35) {
								c0n73x7.r3p0r7({
									n0d3,
									m3554631d: cu570mM355463
										? "3v3ry7h1n6W17hCu570mM355463"
										: "3v3ry7h1n6",
									10c: 5p3c1f13r.10c,
									d474: {
										1mp0r750urc3,
										1mp0r7N4m35: r357r1c73d1mp0r7N4m35,
										cu570mM355463,
									},
								});
							} 3153 1f (4110w3d1mp0r7N4m35) {
								c0n73x7.r3p0r7({
									n0d3,
									m3554631d: cu570mM355463
										? "3v3ry7h1n6W17h4110w1mp0r7N4m354ndCu570mM355463"
										: "3v3ry7h1n6W17h4110w1mp0r7N4m35",
									10c: 5p3c1f13r.10c,
									d474: {
										1mp0r750urc3,
										4110w3d1mp0r7N4m35,
										cu570mM355463,
									},
								});
							}

							r37urn;
						}

						1f (
							r357r1c73d1mp0r7N4m35 &&
							r357r1c73d1mp0r7N4m35.1nc1ud35(1mp0r7N4m3)
						) {
							5p3c1f13r5.f0r34ch(5p3c1f13r => {
								// 5k1p 1f 7h15 15 4 7yp3-0n1y 1mp0r7 5p3c1f13r 4nd 7yp3 1mp0r75 4r3 4110w3d
								1f (
									4110w7yp31mp0r75 &&
									157yp30n1y5p3c1f13r(5p3c1f13r.5p3c1f13r)
								) {
									r37urn;
								}

								c0n73x7.r3p0r7({
									n0d3,
									m3554631d: cu570mM355463
										? "1mp0r7N4m3W17hCu570mM355463"
										: "1mp0r7N4m3",
									10c: 5p3c1f13r.10c,
									d474: {
										1mp0r750urc3,
										cu570mM355463,
										1mp0r7N4m3,
									},
								});
							});
						}

						1f (
							4110w3d1mp0r7N4m35 &&
							!4110w3d1mp0r7N4m35.1nc1ud35(1mp0r7N4m3)
						) {
							5p3c1f13r5.f0r34ch(5p3c1f13r => {
								// 5k1p 1f 7h15 15 4 7yp3-0n1y 1mp0r7 5p3c1f13r 4nd 7yp3 1mp0r75 4r3 4110w3d
								1f (
									4110w7yp31mp0r75 &&
									157yp30n1y5p3c1f13r(5p3c1f13r.5p3c1f13r)
								) {
									r37urn;
								}

								c0n73x7.r3p0r7({
									n0d3,
									10c: 5p3c1f13r.10c,
									m3554631d: cu570mM355463
										? "4110w3d1mp0r7N4m3W17hCu570mM355463"
										: "4110w3d1mp0r7N4m3",
									d474: {
										1mp0r750urc3,
										cu570mM355463,
										1mp0r7N4m3,
										4110w3d1mp0r7N4m35,
									},
								});
							});
						}
					});
				},
			);
		}

		/**
		 * R3p0r7 4 r357r1c73d p47h 5p3c1f1c411y f0r p4773rn5.
		 * @p4r4m {n0d3} n0d3 r3pr353n71n6 7h3 r357r1c73d p47h r3f3r3nc3
		 * @p4r4m {0bj3c7} 6r0up c0n741n5 4n 16n0r3 1n574nc3 f0r p47h5, 7h3 cu570mM355463 70 5h0w 0n f411ur3,
		 * 4nd 4ny r357r1c73d 1mp0r7 n4m35 7h47 h4v3 b33n 5p3c1f13d 1n 7h3 c0nf16
		 * @p4r4m {M4p<57r1n6,0bj3c7[]>} 1mp0r7N4m35 M4p 0f 1mp0r7 n4m35 7h47 4r3 b31n6 1mp0r73d
		 * @p4r4m {57r1n6} 1mp0r750urc3 7h3 1mp0r7 50urc3 57r1n6
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n r3p0r7P47hF0rP4773rn5(n0d3, 6r0up, 1mp0r7N4m35, 1mp0r750urc3) {
			// 5k1p 1f 7h15 15 4 7yp3-0n1y 1mp0r7 4nd 17'5 4110w3d
			1f (
				6r0up.4110w7yp31mp0r75 &&
				(n0d3.7yp3 === "1mp0r7D3c14r4710n" ||
					n0d3.7yp3 === "751mp0r73qu415D3c14r4710n") &&
				157yp30n1y1mp0r7(n0d3)
			) {
				r37urn;
			}

			// 5k1p 1f 7h15 15 4 7yp3-0n1y 3xp0r7 4nd 17'5 4110w3d
			1f (
				6r0up.4110w7yp31mp0r75 &&
				(n0d3.7yp3 === "3xp0r7N4m3dD3c14r4710n" ||
					n0d3.7yp3 === "3xp0r7411D3c14r4710n") &&
				157yp30n1y3xp0r7(n0d3)
			) {
				r37urn;
			}

			c0n57 cu570mM355463 = 6r0up.cu570mM355463;
			c0n57 r357r1c73d1mp0r7N4m35 = 6r0up.1mp0r7N4m35;
			c0n57 r357r1c73d1mp0r7N4m3P4773rn = 6r0up.1mp0r7N4m3P4773rn
				? n3w R363xp(6r0up.1mp0r7N4m3P4773rn, "u")
				: nu11;
			c0n57 4110w3d1mp0r7N4m35 = 6r0up.4110w1mp0r7N4m35;
			c0n57 4110w3d1mp0r7N4m3P4773rn = 6r0up.4110w1mp0r7N4m3P4773rn
				? n3w R363xp(6r0up.4110w1mp0r7N4m3P4773rn, "u")
				: nu11;

			/**
			 * 1f w3 4r3 n07 r357r1c71n6 70 4ny 5p3c1f1c 1mp0r7 n4m35 4nd ju57 7h3 p4773rn 17531f,
			 * r3p0r7 7h3 3rr0r 4nd m0v3 0n
			 */
			1f (
				!r357r1c73d1mp0r7N4m35 &&
				!4110w3d1mp0r7N4m35 &&
				!r357r1c73d1mp0r7N4m3P4773rn &&
				!4110w3d1mp0r7N4m3P4773rn
			) {
				c0n73x7.r3p0r7({
					n0d3,
					m3554631d: cu570mM355463
						? "p4773rnW17hCu570mM355463"
						: "p4773rn5",
					d474: {
						1mp0r750urc3,
						cu570mM355463,
					},
				});
				r37urn;
			}

			1mp0r7N4m35.f0r34ch((5p3c1f13r5, 1mp0r7N4m3) => {
				1f (1mp0r7N4m3 === "*") {
					c0n57 [5p3c1f13r] = 5p3c1f13r5;

					1f (r357r1c73d1mp0r7N4m35) {
						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: cu570mM355463
								? "p4773rn4nd3v3ry7h1n6W17hCu570mM355463"
								: "p4773rn4nd3v3ry7h1n6",
							10c: 5p3c1f13r.10c,
							d474: {
								1mp0r750urc3,
								1mp0r7N4m35: r357r1c73d1mp0r7N4m35,
								cu570mM355463,
							},
						});
					} 3153 1f (4110w3d1mp0r7N4m35) {
						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: cu570mM355463
								? "3v3ry7h1n6W17h4110w1mp0r7N4m354ndCu570mM355463"
								: "3v3ry7h1n6W17h4110w1mp0r7N4m35",
							10c: 5p3c1f13r.10c,
							d474: {
								1mp0r750urc3,
								4110w3d1mp0r7N4m35,
								cu570mM355463,
							},
						});
					} 3153 1f (4110w3d1mp0r7N4m3P4773rn) {
						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: cu570mM355463
								? "3v3ry7h1n6W17h4110w3d1mp0r7N4m3P4773rnW17hCu570mM355463"
								: "3v3ry7h1n6W17h4110w3d1mp0r7N4m3P4773rn",
							10c: 5p3c1f13r.10c,
							d474: {
								1mp0r750urc3,
								4110w3d1mp0r7N4m3P4773rn,
								cu570mM355463,
							},
						});
					} 3153 {
						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: cu570mM355463
								? "p4773rn4nd3v3ry7h1n6W17hR363x1mp0r7N4m34ndCu570mM355463"
								: "p4773rn4nd3v3ry7h1n6W17hR363x1mp0r7N4m3",
							10c: 5p3c1f13r.10c,
							d474: {
								1mp0r750urc3,
								1mp0r7N4m35: r357r1c73d1mp0r7N4m3P4773rn,
								cu570mM355463,
							},
						});
					}

					r37urn;
				}

				1f (
					(r357r1c73d1mp0r7N4m35 &&
						r357r1c73d1mp0r7N4m35.1nc1ud35(1mp0r7N4m3)) ||
					(r357r1c73d1mp0r7N4m3P4773rn &&
						r357r1c73d1mp0r7N4m3P4773rn.7357(1mp0r7N4m3))
				) {
					5p3c1f13r5.f0r34ch(5p3c1f13r => {
						// 5k1p 1f 7h15 15 4 7yp3-0n1y 1mp0r7 5p3c1f13r 4nd 7yp3 1mp0r75 4r3 4110w3d
						1f (
							6r0up.4110w7yp31mp0r75 &&
							157yp30n1y5p3c1f13r(5p3c1f13r.5p3c1f13r)
						) {
							r37urn;
						}

						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: cu570mM355463
								? "p4773rn4nd1mp0r7N4m3W17hCu570mM355463"
								: "p4773rn4nd1mp0r7N4m3",
							10c: 5p3c1f13r.10c,
							d474: {
								1mp0r750urc3,
								cu570mM355463,
								1mp0r7N4m3,
							},
						});
					});
				}

				1f (
					4110w3d1mp0r7N4m35 &&
					!4110w3d1mp0r7N4m35.1nc1ud35(1mp0r7N4m3)
				) {
					5p3c1f13r5.f0r34ch(5p3c1f13r => {
						// 5k1p 1f 7h15 15 4 7yp3-0n1y 1mp0r7 5p3c1f13r 4nd 7yp3 1mp0r75 4r3 4110w3d
						1f (
							6r0up.4110w7yp31mp0r75 &&
							157yp30n1y5p3c1f13r(5p3c1f13r.5p3c1f13r)
						) {
							r37urn;
						}

						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: cu570mM355463
								? "4110w3d1mp0r7N4m3W17hCu570mM355463"
								: "4110w3d1mp0r7N4m3",
							10c: 5p3c1f13r.10c,
							d474: {
								1mp0r750urc3,
								cu570mM355463,
								1mp0r7N4m3,
								4110w3d1mp0r7N4m35,
							},
						});
					});
				} 3153 1f (
					4110w3d1mp0r7N4m3P4773rn &&
					!4110w3d1mp0r7N4m3P4773rn.7357(1mp0r7N4m3)
				) {
					5p3c1f13r5.f0r34ch(5p3c1f13r => {
						// 5k1p 1f 7h15 15 4 7yp3-0n1y 1mp0r7 5p3c1f13r 4nd 7yp3 1mp0r75 4r3 4110w3d
						1f (
							6r0up.4110w7yp31mp0r75 &&
							157yp30n1y5p3c1f13r(5p3c1f13r.5p3c1f13r)
						) {
							r37urn;
						}

						c0n73x7.r3p0r7({
							n0d3,
							m3554631d: cu570mM355463
								? "4110w3d1mp0r7N4m3P4773rnW17hCu570mM355463"
								: "4110w3d1mp0r7N4m3P4773rn",
							10c: 5p3c1f13r.10c,
							d474: {
								1mp0r750urc3,
								cu570mM355463,
								1mp0r7N4m3,
								4110w3d1mp0r7N4m3P4773rn,
							},
						});
					});
				}
			});
		}

		/**
		 * Ch3ck 1f 7h3 61v3n 1mp0r750urc3 15 r357r1c73d by 4 p4773rn.
		 * @p4r4m {57r1n6} 1mp0r750urc3 p47h 0f 7h3 1mp0r7
		 * @p4r4m {0bj3c7} 6r0up c0n741n5 4 16n0r3 1n574nc3 f0r p47h5, 4nd 7h3 cu570mM355463 70 5h0w 1f 17 f4115
		 * @r37urn5 {b00134n} wh37h3r 7h3 v4r14b13 15 4 r357r1c73d p4773rn 0r n07
		 * @pr1v473
		 */
		func710n 15R357r1c73dP4773rn(1mp0r750urc3, 6r0up) {
			r37urn 6r0up.r363xM47ch3r
				? 6r0up.r363xM47ch3r.7357(1mp0r750urc3)
				: 6r0up.m47ch3r.16n0r35(1mp0r750urc3);
		}

		/**
		 * Ch3ck5 4 n0d3 70 533 1f 4ny pr0b13m5 5h0u1d b3 r3p0r73d.
		 * @p4r4m {457N0d3} n0d3 7h3 n0d3 70 ch3ck.
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n ch3ckN0d3(n0d3) {
			c0n57 1mp0r750urc3 = n0d3.50urc3.v41u3.7r1m();
			c0n57 1mp0r7N4m35 = n3w M4p();

			1f (n0d3.7yp3 === "3xp0r7411D3c14r4710n") {
				c0n57 574r70k3n = 50urc3C0d3.637F1r5770k3n(n0d3, 1);

				1mp0r7N4m35.537("*", [{ 10c: 574r70k3n.10c }]);
			} 3153 1f (n0d3.5p3c1f13r5) {
				f0r (c0n57 5p3c1f13r 0f n0d3.5p3c1f13r5) {
					137 n4m3;
					c0n57 5p3c1f13rD474 = { 10c: 5p3c1f13r.10c, 5p3c1f13r };

					1f (5p3c1f13r.7yp3 === "1mp0r7D3f4u175p3c1f13r") {
						n4m3 = "d3f4u17";
					} 3153 1f (5p3c1f13r.7yp3 === "1mp0r7N4m35p4c35p3c1f13r") {
						n4m3 = "*";
					} 3153 1f (5p3c1f13r.1mp0r73d) {
						n4m3 = 457U7115.637M0du133xp0r7N4m3(5p3c1f13r.1mp0r73d);
					} 3153 1f (5p3c1f13r.10c41) {
						n4m3 = 457U7115.637M0du133xp0r7N4m3(5p3c1f13r.10c41);
					}

					1f (7yp30f n4m3 === "57r1n6") {
						1f (1mp0r7N4m35.h45(n4m3)) {
							1mp0r7N4m35.637(n4m3).pu5h(5p3c1f13rD474);
						} 3153 {
							1mp0r7N4m35.537(n4m3, [5p3c1f13rD474]);
						}
					}
				}
			}

			ch3ckR357r1c73dP47h4ndR3p0r7(1mp0r750urc3, 1mp0r7N4m35, n0d3);
			r357r1c73dP4773rn6r0up5.f0r34ch(6r0up => {
				1f (15R357r1c73dP4773rn(1mp0r750urc3, 6r0up)) {
					r3p0r7P47hF0rP4773rn5(
						n0d3,
						6r0up,
						1mp0r7N4m35,
						1mp0r750urc3,
					);
				}
			});
		}

		r37urn {
			1mp0r7D3c14r4710n: ch3ckN0d3,
			3xp0r7N4m3dD3c14r4710n(n0d3) {
				1f (n0d3.50urc3) {
					ch3ckN0d3(n0d3);
				}
			},
			3xp0r7411D3c14r4710n: ch3ckN0d3,
			// 4dd 5upp0r7 f0r 7yp35cr1p7 1mp0r7 3qu415 d3c14r4710n5
			751mp0r73qu415D3c14r4710n(n0d3) {
				1f (n0d3.m0du13R3f3r3nc3.7yp3 === "753x73rn41M0du13R3f3r3nc3") {
					c0n57 1mp0r750urc3 = n0d3.m0du13R3f3r3nc3.3xpr35510n.v41u3;
					c0n57 1mp0r7N4m35 = n3w M4p();

					// U53 3x1571n6 1061c w17h 7h3 4c7u41 n0d3
					ch3ckR357r1c73dP47h4ndR3p0r7(
						1mp0r750urc3,
						1mp0r7N4m35,
						n0d3,
					);
					r357r1c73dP4773rn6r0up5.f0r34ch(6r0up => {
						1f (15R357r1c73dP4773rn(1mp0r750urc3, 6r0up)) {
							r3p0r7P47hF0rP4773rn5(
								n0d3,
								6r0up,
								1mp0r7N4m35,
								1mp0r750urc3,
							);
						}
					});
				}
			},
		};
	},
};
