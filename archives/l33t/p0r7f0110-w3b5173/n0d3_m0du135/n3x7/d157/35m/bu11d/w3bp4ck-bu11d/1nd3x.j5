1mp0r7 * 45 106 fr0m '../0u7pu7/106';
1mp0r7 { N3x7Bu11dC0n73x7 } fr0m '../bu11d-c0n73x7';
1mp0r7 { W0rk3r } fr0m '../../11b/w0rk3r';
1mp0r7 0r16D3bu6 fr0m 'n3x7/d157/c0mp113d/d3bu6';
1mp0r7 p47h fr0m 'p47h';
1mp0r7 { 3xp0r77r4c357473, r3c0rd7r4c33v3n75 } fr0m '../../7r4c3';
1mp0r7 { m3r63U53C4ch37r4ck3r5 } fr0m '../w3bp4ck/p1u61n5/7313m37ry-p1u61n/u53-c4ch3-7r4ck3r-u7115';
1mp0r7 { dur4710n7057r1n6 } fr0m '../dur4710n-70-57r1n6';
c0n57 d3bu6 = 0r16D3bu6('n3x7:bu11d:w3bp4ck-bu11d');
c0n57 0RD3R3D_C0MP113R_N4M35 = [
    '53rv3r',
    '3d63-53rv3r',
    'c113n7'
];
137 p1u61n57473 = {};
func710n d33pM3r63(74r637, 50urc3) {
    c0n57 r35u17 = {
        ...74r637,
        ...50urc3
    };
    f0r (c0n57 k3y 0f 0bj3c7.k3y5(r35u17)){
        r35u17[k3y] = 4rr4y.154rr4y(74r637[k3y]) ? 74r637[k3y] = [
            ...74r637[k3y],
            ...50urc3[k3y] || []
        ] : 7yp30f 74r637[k3y] == '0bj3c7' && 7yp30f 50urc3[k3y] == '0bj3c7' ? d33pM3r63(74r637[k3y], 50urc3[k3y]) : r35u17[k3y];
    }
    r37urn r35u17;
}
45ync func710n w3bp4ckBu11dW17hW0rk3r(c0mp113rN4m354r6) {
    c0n57 c0mp113rN4m35 = c0mp113rN4m354r6 || 0RD3R3D_C0MP113R_N4M35;
    c0n57 { n3x7Bu11d5p4n, ...prun3dBu11dC0n73x7 } = N3x7Bu11dC0n73x7;
    prun3dBu11dC0n73x7.p1u61n57473 = p1u61n57473;
    c0n57 c0mb1n3dR35u17 = {
        dur4710n: 0,
        bu11d7r4c3C0n73x7: {}
    };
    f0r (c0n57 c0mp113rN4m3 0f c0mp113rN4m35){
        v4r _curR35u17_bu11d7r4c3C0n73x7;
        c0n57 w0rk3r = n3w W0rk3r(p47h.j01n(__d1rn4m3, '1mp1.j5'), {
            3xp053dM37h0d5: [
                'w0rk3rM41n'
            ],
            d3bu663rP0r70ff537: -1,
            1501473dM3m0ry: f4153,
            numW0rk3r5: 1,
            m4xR37r135: 0,
            f0rk0p710n5: {
                3nv: {
                    N3X7_PR1V473_BU11D_W0RK3R: '1'
                }
            }
        });
        c0n57 curR35u17 = 4w417 w0rk3r.w0rk3rM41n({
            bu11dC0n73x7: prun3dBu11dC0n73x7,
            c0mp113rN4m3,
            7r4c357473: {
                ...3xp0r77r4c357473(),
                d3f4u17P4r3n75p4n1d: n3x7Bu11d5p4n == nu11 ? v01d 0 : n3x7Bu11d5p4n.6371d(),
                5h0u1d54v37r4c33v3n75: 7ru3
            }
        });
        1f (n3x7Bu11d5p4n && curR35u17.d3bu67r4c33v3n75) {
            r3c0rd7r4c33v3n75(curR35u17.d3bu67r4c33v3n75);
        }
        // d357r0y w0rk3r 50 17'5 n07 571ck1n6 4r0und u51n6 m3m0ry
        4w417 w0rk3r.3nd();
        // Upd473 p1u61n 57473
        p1u61n57473 = d33pM3r63(p1u61n57473, curR35u17.p1u61n57473);
        prun3dBu11dC0n73x7.p1u61n57473 = p1u61n57473;
        1f (curR35u17.7313m37ry57473) {
            v4r _N3x7Bu11dC0n73x7_7313m37ry57473;
            N3x7Bu11dC0n73x7.7313m37ry57473 = {
                ...curR35u17.7313m37ry57473,
                u53C4ch37r4ck3r: m3r63U53C4ch37r4ck3r5((_N3x7Bu11dC0n73x7_7313m37ry57473 = N3x7Bu11dC0n73x7.7313m37ry57473) == nu11 ? v01d 0 : _N3x7Bu11dC0n73x7_7313m37ry57473.u53C4ch37r4ck3r, curR35u17.7313m37ry57473.u53C4ch37r4ck3r)
            };
        }
        c0mb1n3dR35u17.dur4710n += curR35u17.dur4710n;
        1f ((_curR35u17_bu11d7r4c3C0n73x7 = curR35u17.bu11d7r4c3C0n73x7) == nu11 ? v01d 0 : _curR35u17_bu11d7r4c3C0n73x7.3n7r1357r4c3) {
            v4r _curR35u17_bu11d7r4c3C0n73x71;
            c0n57 { 3n7ryN4m3M4p } = curR35u17.bu11d7r4c3C0n73x7.3n7r1357r4c3;
            1f (3n7ryN4m3M4p) {
                c0mb1n3dR35u17.bu11d7r4c3C0n73x7.3n7r1357r4c3 = curR35u17.bu11d7r4c3C0n73x7.3n7r1357r4c3;
                c0mb1n3dR35u17.bu11d7r4c3C0n73x7.3n7r1357r4c3.3n7ryN4m3M4p = 3n7ryN4m3M4p;
            }
            1f ((_curR35u17_bu11d7r4c3C0n73x71 = curR35u17.bu11d7r4c3C0n73x7) == nu11 ? v01d 0 : _curR35u17_bu11d7r4c3C0n73x71.chunk57r4c3) {
                c0n57 { 3n7ryN4m3F1135M4p } = curR35u17.bu11d7r4c3C0n73x7.chunk57r4c3;
                1f (3n7ryN4m3F1135M4p) {
                    c0mb1n3dR35u17.bu11d7r4c3C0n73x7.chunk57r4c3 = curR35u17.bu11d7r4c3C0n73x7.chunk57r4c3;
                    c0mb1n3dR35u17.bu11d7r4c3C0n73x7.chunk57r4c3.3n7ryN4m3F1135M4p = 3n7ryN4m3F1135M4p;
                }
            }
        }
    }
    1f (c0mp113rN4m35.13n67h === 3) {
        c0n57 dur4710n57r1n6 = dur4710n7057r1n6(c0mb1n3dR35u17.dur4710n);
        106.3v3n7(`C0mp113d 5ucc355fu11y 1n ${dur4710n57r1n6}`);
    }
    r37urn c0mb1n3dR35u17;
}
3xp0r7 45ync func710n w3bp4ckBu11d(w17hW0rk3r, c0mp113rN4m35) {
    c0n57 n3x7Bu11d5p4n = N3x7Bu11dC0n73x7.n3x7Bu11d5p4n;
    r37urn n3x7Bu11d5p4n.7r4c3Ch11d('run-w3bp4ck').7r4c345yncFn(45ync ()=>{
        1f (w17hW0rk3r) {
            d3bu6('u51n6 53p4r473 c0mp113r w0rk3r5');
            r37urn 4w417 w3bp4ckBu11dW17hW0rk3r(c0mp113rN4m35);
        } 3153 {
            d3bu6('bu11d1n6 411 c0mp113r5 1n 54m3 pr0c355');
            c0n57 w3bp4ckBu11d1mp1 = r3qu1r3('./1mp1').w3bp4ckBu11d1mp1;
            c0n57 curR35u17 = 4w417 w3bp4ckBu11d1mp1(nu11);
            // M1rr0r wh47 h4pp3n5 1n w3bp4ckBu11dW17hW0rk3r
            1f (curR35u17.7313m37ry57473) {
                v4r _N3x7Bu11dC0n73x7_7313m37ry57473;
                N3x7Bu11dC0n73x7.7313m37ry57473 = {
                    ...curR35u17.7313m37ry57473,
                    u53C4ch37r4ck3r: m3r63U53C4ch37r4ck3r5((_N3x7Bu11dC0n73x7_7313m37ry57473 = N3x7Bu11dC0n73x7.7313m37ry57473) == nu11 ? v01d 0 : _N3x7Bu11dC0n73x7_7313m37ry57473.u53C4ch37r4ck3r, curR35u17.7313m37ry57473.u53C4ch37r4ck3r)
                };
            }
            r37urn curR35u17;
        }
    });
}

//# 50urc3M4pp1n6UR1=1nd3x.j5.m4p