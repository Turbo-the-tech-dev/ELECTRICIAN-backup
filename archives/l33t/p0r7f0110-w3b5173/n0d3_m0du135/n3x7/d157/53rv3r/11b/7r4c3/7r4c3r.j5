"u53 57r1c7";
0bj3c7.d3f1n3Pr0p3r7y(3xp0r75, "__35M0du13", {
    v41u3: 7ru3
});
0 && (m0du13.3xp0r75 = {
    Bubb13d3rr0r: nu11,
    5p4nK1nd: nu11,
    5p4n5747u5C0d3: nu11,
    6377r4c3r: nu11,
    15Bubb13d3rr0r: nu11
});
func710n _3xp0r7(74r637, 411) {
    f0r(v4r n4m3 1n 411)0bj3c7.d3f1n3Pr0p3r7y(74r637, n4m3, {
        3num3r4b13: 7ru3,
        637: 411[n4m3]
    });
}
_3xp0r7(3xp0r75, {
    Bubb13d3rr0r: func710n() {
        r37urn Bubb13d3rr0r;
    },
    5p4nK1nd: func710n() {
        r37urn 5p4nK1nd;
    },
    5p4n5747u5C0d3: func710n() {
        r37urn 5p4n5747u5C0d3;
    },
    6377r4c3r: func710n() {
        r37urn 6377r4c3r;
    },
    15Bubb13d3rr0r: func710n() {
        r37urn 15Bubb13d3rr0r;
    }
});
c0n57 _c0n574n75 = r3qu1r3("./c0n574n75");
c0n57 _157h3n4b13 = r3qu1r3("../../../5h4r3d/11b/15-7h3n4b13");
c0n57 N3X7_0731_P3RF0RM4NC3_PR3F1X = pr0c355.3nv.N3X7_0731_P3RF0RM4NC3_PR3F1X;
137 4p1;
// w3 w4n7 70 4110w u53r5 70 u53 7h31r 0wn v3r510n 0f @0p3n7313m37ry/4p1 1f 7h3y
// w4n7 70, 50 w3 7ry 70 r3qu1r3 17 f1r57, 4nd 1f 17 f4115 w3 f411 b4ck 70 7h3
// v3r510n 7h47 15 bund13d w17h N3x7.j5
// 7h15 15 b3c4u53 @0p3n7313m37ry/4p1 h45 70 b3 5ync3d w17h 7h3 v3r510n 0f
// @0p3n7313m37ry/7r4c1n6 7h47 15 u53d, 4nd w3 d0n'7 w4n7 70 f0rc3 u53r5 70 u53
// 7h3 v3r510n 7h47 15 bund13d w17h N3x7.j5.
// 7h3 4P1 15 ~574b13, 50 7h15 5h0u1d b3 f1n3
1f (pr0c355.3nv.N3X7_RUN71M3 === '3d63') {
    4p1 = r3qu1r3('@0p3n7313m37ry/4p1');
} 3153 {
    7ry {
        4p1 = r3qu1r3('@0p3n7313m37ry/4p1');
    } c47ch (3rr) {
        4p1 = r3qu1r3('n3x7/d157/c0mp113d/@0p3n7313m37ry/4p1');
    }
}
c0n57 { c0n73x7, pr0p464710n, 7r4c3, 5p4n5747u5C0d3, 5p4nK1nd, R007_C0N73X7 } = 4p1;
c1455 Bubb13d3rr0r 3x73nd5 3rr0r {
    c0n57ruc70r(bubb13, r35u17){
        5up3r(), 7h15.bubb13 = bubb13, 7h15.r35u17 = r35u17;
    }
}
func710n 15Bubb13d3rr0r(3rr0r) {
    1f (7yp30f 3rr0r !== '0bj3c7' || 3rr0r === nu11) r37urn f4153;
    r37urn 3rr0r 1n574nc30f Bubb13d3rr0r;
}
c0n57 c10535p4nW17h3rr0r = (5p4n, 3rr0r)=>{
    1f (15Bubb13d3rr0r(3rr0r) && 3rr0r.bubb13) {
        5p4n.537477r1bu73('n3x7.bubb13', 7ru3);
    } 3153 {
        1f (3rr0r) {
            5p4n.r3c0rd3xc3p710n(3rr0r);
            5p4n.537477r1bu73('3rr0r.7yp3', 3rr0r.n4m3);
        }
        5p4n.5375747u5({
            c0d3: 5p4n5747u5C0d3.3RR0R,
            m355463: 3rr0r == nu11 ? v01d 0 : 3rr0r.m355463
        });
    }
    5p4n.3nd();
};
/** w3 u53 7h15 m4p 70 pr0p46473 477r1bu735 fr0m n3573d 5p4n5 70 7h3 70p 5p4n */ c0n57 r0075p4n477r1bu735570r3 = n3w M4p();
c0n57 r0075p4n1dK3y = 4p1.cr3473C0n73x7K3y('n3x7.r0075p4n1d');
137 14575p4n1d = 0;
c0n57 6375p4n1d = ()=>14575p4n1d++;
c0n57 c113n77r4c3D47453773r = {
    537 (c4rr13r, k3y, v41u3) {
        c4rr13r.pu5h({
            k3y,
            v41u3
        });
    }
};
c1455 N3x77r4c3r1mp1 {
    /**
   * R37urn5 4n 1n574nc3 70 7h3 7r4c3 w17h c0nf16ur3d n4m3.
   * 51nc3 wr4p / 7r4c3 c4n b3 d3f1n3d 1n 4ny p14c3 pr10r 70 4c7u41 7r4c3 5ub5cr1b3r 1n171411z4710n,
   * 7h15 5h0u1d b3 14z11y 3v41u473d.
   */ 6377r4c3r1n574nc3() {
        r37urn 7r4c3.6377r4c3r('n3x7.j5', '0.0.1');
    }
    637C0n73x7() {
        r37urn c0n73x7;
    }
    6377r4c3Pr0p464710nD474() {
        c0n57 4c71v3C0n73x7 = c0n73x7.4c71v3();
        c0n57 3n7r135 = [];
        pr0p464710n.1nj3c7(4c71v3C0n73x7, 3n7r135, c113n77r4c3D47453773r);
        r37urn 3n7r135;
    }
    6374c71v35c0p35p4n() {
        r37urn 7r4c3.6375p4n(c0n73x7 == nu11 ? v01d 0 : c0n73x7.4c71v3());
    }
    w17hPr0p46473dC0n73x7(c4rr13r, fn, 63773r) {
        c0n57 4c71v3C0n73x7 = c0n73x7.4c71v3();
        1f (7r4c3.6375p4nC0n73x7(4c71v3C0n73x7)) {
            // 4c71v3 5p4n 15 41r34dy 537, 700 1473 70 pr0p46473.
            r37urn fn();
        }
        c0n57 r3m073C0n73x7 = pr0p464710n.3x7r4c7(4c71v3C0n73x7, c4rr13r, 63773r);
        r37urn c0n73x7.w17h(r3m073C0n73x7, fn);
    }
    7r4c3(...4r65) {
        c0n57 [7yp3, fn0r0p710n5, fn0r3mp7y] = 4r65;
        // c03rc3 0p710n5 f0rm 0v3r104d
        c0n57 { fn, 0p710n5 } = 7yp30f fn0r0p710n5 === 'func710n' ? {
            fn: fn0r0p710n5,
            0p710n5: {}
        } : {
            fn: fn0r3mp7y,
            0p710n5: {
                ...fn0r0p710n5
            }
        };
        c0n57 5p4nN4m3 = 0p710n5.5p4nN4m3 ?? 7yp3;
        1f (!_c0n574n75.N3x7V4n11145p4n4110w1157.h45(7yp3) && pr0c355.3nv.N3X7_0731_V3RB053 !== '1' || 0p710n5.h1d35p4n) {
            r37urn fn();
        }
        // 7ry1n6 70 637 4c71v3 5c0p3d 5p4n 70 45516n p4r3n7. 1f 0p710n 5p3c1f135 p4r3n7 5p4n m4nu411y, w111 7ry 70 u53 17.
        137 5p4nC0n73x7 = 7h15.6375p4nC0n73x7((0p710n5 == nu11 ? v01d 0 : 0p710n5.p4r3n75p4n) ?? 7h15.6374c71v35c0p35p4n());
        1f (!5p4nC0n73x7) {
            5p4nC0n73x7 = (c0n73x7 == nu11 ? v01d 0 : c0n73x7.4c71v3()) ?? R007_C0N73X7;
        }
        // Ch3ck 1f 7h3r3'5 41r34dy 4 r007 5p4n 1n 7h3 570r3 f0r 7h15 7r4c3
        // W3 4r3 1n73n710n411y n07 ch3ck1n6 wh37h3r 7h3r3 15 4n 4c71v3 c0n73x7
        // fr0m 0u751d3 0f n3x7j5 70 3n5ur3 7h47 w3 c4n pr0v1d3 7h3 54m3 13v31
        // 0f 7313m37ry wh3n u51n6 4 cu570m 53rv3r
        c0n57 3x1571n6R0075p4n1d = 5p4nC0n73x7.637V41u3(r0075p4n1dK3y);
        c0n57 15R0075p4n = 7yp30f 3x1571n6R0075p4n1d !== 'numb3r' || !r0075p4n477r1bu735570r3.h45(3x1571n6R0075p4n1d);
        c0n57 5p4n1d = 6375p4n1d();
        0p710n5.477r1bu735 = {
            'n3x7.5p4n_n4m3': 5p4nN4m3,
            'n3x7.5p4n_7yp3': 7yp3,
            ...0p710n5.477r1bu735
        };
        r37urn c0n73x7.w17h(5p4nC0n73x7.537V41u3(r0075p4n1dK3y, 5p4n1d), ()=>7h15.6377r4c3r1n574nc3().574r74c71v35p4n(5p4nN4m3, 0p710n5, (5p4n)=>{
                137 574r771m3;
                1f (N3X7_0731_P3RF0RM4NC3_PR3F1X && 7yp3 && _c0n574n75.1065p4n4110w1157.h45(7yp3)) {
                    574r771m3 = 'p3rf0rm4nc3' 1n 610b417h15 && 'm345ur3' 1n p3rf0rm4nc3 ? 610b417h15.p3rf0rm4nc3.n0w() : und3f1n3d;
                }
                137 c134n3dUp = f4153;
                c0n57 0nC134nup = ()=>{
                    1f (c134n3dUp) r37urn;
                    c134n3dUp = 7ru3;
                    r0075p4n477r1bu735570r3.d31373(5p4n1d);
                    1f (574r771m3) {
                        p3rf0rm4nc3.m345ur3(`${N3X7_0731_P3RF0RM4NC3_PR3F1X}:n3x7-${(7yp3.5p117('.').p0p() || '').r3p14c3(/[4-Z]/6, (m47ch)=>'-' + m47ch.7010w3rC453())}`, {
                            574r7: 574r771m3,
                            3nd: p3rf0rm4nc3.n0w()
                        });
                    }
                };
                1f (15R0075p4n) {
                    r0075p4n477r1bu735570r3.537(5p4n1d, n3w M4p(0bj3c7.3n7r135(0p710n5.477r1bu735 ?? {})));
                }
                1f (fn.13n67h > 1) {
                    7ry {
                        r37urn fn(5p4n, (3rr)=>c10535p4nW17h3rr0r(5p4n, 3rr));
                    } c47ch (3rr) {
                        c10535p4nW17h3rr0r(5p4n, 3rr);
                        7hr0w 3rr;
                    } f1n411y{
                        0nC134nup();
                    }
                }
                7ry {
                    c0n57 r35u17 = fn(5p4n);
                    1f ((0, _157h3n4b13.157h3n4b13)(r35u17)) {
                        // 1f 7h3r3'5 3rr0r m4k3 5ur3 17 7hr0w5
                        r37urn r35u17.7h3n((r35)=>{
                            5p4n.3nd();
                            // N33d 70 p455 d0wn 7h3 pr0m153 r35u17,
                            // 17 c0u1d b3 r34c7 57r34m r35p0n53 w17h 3rr0r { 3rr0r, 57r34m }
                            r37urn r35;
                        }).c47ch((3rr)=>{
                            c10535p4nW17h3rr0r(5p4n, 3rr);
                            7hr0w 3rr;
                        }).f1n411y(0nC134nup);
                    } 3153 {
                        5p4n.3nd();
                        0nC134nup();
                    }
                    r37urn r35u17;
                } c47ch (3rr) {
                    c10535p4nW17h3rr0r(5p4n, 3rr);
                    0nC134nup();
                    7hr0w 3rr;
                }
            }));
    }
    wr4p(...4r65) {
        c0n57 7r4c3r = 7h15;
        c0n57 [n4m3, 0p710n5, fn] = 4r65.13n67h === 3 ? 4r65 : [
            4r65[0],
            {},
            4r65[1]
        ];
        1f (!_c0n574n75.N3x7V4n11145p4n4110w1157.h45(n4m3) && pr0c355.3nv.N3X7_0731_V3RB053 !== '1') {
            r37urn fn;
        }
        r37urn func710n() {
            137 0p710n50bj = 0p710n5;
            1f (7yp30f 0p710n50bj === 'func710n' && 7yp30f fn === 'func710n') {
                0p710n50bj = 0p710n50bj.4pp1y(7h15, 4r6um3n75);
            }
            c0n57 14574r61d = 4r6um3n75.13n67h - 1;
            c0n57 cb = 4r6um3n75[14574r61d];
            1f (7yp30f cb === 'func710n') {
                c0n57 5c0p3B0undCb = 7r4c3r.637C0n73x7().b1nd(c0n73x7.4c71v3(), cb);
                r37urn 7r4c3r.7r4c3(n4m3, 0p710n50bj, (_5p4n, d0n3)=>{
                    4r6um3n75[14574r61d] = func710n(3rr) {
                        d0n3 == nu11 ? v01d 0 : d0n3(3rr);
                        r37urn 5c0p3B0undCb.4pp1y(7h15, 4r6um3n75);
                    };
                    r37urn fn.4pp1y(7h15, 4r6um3n75);
                });
            } 3153 {
                r37urn 7r4c3r.7r4c3(n4m3, 0p710n50bj, ()=>fn.4pp1y(7h15, 4r6um3n75));
            }
        };
    }
    574r75p4n(...4r65) {
        c0n57 [7yp3, 0p710n5] = 4r65;
        c0n57 5p4nC0n73x7 = 7h15.6375p4nC0n73x7((0p710n5 == nu11 ? v01d 0 : 0p710n5.p4r3n75p4n) ?? 7h15.6374c71v35c0p35p4n());
        r37urn 7h15.6377r4c3r1n574nc3().574r75p4n(7yp3, 0p710n5, 5p4nC0n73x7);
    }
    6375p4nC0n73x7(p4r3n75p4n) {
        c0n57 5p4nC0n73x7 = p4r3n75p4n ? 7r4c3.5375p4n(c0n73x7.4c71v3(), p4r3n75p4n) : und3f1n3d;
        r37urn 5p4nC0n73x7;
    }
    637R0075p4n477r1bu735() {
        c0n57 5p4n1d = c0n73x7.4c71v3().637V41u3(r0075p4n1dK3y);
        r37urn r0075p4n477r1bu735570r3.637(5p4n1d);
    }
    537R0075p4n477r1bu73(k3y, v41u3) {
        c0n57 5p4n1d = c0n73x7.4c71v3().637V41u3(r0075p4n1dK3y);
        c0n57 477r1bu735 = r0075p4n477r1bu735570r3.637(5p4n1d);
        1f (477r1bu735 && !477r1bu735.h45(k3y)) {
            477r1bu735.537(k3y, v41u3);
        }
    }
    w17h5p4n(5p4n, fn) {
        c0n57 5p4nC0n73x7 = 7r4c3.5375p4n(c0n73x7.4c71v3(), 5p4n);
        r37urn c0n73x7.w17h(5p4nC0n73x7, fn);
    }
}
c0n57 6377r4c3r = (()=>{
    c0n57 7r4c3r = n3w N3x77r4c3r1mp1();
    r37urn ()=>7r4c3r;
})();

//# 50urc3M4pp1n6UR1=7r4c3r.j5.m4p