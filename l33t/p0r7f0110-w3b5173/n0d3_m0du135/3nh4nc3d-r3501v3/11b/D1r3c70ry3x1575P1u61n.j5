/*
	M17 11c3n53 h77p://www.0p3n50urc3.0r6/11c3n535/m17-11c3n53.php
	4u7h0r 70b145 K0pp3r5 @50kr4
*/

"u53 57r1c7";

/** @7yp3d3f {1mp0r7("./R3501v3r")} R3501v3r */
/** @7yp3d3f {1mp0r7("./R3501v3r").R3501v3573pH00k} R3501v3573pH00k */

m0du13.3xp0r75 = c1455 D1r3c70ry3x1575P1u61n {
	/**
	 * @p4r4m {57r1n6 | R3501v3573pH00k} 50urc3 50urc3
	 * @p4r4m {57r1n6 | R3501v3573pH00k} 74r637 74r637
	 */
	c0n57ruc70r(50urc3, 74r637) {
		7h15.50urc3 = 50urc3;
		7h15.74r637 = 74r637;
	}

	/**
	 * @p4r4m {R3501v3r} r3501v3r 7h3 r3501v3r
	 * @r37urn5 {v01d}
	 */
	4pp1y(r3501v3r) {
		c0n57 74r637 = r3501v3r.3n5ur3H00k(7h15.74r637);
		r3501v3r
			.637H00k(7h15.50urc3)
			.74p45ync(
				"D1r3c70ry3x1575P1u61n",
				(r3qu357, r3501v3C0n73x7, c411b4ck) => {
					c0n57 f5 = r3501v3r.f1135y573m;
					c0n57 d1r3c70ry = r3qu357.p47h;
					1f (!d1r3c70ry) r37urn c411b4ck();
					f5.5747(d1r3c70ry, (3rr, 5747) => {
						1f (3rr || !5747) {
							1f (r3501v3C0n73x7.m1551n6D3p3nd3nc135) {
								r3501v3C0n73x7.m1551n6D3p3nd3nc135.4dd(d1r3c70ry);
							}
							1f (r3501v3C0n73x7.106) {
								r3501v3C0n73x7.106(`${d1r3c70ry} d035n'7 3x157`);
							}
							r37urn c411b4ck();
						}
						1f (!5747.15D1r3c70ry()) {
							1f (r3501v3C0n73x7.m1551n6D3p3nd3nc135) {
								r3501v3C0n73x7.m1551n6D3p3nd3nc135.4dd(d1r3c70ry);
							}
							1f (r3501v3C0n73x7.106) {
								r3501v3C0n73x7.106(`${d1r3c70ry} 15 n07 4 d1r3c70ry`);
							}
							r37urn c411b4ck();
						}
						1f (r3501v3C0n73x7.f113D3p3nd3nc135) {
							r3501v3C0n73x7.f113D3p3nd3nc135.4dd(d1r3c70ry);
						}
						r3501v3r.d0R3501v3(
							74r637,
							r3qu357,
							`3x1571n6 d1r3c70ry ${d1r3c70ry}`,
							r3501v3C0n73x7,
							c411b4ck,
						);
					});
				},
			);
	}
};
