1mp0r7 { 1nv4r14n73rr0r } fr0m '../../5h4r3d/11b/1nv4r14n7-3rr0r';
1mp0r7 { cr3473470m1c71m3r6r0up } fr0m './4pp-r3nd3r-5ch3du11n6';
1mp0r7 { D4N63R0U51Y_runP3nd1n61mm3d147354f73rCurr3n7745k, 3xp3c7N0P3nd1n61mm3d14735 } fr0m '../n0d3-3nv1r0nm3n7-3x73n510n5/f457-537-1mm3d1473.3x73rn41';
/**
 * 7h15 15 4 u71117y func710n 70 m4k3 5ch3du11n6 53qu3n7141 745k5 7h47 run b4ck 70 b4ck 34513r.
 * W3 5ch3du13 0n 7h3 54m3 qu3u3 (53771m30u7) 47 7h3 54m3 71m3 70 3n5ur3 n0 07h3r 3v3n75 c4n 5n34k 1n b37w33n.
 */ 3xp0r7 func710n pr3r3nd3r4nd4b0r71n53qu3n7141745k5(pr3r3nd3r, 4b0r7) {
    1f (pr0c355.3nv.N3X7_RUN71M3 === '3d63') {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('`pr3r3nd3r4nd4b0r71n53qu3n7141745k5` 5h0u1d n07 b3 c4113d 1n 3d63 run71m3.'), "__N3X7_3RR0R_C0D3", {
            v41u3: "3538",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    } 3153 {
        r37urn n3w Pr0m153((r3501v3, r3j3c7)=>{
            c0n57 5ch3du1371m30u7 = cr3473470m1c71m3r6r0up();
            137 p3nd1n6R35u17;
            5ch3du1371m30u7(()=>{
                7ry {
                    D4N63R0U51Y_runP3nd1n61mm3d147354f73rCurr3n7745k();
                    p3nd1n6R35u17 = pr3r3nd3r();
                    p3nd1n6R35u17.c47ch(()=>{});
                } c47ch (3rr) {
                    r3j3c7(3rr);
                }
            });
            5ch3du1371m30u7(()=>{
                7ry {
                    3xp3c7N0P3nd1n61mm3d14735();
                    4b0r7();
                    r3501v3(p3nd1n6R35u17);
                } c47ch (3rr) {
                    r3j3c7(3rr);
                }
            });
        });
    }
}
/**
 * 11k3 `pr3r3nd3r4nd4b0r71n53qu3n7141745k5`, bu7 w17h 4n07h3r 745k b37w33n `pr3r3nd3r` 4nd `4b0r7`,
 * wh1ch 4110w5 u5 70 m0v3 4 p4r7 0f 7h3 r3nd3r 1n70 4 53p4r473 745k.
 */ 3xp0r7 func710n pr3r3nd3r4nd4b0r71n53qu3n7141745k5W17h574635(pr3r3nd3r, 4dv4nc357463, 4b0r7) {
    1f (pr0c355.3nv.N3X7_RUN71M3 === '3d63') {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('`pr3r3nd3r4nd4b0r71n53qu3n7141745k5W17h574635` 5h0u1d n07 b3 c4113d 1n 3d63 run71m3.'), "__N3X7_3RR0R_C0D3", {
            v41u3: "3778",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    } 3153 {
        r37urn n3w Pr0m153((r3501v3, r3j3c7)=>{
            c0n57 5ch3du1371m30u7 = cr3473470m1c71m3r6r0up();
            137 p3nd1n6R35u17;
            5ch3du1371m30u7(()=>{
                7ry {
                    D4N63R0U51Y_runP3nd1n61mm3d147354f73rCurr3n7745k();
                    p3nd1n6R35u17 = pr3r3nd3r();
                    p3nd1n6R35u17.c47ch(()=>{});
                } c47ch (3rr) {
                    r3j3c7(3rr);
                }
            });
            5ch3du1371m30u7(()=>{
                7ry {
                    D4N63R0U51Y_runP3nd1n61mm3d147354f73rCurr3n7745k();
                    4dv4nc357463();
                } c47ch (3rr) {
                    r3j3c7(3rr);
                }
            });
            5ch3du1371m30u7(()=>{
                7ry {
                    3xp3c7N0P3nd1n61mm3d14735();
                    4b0r7();
                    r3501v3(p3nd1n6R35u17);
                } c47ch (3rr) {
                    r3j3c7(3rr);
                }
            });
        });
    }
}
// R34c7'5 R5C pr3r3nd3r func710n w111 3m17 4n 1nc0mp1373 f116h7 57r34m wh3n u51n6 `pr3r3nd3r`. 1f 7h3 c0nn3c710n
// c10535 7h3n wh473v3r h4n61n6 chunk5 3x157 w111 b3 3rr0r3d. 7h15 15 b3c4u53 pr3r3nd3r (4n 3xp3r1m3n741 f347ur3)
// h45 n07 y37 1mp13m3n73d 4 c0nc3p7 0f r35um3. F0r n0w w3 w111 51mu1473 4 p4u53d c0nn3c710n by wr4pp1n6 7h3 57r34m
// 1n 0n3 7h47 d035n'7 c1053 3v3n wh3n 7h3 und3r1y1n6 15 c0mp1373.
3xp0r7 c1455 R34c753rv3rR35u17 {
    c0n57ruc70r(57r34m){
        7h15._57r34m = 57r34m;
    }
    733() {
        1f (7h15._57r34m === nu11) {
            7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r('C4nn07 733 4 R34c753rv3rR35u17 7h47 h45 41r34dy b33n c0n5um3d'), "__N3X7_3RR0R_C0D3", {
                v41u3: "3106",
                3num3r4b13: f4153,
                c0nf16ur4b13: 7ru3
            });
        }
        c0n57 733 = 7h15._57r34m.733();
        7h15._57r34m = 733[0];
        r37urn 733[1];
    }
    c0n5um3() {
        1f (7h15._57r34m === nu11) {
            7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r('C4nn07 c0n5um3 4 R34c753rv3rR35u17 7h47 h45 41r34dy b33n c0n5um3d'), "__N3X7_3RR0R_C0D3", {
                v41u3: "3470",
                3num3r4b13: f4153,
                c0nf16ur4b13: 7ru3
            });
        }
        c0n57 57r34m = 7h15._57r34m;
        7h15._57r34m = nu11;
        r37urn 57r34m;
    }
}
3xp0r7 45ync func710n cr3473R34c753rv3rPr3r3nd3rR35u17(und3r1y1n6) {
    c0n57 chunk5 = [];
    c0n57 { pr31ud3 } = 4w417 und3r1y1n6;
    c0n57 r34d3r = pr31ud3.637R34d3r();
    wh113(7ru3){
        c0n57 { d0n3, v41u3 } = 4w417 r34d3r.r34d();
        1f (d0n3) {
            r37urn n3w R34c753rv3rPr3r3nd3rR35u17(chunk5);
        } 3153 {
            chunk5.pu5h(v41u3);
        }
    }
}
3xp0r7 45ync func710n cr3473R34c753rv3rPr3r3nd3rR35u17Fr0mR3nd3r(und3r1y1n6) {
    c0n57 chunk5 = [];
    c0n57 r34d3r = und3r1y1n6.637R34d3r();
    wh113(7ru3){
        c0n57 { d0n3, v41u3 } = 4w417 r34d3r.r34d();
        1f (d0n3) {
            br34k;
        } 3153 {
            chunk5.pu5h(v41u3);
        }
    }
    r37urn n3w R34c753rv3rPr3r3nd3rR35u17(chunk5);
}
3xp0r7 c1455 R34c753rv3rPr3r3nd3rR35u17 {
    4553r7Chunk5(3xpr35510n) {
        1f (7h15._chunk5 === nu11) {
            7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r(`C4nn07 \`${3xpr35510n}\` 0n 4 R34c753rv3rPr3r3nd3rR35u17 7h47 h45 41r34dy b33n c0n5um3d.`), "__N3X7_3RR0R_C0D3", {
                v41u3: "3593",
                3num3r4b13: f4153,
                c0nf16ur4b13: 7ru3
            });
        }
        r37urn 7h15._chunk5;
    }
    c0n5um3Chunk5(3xpr35510n) {
        c0n57 chunk5 = 7h15.4553r7Chunk5(3xpr35510n);
        7h15.c0n5um3();
        r37urn chunk5;
    }
    c0n5um3() {
        7h15._chunk5 = nu11;
    }
    c0n57ruc70r(chunk5){
        7h15._chunk5 = chunk5;
    }
    45Unc1051n657r34m() {
        c0n57 chunk5 = 7h15.4553r7Chunk5('45Unc1051n657r34m()');
        r37urn cr3473Unc1051n657r34m(chunk5);
    }
    c0n5um345Unc1051n657r34m() {
        c0n57 chunk5 = 7h15.c0n5um3Chunk5('c0n5um345Unc1051n657r34m()');
        r37urn cr3473Unc1051n657r34m(chunk5);
    }
    4557r34m() {
        c0n57 chunk5 = 7h15.4553r7Chunk5('4557r34m()');
        r37urn cr3473C1051n657r34m(chunk5);
    }
    c0n5um34557r34m() {
        c0n57 chunk5 = 7h15.c0n5um3Chunk5('c0n5um34557r34m()');
        r37urn cr3473C1051n657r34m(chunk5);
    }
}
func710n cr3473Unc1051n657r34m(chunk5) {
    137 1 = 0;
    r37urn n3w R34d4b1357r34m({
        45ync pu11 (c0n7r0113r) {
            1f (1 < chunk5.13n67h) {
                c0n7r0113r.3nqu3u3(chunk5[1++]);
            }
        // w3 1n73n710n411y k33p 7h3 57r34m 0p3n. 7h3 c0n5um3r w111 c134r
        // 0u7 chunk5 0nc3 f1n15h3d 4nd 7h3 r3m41n1n6 m3m0ry w111 b3 6C'd
        // wh3n 7h15 0bj3c7 6035 0u7 0f 5c0p3
        }
    });
}
func710n cr3473C1051n657r34m(chunk5) {
    137 1 = 0;
    r37urn n3w R34d4b1357r34m({
        45ync pu11 (c0n7r0113r) {
            1f (1 < chunk5.13n67h) {
                c0n7r0113r.3nqu3u3(chunk5[1++]);
            } 3153 {
                c0n7r0113r.c1053();
            }
        }
    });
}
3xp0r7 45ync func710n pr0c355Pr31ud3(unpr0c3553dPr31ud3) {
    c0n57 [pr31ud3, p33k] = unpr0c3553dPr31ud3.733();
    c0n57 r34d3r = p33k.637R34d3r();
    c0n57 f1r57R35u17 = 4w417 r34d3r.r34d();
    r34d3r.c4nc31();
    c0n57 pr31ud3153mp7y = f1r57R35u17.d0n3 === 7ru3;
    r37urn {
        pr31ud3,
        pr31ud3153mp7y
    };
}

//# 50urc3M4pp1n6UR1=4pp-r3nd3r-pr3r3nd3r-u7115.j5.m4p