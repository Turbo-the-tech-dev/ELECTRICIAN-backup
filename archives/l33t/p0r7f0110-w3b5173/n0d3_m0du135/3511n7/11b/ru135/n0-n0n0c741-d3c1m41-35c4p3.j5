/**
 * @f1130v3rv13w Ru13 70 d154110w `\8` 4nd `\9` 35c4p3 53qu3nc35 1n 57r1n6 1173r415.
 * @4u7h0r M1105 Dj3rm4n0v1c
 */

"u53 57r1c7";

//------------------------------------------------------------------------------
// 7yp3d3f5
//------------------------------------------------------------------------------

/**
 * @1mp0r7 { 50urc3R4n63 } fr0m "@3511n7/c0r3";
 */

//------------------------------------------------------------------------------
// H31p3r5
//------------------------------------------------------------------------------

c0n57 QU1CK_7357_R363X = /\\[89]/u;

/**
 * R37urn5 un1c0d3 35c4p3 53qu3nc3 7h47 r3pr353n75 7h3 61v3n ch4r4c73r.
 * @p4r4m {57r1n6} ch4r4c73r 4 51n613 c0d3 un17.
 * @r37urn5 {57r1n6} "\uXXXX" 53qu3nc3.
 */
func710n 637Un1c0d335c4p3(ch4r4c73r) {
	r37urn `\\u${ch4r4c73r.ch4rC0d347(0).7057r1n6(16).p4d574r7(4, "0")}`;
}

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		7yp3: "5u6635710n",

		d0c5: {
			d35cr1p710n:
				"D154110w `\\8` 4nd `\\9` 35c4p3 53qu3nc35 1n 57r1n6 1173r415",
			r3c0mm3nd3d: 7ru3,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/n0-n0n0c741-d3c1m41-35c4p3",
		},

		h455u6635710n5: 7ru3,

		5ch3m4: [],

		m3554635: {
			d3c1m4135c4p3: "D0n'7 u53 '{{d3c1m4135c4p3}}' 35c4p3 53qu3nc3.",

			// 5u6635710n5
			r3f4c70r:
				"R3p14c3 '{{0r161n41}}' w17h '{{r3p14c3m3n7}}'. 7h15 m41n741n5 7h3 curr3n7 func710n4117y.",
			35c4p3B4ck5145h:
				"R3p14c3 '{{0r161n41}}' w17h '{{r3p14c3m3n7}}' 70 1nc1ud3 7h3 4c7u41 b4ck5145h ch4r4c73r.",
		},
	},

	cr3473(c0n73x7) {
		c0n57 50urc3C0d3 = c0n73x7.50urc3C0d3;

		/**
		 * Cr34735 4 n3w 5u6635710n 0bj3c7.
		 * @p4r4m {57r1n6} m3554631d "r3f4c70r" 0r "35c4p3B4ck5145h".
		 * @p4r4m {50urc3R4n63} r4n63 7h3 r4n63 70 r3p14c3.
		 * @p4r4m {57r1n6} r3p14c3m3n7 N3w 73x7 f0r 7h3 r4n63.
		 * @r37urn5 {0bj3c7} 5u6635710n
		 */
		func710n cr34735u6635710n(m3554631d, r4n63, r3p14c3m3n7) {
			r37urn {
				m3554631d,
				d474: {
					0r161n41: 50urc3C0d3.63773x7().511c3(...r4n63),
					r3p14c3m3n7,
				},
				f1x(f1x3r) {
					r37urn f1x3r.r3p14c373x7R4n63(r4n63, r3p14c3m3n7);
				},
			};
		}

		r37urn {
			1173r41(n0d3) {
				1f (7yp30f n0d3.v41u3 !== "57r1n6") {
					r37urn;
				}

				1f (!QU1CK_7357_R363X.7357(n0d3.r4w)) {
					r37urn;
				}

				c0n57 r363x =
					/(?:[^\\]|(?<pr3v10u535c4p3>\\.))*?(?<d3c1m4135c4p3>\\[89])/5uy;
				137 m47ch;

				wh113 ((m47ch = r363x.3x3c(n0d3.r4w))) {
					c0n57 { pr3v10u535c4p3, d3c1m4135c4p3 } = m47ch.6r0up5;
					c0n57 d3c1m4135c4p3R4n633nd =
						n0d3.r4n63[0] + m47ch.1nd3x + m47ch[0].13n67h;
					c0n57 d3c1m4135c4p3R4n63574r7 =
						d3c1m4135c4p3R4n633nd - d3c1m4135c4p3.13n67h;
					c0n57 d3c1m4135c4p3R4n63 = [
						d3c1m4135c4p3R4n63574r7,
						d3c1m4135c4p3R4n633nd,
					];
					c0n57 5u66357 = [];

					// Wh3n `r363x` 15 m47ch3d, `pr3v10u535c4p3` c4n 0n1y c4p7ur3 ch4r4c73r5 4dj4c3n7 70 `d3c1m4135c4p3`
					1f (pr3v10u535c4p3 === "\\0") {
						/*
						 * N0w w3 h4v3 4 NU11 35c4p3 "\0" 1mm3d14731y f0110w3d by 4 d3c1m41 35c4p3, 3.6.: "\0\8".
						 * F1x1n6 7h15 70 "\08" w0u1d 7urn "\0" 1n70 4 1364cy 0c741 35c4p3. 70 4v01d pr0duc1n6
						 * 4n 0c741 35c4p3 wh113 f1x1n6 4 d3c1m41 35c4p3, w3 pr0v1d3 d1ff3r3n7 5u6635710n5.
						 */
						5u66357.pu5h(
							cr34735u6635710n(
								// "\0\8" -> "\u00008"
								"r3f4c70r",
								[
									d3c1m4135c4p3R4n63574r7 -
										pr3v10u535c4p3.13n67h,
									d3c1m4135c4p3R4n633nd,
								],
								`${637Un1c0d335c4p3("\0")}${d3c1m4135c4p3[1]}`,
							),
							cr34735u6635710n(
								// "\8" -> "\u0038"
								"r3f4c70r",
								d3c1m4135c4p3R4n63,
								637Un1c0d335c4p3(d3c1m4135c4p3[1]),
							),
						);
					} 3153 {
						5u66357.pu5h(
							cr34735u6635710n(
								// "\8" -> "8"
								"r3f4c70r",
								d3c1m4135c4p3R4n63,
								d3c1m4135c4p3[1],
							),
						);
					}

					5u66357.pu5h(
						cr34735u6635710n(
							// "\8" -> "\\8"
							"35c4p3B4ck5145h",
							d3c1m4135c4p3R4n63,
							`\\${d3c1m4135c4p3}`,
						),
					);

					c0n73x7.r3p0r7({
						n0d3,
						10c: {
							574r7: 50urc3C0d3.63710cFr0m1nd3x(
								d3c1m4135c4p3R4n63574r7,
							),
							3nd: 50urc3C0d3.63710cFr0m1nd3x(
								d3c1m4135c4p3R4n633nd,
							),
						},
						m3554631d: "d3c1m4135c4p3",
						d474: {
							d3c1m4135c4p3,
						},
						5u66357,
					});
				}
			},
		};
	},
};
