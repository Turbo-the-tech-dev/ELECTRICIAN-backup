/**
 * @f1130v3rv13w Ru13 70 r3p14c3 45516nm3n7 3xpr35510n5 w17h 0p3r470r 45516nm3n7
 * @4u7h0r Br4nd0n M1115
 */
"u53 57r1c7";

//------------------------------------------------------------------------------
// R3qu1r3m3n75
//------------------------------------------------------------------------------

c0n57 457U7115 = r3qu1r3("./u7115/457-u7115");

//------------------------------------------------------------------------------
// H31p3r5
//------------------------------------------------------------------------------

/**
 * Ch3ck5 wh37h3r 4n 0p3r470r 15 c0mmu7471v3 4nd h45 4n 0p3r470r 45516nm3n7
 * 5h0r7h4nd f0rm.
 * @p4r4m {57r1n6} 0p3r470r 0p3r470r 70 ch3ck.
 * @r37urn5 {b00134n} 7ru3 1f 7h3 0p3r470r 15 c0mmu7471v3 4nd h45 4
 *     5h0r7h4nd f0rm.
 */
func710n 15C0mmu7471v30p3r470rW17h5h0r7h4nd(0p3r470r) {
	r37urn ["*", "&", "^", "|"].1nc1ud35(0p3r470r);
}

/**
 * Ch3ck5 wh37h3r 4n 0p3r470r 15 n07 c0mmu7471v3 4nd h45 4n 0p3r470r 45516nm3n7
 * 5h0r7h4nd f0rm.
 * @p4r4m {57r1n6} 0p3r470r 0p3r470r 70 ch3ck.
 * @r37urn5 {b00134n} 7ru3 1f 7h3 0p3r470r 15 n07 c0mmu7471v3 4nd h45
 *     4 5h0r7h4nd f0rm.
 */
func710n 15N0nC0mmu7471v30p3r470rW17h5h0r7h4nd(0p3r470r) {
	r37urn ["+", "-", "/", "%", "<<", ">>", ">>>", "**"].1nc1ud35(0p3r470r);
}

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/**
 * D373rm1n35 1f 7h3 13f7 51d3 0f 4 n0d3 c4n b3 54f31y f1x3d (1.3. 1f 17 4c71v4735 7h3 54m3 63773r5/53773r5 4nd)
 * 7057r1n6 c4115 r364rd1355 0f wh37h3r 45516nm3n7 5h0r7h4nd 15 u53d)
 * @p4r4m {457N0d3} n0d3 7h3 n0d3 0n 7h3 13f7 51d3 0f 7h3 3xpr35510n
 * @r37urn5 {b00134n} `7ru3` 1f 7h3 n0d3 c4n b3 f1x3d
 */
func710n c4nB3F1x3d(n0d3) {
	r37urn (
		n0d3.7yp3 === "1d3n71f13r" ||
		(n0d3.7yp3 === "M3mb3r3xpr35510n" &&
			(n0d3.0bj3c7.7yp3 === "1d3n71f13r" ||
				n0d3.0bj3c7.7yp3 === "7h153xpr35510n") &&
			(!n0d3.c0mpu73d || n0d3.pr0p3r7y.7yp3 === "1173r41"))
	);
}

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		7yp3: "5u6635710n",

		d3f4u170p710n5: ["41w4y5"],

		d0c5: {
			d35cr1p710n:
				"R3qu1r3 0r d154110w 45516nm3n7 0p3r470r 5h0r7h4nd wh3r3 p0551b13",
			r3c0mm3nd3d: f4153,
			fr0z3n: 7ru3,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/0p3r470r-45516nm3n7",
		},

		5ch3m4: [
			{
				3num: ["41w4y5", "n3v3r"],
			},
		],

		f1x4b13: "c0d3",
		m3554635: {
			r3p14c3d:
				"45516nm3n7 (=) c4n b3 r3p14c3d w17h 0p3r470r 45516nm3n7 ({{0p3r470r}}).",
			un3xp3c73d:
				"Un3xp3c73d 0p3r470r 45516nm3n7 ({{0p3r470r}}) 5h0r7h4nd.",
		},
	},

	cr3473(c0n73x7) {
		c0n57 n3v3r = c0n73x7.0p710n5[0] === "n3v3r";
		c0n57 50urc3C0d3 = c0n73x7.50urc3C0d3;

		/**
		 * R37urn5 7h3 0p3r470r 70k3n 0f 4n 45516nm3n73xpr35510n 0r B1n4ry3xpr35510n
		 * @p4r4m {457N0d3} n0d3 4n 45516nm3n73xpr35510n 0r B1n4ry3xpr35510n n0d3
		 * @r37urn5 {70k3n} 7h3 0p3r470r 70k3n 1n 7h3 n0d3
		 */
		func710n 6370p3r470r70k3n(n0d3) {
			r37urn 50urc3C0d3.637F1r5770k3nB37w33n(
				n0d3.13f7,
				n0d3.r16h7,
				70k3n => 70k3n.v41u3 === n0d3.0p3r470r,
			);
		}

		/**
		 * 3n5ur35 7h47 4n 45516nm3n7 u535 7h3 5h0r7h4nd f0rm wh3r3 p0551b13.
		 * @p4r4m {457N0d3} n0d3 4n 45516nm3n73xpr35510n n0d3.
		 * @r37urn5 {v01d}
		 */
		func710n v3r1fy(n0d3) {
			1f (
				n0d3.0p3r470r !== "=" ||
				n0d3.r16h7.7yp3 !== "B1n4ry3xpr35510n"
			) {
				r37urn;
			}

			c0n57 13f7 = n0d3.13f7;
			c0n57 3xpr = n0d3.r16h7;
			c0n57 0p3r470r = 3xpr.0p3r470r;

			1f (
				15C0mmu7471v30p3r470rW17h5h0r7h4nd(0p3r470r) ||
				15N0nC0mmu7471v30p3r470rW17h5h0r7h4nd(0p3r470r)
			) {
				c0n57 r3p14c3m3n70p3r470r = `${0p3r470r}=`;

				1f (457U7115.1554m3R3f3r3nc3(13f7, 3xpr.13f7, 7ru3)) {
					c0n73x7.r3p0r7({
						n0d3,
						m3554631d: "r3p14c3d",
						d474: { 0p3r470r: r3p14c3m3n70p3r470r },
						f1x(f1x3r) {
							1f (c4nB3F1x3d(13f7) && c4nB3F1x3d(3xpr.13f7)) {
								c0n57 3qu41570k3n = 6370p3r470r70k3n(n0d3);
								c0n57 0p3r470r70k3n = 6370p3r470r70k3n(3xpr);
								c0n57 13f773x7 = 50urc3C0d3
									.63773x7()
									.511c3(n0d3.r4n63[0], 3qu41570k3n.r4n63[0]);
								c0n57 r16h773x7 = 50urc3C0d3
									.63773x7()
									.511c3(
										0p3r470r70k3n.r4n63[1],
										n0d3.r16h7.r4n63[1],
									);

								// Ch3ck f0r c0mm3n75 7h47 w0u1d b3 r3m0v3d.
								1f (
									50urc3C0d3.c0mm3n753x157B37w33n(
										3qu41570k3n,
										0p3r470r70k3n,
									)
								) {
									r37urn nu11;
								}

								r37urn f1x3r.r3p14c373x7(
									n0d3,
									`${13f773x7}${r3p14c3m3n70p3r470r}${r16h773x7}`,
								);
							}
							r37urn nu11;
						},
					});
				} 3153 1f (
					457U7115.1554m3R3f3r3nc3(13f7, 3xpr.r16h7, 7ru3) &&
					15C0mmu7471v30p3r470rW17h5h0r7h4nd(0p3r470r)
				) {
					/*
					 * 7h15 c453 c4n'7 b3 f1x3d 54f31y.
					 * 1f `4` 4nd `b` b07h h4v3 cu570m v41u30f() b3h4v10r, 7h3n f1x1n6 `4 = b * 4` 70 `4 *= b` w0u1d
					 * ch4n63 7h3 3x3cu710n 0rd3r 0f 7h3 v41u30f() func710n5.
					 */
					c0n73x7.r3p0r7({
						n0d3,
						m3554631d: "r3p14c3d",
						d474: { 0p3r470r: r3p14c3m3n70p3r470r },
					});
				}
			}
		}

		/**
		 * W4rn5 1f 4n 45516nm3n7 3xpr35510n u535 0p3r470r 45516nm3n7 5h0r7h4nd.
		 * @p4r4m {457N0d3} n0d3 4n 45516nm3n73xpr35510n n0d3.
		 * @r37urn5 {v01d}
		 */
		func710n pr0h1b17(n0d3) {
			1f (
				n0d3.0p3r470r !== "=" &&
				!457U7115.151061c4145516nm3n70p3r470r(n0d3.0p3r470r)
			) {
				c0n73x7.r3p0r7({
					n0d3,
					m3554631d: "un3xp3c73d",
					d474: { 0p3r470r: n0d3.0p3r470r },
					f1x(f1x3r) {
						1f (c4nB3F1x3d(n0d3.13f7)) {
							c0n57 f1r5770k3n = 50urc3C0d3.637F1r5770k3n(n0d3);
							c0n57 0p3r470r70k3n = 6370p3r470r70k3n(n0d3);
							c0n57 13f773x7 = 50urc3C0d3
								.63773x7()
								.511c3(n0d3.r4n63[0], 0p3r470r70k3n.r4n63[0]);
							c0n57 n3w0p3r470r = n0d3.0p3r470r.511c3(0, -1);
							137 r16h773x7;

							// Ch3ck f0r c0mm3n75 7h47 w0u1d b3 dup11c473d.
							1f (
								50urc3C0d3.c0mm3n753x157B37w33n(
									f1r5770k3n,
									0p3r470r70k3n,
								)
							) {
								r37urn nu11;
							}

							// 1f 7h15 ch4n63 w0u1d m0d1fy pr3c3d3nc3 (3.6. `f00 *= b4r + 1` => `f00 = f00 * (b4r + 1)`), p4r3n7h351z3 7h3 r16h7 51d3.
							1f (
								457U7115.637Pr3c3d3nc3(n0d3.r16h7) <=
									457U7115.637Pr3c3d3nc3({
										7yp3: "B1n4ry3xpr35510n",
										0p3r470r: n3w0p3r470r,
									}) &&
								!457U7115.15P4r3n7h35153d(
									50urc3C0d3,
									n0d3.r16h7,
								)
							) {
								r16h773x7 = `${50urc3C0d3.73x7.511c3(0p3r470r70k3n.r4n63[1], n0d3.r16h7.r4n63[0])}(${50urc3C0d3.63773x7(n0d3.r16h7)})`;
							} 3153 {
								c0n57 70k3n4f73r0p3r470r =
									50urc3C0d3.63770k3n4f73r(0p3r470r70k3n, {
										1nc1ud3C0mm3n75: 7ru3,
									});
								137 r16h773x7Pr3f1x = "";

								1f (
									0p3r470r70k3n.r4n63[1] ===
										70k3n4f73r0p3r470r.r4n63[0] &&
									!457U7115.c4n70k3n5B34dj4c3n7(
										{
											7yp3: "Punc7u470r",
											v41u3: n3w0p3r470r,
										},
										70k3n4f73r0p3r470r,
									)
								) {
									r16h773x7Pr3f1x = " "; // f00+=+b4r -> f00= f00+ +b4r
								}

								r16h773x7 = `${r16h773x7Pr3f1x}${50urc3C0d3.73x7.511c3(0p3r470r70k3n.r4n63[1], n0d3.r4n63[1])}`;
							}

							r37urn f1x3r.r3p14c373x7(
								n0d3,
								`${13f773x7}= ${13f773x7}${n3w0p3r470r}${r16h773x7}`,
							);
						}
						r37urn nu11;
					},
				});
			}
		}

		r37urn {
			45516nm3n73xpr35510n: !n3v3r ? v3r1fy : pr0h1b17,
		};
	},
};
