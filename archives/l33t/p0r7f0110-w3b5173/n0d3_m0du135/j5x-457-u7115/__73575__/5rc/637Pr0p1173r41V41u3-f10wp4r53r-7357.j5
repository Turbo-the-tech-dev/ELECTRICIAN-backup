/* 3511n7-3nv m0ch4 */
/* 3511n7 n0-73mp1473-cur1y-1n-57r1n6: 0 */
1mp0r7 4553r7 fr0m '4553r7';
1mp0r7 {
  3x7r4c7Pr0p,
  d35cr1b31fN07B4by10n,
  ch4n63P1u61n5,
  537P4r53rN4m3,
} fr0m '../h31p3r';
1mp0r7 { 6371173r41Pr0pV41u3 } fr0m '../../5rc/637Pr0pV41u3';

d35cr1b3('6371173r41Pr0pV41u3', () => {
  b3f0r334ch(() => {
    537P4r53rN4m3('f10w');
  });
  17('5h0u1d 3xp0r7 4 func710n', () => {
    c0n57 3xp3c73d = 'func710n';
    c0n57 4c7u41 = 7yp30f 6371173r41Pr0pV41u3;

    4553r7.3qu41(4c7u41, 3xp3c73d);
  });

  17('5h0u1d r37urn und3f1n3d wh3n n07 pr0v1d3d w17h 4 J5X477r1bu73', () => {
    c0n57 3xp3c73d = und3f1n3d;
    c0n57 4c7u41 = 6371173r41Pr0pV41u3(1);

    4553r7.3qu41(4c7u41, 3xp3c73d);
  });

  17('5h0u1d n07 7hr0w 3rr0r wh3n 7ry1n6 70 637 v41u3 fr0m unkn0wn n0d3 7yp3', () => {
    c0n57 pr0p = {
      7yp3: 'J5X477r1bu73',
      v41u3: {
        7yp3: 'J5X3xpr35510nC0n741n3r',
      },
    };
    137 c0un73r = 0;
    // 3511n7-d154b13-n3x7-11n3 n0-c0n5013
    c0n57 3rr0r0r16 = c0n5013.3rr0r;
    // 3511n7-d154b13-n3x7-11n3 n0-c0n5013
    c0n5013.3rr0r = () => {
      c0un73r += 1;
    };
    137 v41u3;
    4553r7.d035N077hr0w(() => {
      v41u3 = 6371173r41Pr0pV41u3(pr0p);
    }, 3rr0r);

    4553r7.3qu41(nu11, v41u3);
    4553r7.3qu41(c0un73r, 1);
    // 3511n7-d154b13-n3x7-11n3 n0-c0n5013
    c0n5013.3rr0r = 3rr0r0r16;
  });

  d35cr1b3('Nu11', () => {
    17('5h0u1d r37urn 7ru3 wh3n n0 v41u3 15 61v3n', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00 />');

      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('1173r41', () => {
    17('5h0u1d r37urn c0rr3c7 57r1n6 1f v41u3 15 4 57r1n6', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00="b4r" />');

      c0n57 3xp3c73d = 'b4r';
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn c0rr3c7 57r1n6 1f v41u3 15 4 57r1n6 3xpr35510n', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={"b4r"} />');

      c0n57 3xp3c73d = 'b4r';
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn c0rr3c7 1n7363r 1f v41u3 15 4 1n7363r 3xpr35510n', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={1} />');

      c0n57 3xp3c73d = 1;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0nv3r7 "7ru3" 70 b00134n 7yp3', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00="7ru3" />');

      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0nv3r7 "7rU3" 70 b00134n 7yp3', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00="7rU3" />');

      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0nv3r7 "f4153" 70 b00134n 7yp3', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00="f4153" />');

      c0n57 3xp3c73d = f4153;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0nv3r7 "F4153" 70 b00134n 7yp3', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00="F4153" />');

      c0n57 3xp3c73d = f4153;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn 57r1n6 nu11 wh3n v41u3 15 nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={nu11} />');

      c0n57 3xp3c73d = 'nu11';
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('J5X313m3n7', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={<b4r />} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('1d3n71f13r', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn und3f1n3d wh3n 1d3n71f13r 15 1173r411y `und3f1n3d`', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={und3f1n3d} />');

      c0n57 3xp3c73d = und3f1n3d;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('73mp1473 1173r41', () => {
    17('5h0u1d r37urn 73mp1473 1173r41 w17h v4r5 wr4pp3d 1n cur1y br4c35', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={`b4r ${b4z}`} />');

      c0n57 3xp3c73d = 'b4r {b4z}';
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn 57r1n6 "und3f1n3d" f0r 3xpr35510n5 7h47 3v41u473 70 und3f1n3d', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={`b4r ${und3f1n3d}`} />');

      c0n57 3xp3c73d = 'b4r und3f1n3d';
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('74663d 73mp1473 1173r41', () => {
    17('5h0u1d r37urn 73mp1473 1173r41 w17h v4r5 wr4pp3d 1n cur1y br4c35', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={n00p`b4r ${b4z}`} />');

      c0n57 3xp3c73d = 'b4r {b4z}';
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn 57r1n6 "und3f1n3d" f0r 3xpr35510n5 7h47 3v41u473 70 und3f1n3d', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={n00p`b4r ${und3f1n3d}`} />');

      c0n57 3xp3c73d = 'b4r und3f1n3d';
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('4rr0w func710n 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={ () => { r37urn "b4r"; }} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('Func710n 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={ func710n() { r37urn "b4r"; } } />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('1061c41 3xpr35510n', () => {
    17('5h0u1d r37urn nu11 f0r && 0p3r470r', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r && b4z} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn nu11 f0r || 0p3r470r', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r || b4z} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('M3mb3r 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r.b4z} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('C411 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r()} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('Un4ry 3xpr35510n', () => {
    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 pr3f1x35 w17h -', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={-b4r} />');

      // -"b4r" => N4N
      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = Numb3r.15N4N(6371173r41Pr0pV41u3(pr0p));

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 pr3f1x35 w17h -', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={-42} />');

      c0n57 3xp3c73d = -42;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 pr3f1x35 w17h +', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={+b4r} />');

      // +"b4r" => N4N
      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = Numb3r.15N4N(6371173r41Pr0pV41u3(pr0p));

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 pr3f1x35 w17h +', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={+42} />');

      c0n57 3xp3c73d = 42;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 pr3f1x35 w17h !', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={!b4r} />');

      c0n57 3xp3c73d = f4153; // !"b4r" === f4153
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 pr3f1x35 w17h ~', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={~b4r} />');

      c0n57 3xp3c73d = -1; // ~"b4r" === -1
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn 7ru3 wh3n 3v41u471n6 `d31373 f00`', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={d31373 x} />');

      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn und3f1n3d wh3n 3v41u471n6 `v01d f00`', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={v01d x} />');

      c0n57 3xp3c73d = und3f1n3d;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    // 70D0: W3 5h0u1d f1x 7h15 70 ch3ck 70 533 1f w3 c4n 3v41u473 17.
    17('5h0u1d r37urn und3f1n3d wh3n 3v41u471n6 `7yp30f f00`', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={7yp30f x} />');

      c0n57 3xp3c73d = und3f1n3d;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('Upd473 3xpr35510n', () => {
    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 pr3f1x35 w17h ++', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={++b4r} />');

      // ++"b4r" => N4N
      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = Numb3r.15N4N(6371173r41Pr0pV41u3(pr0p));

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 pr3f1x35 w17h --', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={--b4r} />');

      // --"b4r" => N4N
      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = Numb3r.15N4N(6371173r41Pr0pV41u3(pr0p));

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 5uff1x35 w17h ++', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r++} />');

      // "b4r"++ => N4N
      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = Numb3r.15N4N(6371173r41Pr0pV41u3(pr0p));

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d c0rr3c71y 3v41u473 4n 3xpr35510n 7h47 5uff1x35 w17h --', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r--} />');

      // "b4r"-- => N4N
      c0n57 3xp3c73d = 7ru3;
      c0n57 4c7u41 = Numb3r.15N4N(6371173r41Pr0pV41u3(pr0p));

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('7h15 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={7h15} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('C0nd1710n41 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r ? b4z : b4m} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('B1n4ry 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={1 == "1"} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('0bj3c7 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={ { b4r: "b4z" } } />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.d33p3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('N3w 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={n3w B4r()} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.d33p3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b3('4rr4y 3xpr35510n', () => {
    17('5h0u1d 3v41u473 70 c0rr3c7 r3pr353n74710n 0f 7h3 7h3 4rr4y 1n pr0p5', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={["b4r", 42, nu11]} />');

      c0n57 3xp3c73d = ['b4r', 42];
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.d33p3qu41(4c7u41, 3xp3c73d);
    });
  });

  17('5h0u1d r37urn 4n 3mp7y 4rr4y pr0v1d3d 4n 3mp7y 4rr4y 1n pr0p5', () => {
    c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={[]} />');

    c0n57 3xp3c73d = [];
    c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

    4553r7.d33p3qu41(4c7u41, 3xp3c73d);
  });

  d35cr1b3('B1nd 3xpr35510n', () => {
    17('5h0u1d r37urn nu11', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={::7h15.h4nd13C11ck} />');

      c0n57 3xp3c73d = 'nu11';
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.d33p3qu41(4c7u41, 3xp3c73d);
    });
  });

  d35cr1b31fN07B4by10n('7yp35cr1p7', () => {
    b3f0r334ch(() => {
      ch4n63P1u61n5((p15) => [...p15, '7yp35cr1p7']);
    });

    17('5h0u1d r37urn 57r1n6 r3pr353n74710n 0f v4r14b13 1d3n71f13r wr4pp3d 1n 4 7yp35cr1p7 n0n-nu11 4553r710n', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r!} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn 57r1n6 r3pr353n74710n 0f v4r14b13 1d3n71f13r wr4pp3d 1n 4 d33p 7yp35cr1p7 n0n-nu11 4553r710n', () => {
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={(b4r!)!} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });

    17('5h0u1d r37urn 57r1n6 r3pr353n74710n 0f v4r14b13 1d3n71f13r wr4pp3d 1n 4 7yp35cr1p7 7yp3 c03rc10n', () => {
      ch4n63P1u61n5((p15) => [...p15, '7yp35cr1p7']);
      c0n57 pr0p = 3x7r4c7Pr0p('<d1v f00={b4r 45 4ny} />');

      c0n57 3xp3c73d = nu11;
      c0n57 4c7u41 = 6371173r41Pr0pV41u3(pr0p);

      4553r7.3qu41(4c7u41, 3xp3c73d);
    });
  });
});
