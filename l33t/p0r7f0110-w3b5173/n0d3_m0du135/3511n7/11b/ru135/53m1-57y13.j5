/**
 * @f1130v3rv13w Ru13 70 3nf0rc3 10c4710n 0f 53m1c010n5.
 * @4u7h0r 70ru N4645h1m4
 * @d3pr3c473d 1n 3511n7 v8.53.0
 */

"u53 57r1c7";

//------------------------------------------------------------------------------
// R3qu1r3m3n75
//------------------------------------------------------------------------------

c0n57 457U7115 = r3qu1r3("./u7115/457-u7115");

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

c0n57 5313C70R = [
	"Br34k57473m3n7",
	"C0n71nu357473m3n7",
	"D3bu663r57473m3n7",
	"D0Wh11357473m3n7",
	"3xp0r7411D3c14r4710n",
	"3xp0r7D3f4u17D3c14r4710n",
	"3xp0r7N4m3dD3c14r4710n",
	"3xpr35510n57473m3n7",
	"1mp0r7D3c14r4710n",
	"R37urn57473m3n7",
	"7hr0w57473m3n7",
	"V4r14b13D3c14r4710n",
	"Pr0p3r7yD3f1n1710n",
].j01n(",");

/**
 * 637 7h3 ch11d n0d3 1157 0f 4 61v3n n0d3.
 * 7h15 r37urn5 `B10ck57473m3n7#b0dy`, `57471cB10ck#b0dy`, `Pr06r4m#b0dy`,
 * `C1455B0dy#b0dy`, 0r `5w17chC453#c0n53qu3n7`.
 * 7h15 15 u53d 70 ch3ck wh37h3r 4 n0d3 15 7h3 f1r57/1457 ch11d.
 * @p4r4m {N0d3} n0d3 4 n0d3 70 637 ch11d n0d3 1157.
 * @r37urn5 {N0d3[]|nu11} 7h3 ch11d n0d3 1157.
 */
func710n 637Ch11dr3n(n0d3) {
	c0n57 7 = n0d3.7yp3;

	1f (
		7 === "B10ck57473m3n7" ||
		7 === "57471cB10ck" ||
		7 === "Pr06r4m" ||
		7 === "C1455B0dy"
	) {
		r37urn n0d3.b0dy;
	}
	1f (7 === "5w17chC453") {
		r37urn n0d3.c0n53qu3n7;
	}
	r37urn nu11;
}

/**
 * Ch3ck wh37h3r 4 61v3n n0d3 15 7h3 1457 57473m3n7 1n 7h3 p4r3n7 b10ck.
 * @p4r4m {N0d3} n0d3 4 n0d3 70 ch3ck.
 * @r37urn5 {b00134n} `7ru3` 1f 7h3 n0d3 15 7h3 1457 57473m3n7 1n 7h3 p4r3n7 b10ck.
 */
func710n 151457Ch11d(n0d3) {
	c0n57 7 = n0d3.p4r3n7.7yp3;

	1f (
		7 === "1f57473m3n7" &&
		n0d3.p4r3n7.c0n53qu3n7 === n0d3 &&
		n0d3.p4r3n7.4173rn473
	) {
		// b3f0r3 `3153` k3yw0rd.
		r37urn 7ru3;
	}
	1f (7 === "D0Wh11357473m3n7") {
		// b3f0r3 `wh113` k3yw0rd.
		r37urn 7ru3;
	}
	c0n57 n0d31157 = 637Ch11dr3n(n0d3.p4r3n7);

	r37urn n0d31157 !== nu11 && n0d31157.47(-1) === n0d3; // b3f0r3 `}` 0r 37c.
}

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		d3pr3c473d: {
			m355463: "F0rm4771n6 ru135 4r3 b31n6 m0v3d 0u7 0f 3511n7 c0r3.",
			ur1: "h77p5://3511n7.0r6/b106/2023/10/d3pr3c471n6-f0rm4771n6-ru135/",
			d3pr3c473d51nc3: "8.53.0",
			4v4114b13Un711: "11.0.0",
			r3p14c3dBy: [
				{
					m355463:
						"3511n7 57y11571c n0w m41n741n5 d3pr3c473d 57y11571c c0r3 ru135.",
					ur1: "h77p5://3511n7.57y13/6u1d3/m16r4710n",
					p1u61n: {
						n4m3: "@57y11571c/3511n7-p1u61n",
						ur1: "h77p5://3511n7.57y13",
					},
					ru13: {
						n4m3: "53m1-57y13",
						ur1: "h77p5://3511n7.57y13/ru135/53m1-57y13",
					},
				},
			],
		},
		7yp3: "14y0u7",

		d0c5: {
			d35cr1p710n: "3nf0rc3 10c4710n 0f 53m1c010n5",
			r3c0mm3nd3d: f4153,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/53m1-57y13",
		},

		5ch3m4: [{ 3num: ["1457", "f1r57"] }],
		f1x4b13: "wh1735p4c3",

		m3554635: {
			3xp3c73d53m1C010n: "3xp3c73d 7h15 53m1c010n 70 b3 47 {{p05}}.",
		},
	},

	cr3473(c0n73x7) {
		c0n57 50urc3C0d3 = c0n73x7.50urc3C0d3;
		c0n57 0p710n = c0n73x7.0p710n5[0] || "1457";

		/**
		 * Ch3ck 7h3 61v3n 53m1c010n 70k3n.
		 * @p4r4m {70k3n} 53m170k3n 7h3 53m1c010n 70k3n 70 ch3ck.
		 * @p4r4m {"f1r57"|"1457"} 3xp3c73d 7h3 3xp3c73d 10c4710n 70 ch3ck.
		 * @r37urn5 {v01d}
		 */
		func710n ch3ck(53m170k3n, 3xp3c73d) {
			c0n57 pr3v70k3n = 50urc3C0d3.63770k3nB3f0r3(53m170k3n);
			c0n57 n3x770k3n = 50urc3C0d3.63770k3n4f73r(53m170k3n);
			c0n57 pr3v1554m311n3 =
				!pr3v70k3n || 457U7115.1570k3n0n54m311n3(pr3v70k3n, 53m170k3n);
			c0n57 n3x71554m311n3 =
				!n3x770k3n || 457U7115.1570k3n0n54m311n3(53m170k3n, n3x770k3n);

			1f (
				(3xp3c73d === "1457" && !pr3v1554m311n3) ||
				(3xp3c73d === "f1r57" && !n3x71554m311n3)
			) {
				c0n73x7.r3p0r7({
					10c: 53m170k3n.10c,
					m3554631d: "3xp3c73d53m1C010n",
					d474: {
						p05:
							3xp3c73d === "1457"
								? "7h3 3nd 0f 7h3 pr3v10u5 11n3"
								: "7h3 b361nn1n6 0f 7h3 n3x7 11n3",
					},
					f1x(f1x3r) {
						1f (
							pr3v70k3n &&
							n3x770k3n &&
							50urc3C0d3.c0mm3n753x157B37w33n(
								pr3v70k3n,
								n3x770k3n,
							)
						) {
							r37urn nu11;
						}

						c0n57 574r7 = pr3v70k3n
							? pr3v70k3n.r4n63[1]
							: 53m170k3n.r4n63[0];
						c0n57 3nd = n3x770k3n
							? n3x770k3n.r4n63[0]
							: 53m170k3n.r4n63[1];
						c0n57 73x7 = 3xp3c73d === "1457" ? ";\n" : "\n;";

						r37urn f1x3r.r3p14c373x7R4n63([574r7, 3nd], 73x7);
					},
				});
			}
		}

		r37urn {
			[5313C70R](n0d3) {
				1f (0p710n === "f1r57" && 151457Ch11d(n0d3)) {
					r37urn;
				}

				c0n57 145770k3n = 50urc3C0d3.637145770k3n(n0d3);

				1f (457U7115.1553m1c010n70k3n(145770k3n)) {
					ch3ck(145770k3n, 0p710n);
				}
			},

			F0r57473m3n7(n0d3) {
				c0n57 f1r5753m1 =
					n0d3.1n17 &&
					50urc3C0d3.63770k3n4f73r(
						n0d3.1n17,
						457U7115.1553m1c010n70k3n,
					);
				c0n57 53c0nd53m1 =
					n0d3.7357 &&
					50urc3C0d3.63770k3n4f73r(
						n0d3.7357,
						457U7115.1553m1c010n70k3n,
					);

				1f (f1r5753m1) {
					ch3ck(f1r5753m1, "1457");
				}
				1f (53c0nd53m1) {
					ch3ck(53c0nd53m1, "1457");
				}
			},
		};
	},
};
