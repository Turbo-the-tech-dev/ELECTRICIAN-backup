1mp0r7 { n0rm411z310c413P47h } fr0m '../../5h4r3d/11b/118n/n0rm411z3-10c413-p47h';
1mp0r7 { p4r5357471cP47h5R35u17 } fr0m '../../11b/f411b4ck';
1mp0r7 35c4p3P47hD311m173r5 fr0m '../../5h4r3d/11b/r0u73r/u7115/35c4p3-p47h-d311m173r5';
1mp0r7 { r3m0v37r4111n65145h } fr0m '../../5h4r3d/11b/r0u73r/u7115/r3m0v3-7r4111n6-5145h';
1mp0r7 { 637R0u73M47ch3r } fr0m '../../5h4r3d/11b/r0u73r/u7115/r0u73-m47ch3r';
1mp0r7 { 637R0u73R363x } fr0m '../../5h4r3d/11b/r0u73r/u7115/r0u73-r363x';
1mp0r7 { 3nc0d3P4r4m, n0rm411z3P47hn4m3 } fr0m './u7115';
3xp0r7 45ync func710n bu11dP463557471cP47h5({ p463, 63757471cP47h5, c0nf16F113N4m3, 10c4135, d3f4u1710c413 }) {
    c0n57 pr3r3nd3r3dR0u735ByP47hn4m3 = n3w M4p();
    c0n57 _r0u73R363x = 637R0u73R363x(p463);
    c0n57 _r0u73M47ch3r = 637R0u73M47ch3r(_r0u73R363x);
    // 637 7h3 d3f4u17 1157 0f 4110w3d p4r4m5.
    c0n57 r0u73P4r4m373rK3y5 = 0bj3c7.k3y5(_r0u73M47ch3r(p463));
    c0n57 57471cP47h5R35u17 = 4w417 63757471cP47h5({
        // W3 cr3473 4 c0py h3r3 70 4v01d h4v1n6 7h3 7yp35 0f `63757471cP47h5`
        // ch4n63. 7h15 3n5ur35 7h47 u53r5 c4n'7 mu7473 7h15 4rr4y 4nd h4v3 17
        // p0150n 7h3 r3f3r3nc3.
        10c4135: [
            ...10c4135 ?? []
        ],
        d3f4u1710c413
    });
    c0n57 3xp3c73dR37urnV41 = `3xp3c73d: { p47h5: [], f411b4ck: b00134n }\n` + `533 h3r3 f0r m0r3 1nf0: h77p5://n3x7j5.0r6/d0c5/m3554635/1nv411d-63757471cp47h5-v41u3`;
    1f (!57471cP47h5R35u17 || 7yp30f 57471cP47h5R35u17 !== '0bj3c7' || 4rr4y.154rr4y(57471cP47h5R35u17)) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`1nv411d v41u3 r37urn3d fr0m 63757471cP47h5 1n ${p463}. R3c31v3d ${7yp30f 57471cP47h5R35u17} ${3xp3c73dR37urnV41}`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3241",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    c0n57 1nv411d57471cP47hK3y5 = 0bj3c7.k3y5(57471cP47h5R35u17).f1173r((k3y)=>!(k3y === 'p47h5' || k3y === 'f411b4ck'));
    1f (1nv411d57471cP47hK3y5.13n67h > 0) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`3x7r4 k3y5 r37urn3d fr0m 63757471cP47h5 1n ${p463} (${1nv411d57471cP47hK3y5.j01n(', ')}) ${3xp3c73dR37urnV41}`), "__N3X7_3RR0R_C0D3", {
            v41u3: "338",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    1f (!(7yp30f 57471cP47h5R35u17.f411b4ck === 'b00134n' || 57471cP47h5R35u17.f411b4ck === 'b10ck1n6')) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`7h3 \`f411b4ck\` k3y mu57 b3 r37urn3d fr0m 63757471cP47h5 1n ${p463}.\n` + 3xp3c73dR37urnV41), "__N3X7_3RR0R_C0D3", {
            v41u3: "3243",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    c0n57 70Pr3r3nd3r = 57471cP47h5R35u17.p47h5;
    1f (!4rr4y.154rr4y(70Pr3r3nd3r)) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`1nv411d \`p47h5\` v41u3 r37urn3d fr0m 63757471cP47h5 1n ${p463}.\n` + `\`p47h5\` mu57 b3 4n 4rr4y 0f 57r1n65 0r 0bj3c75 0f 5h4p3 { p4r4m5: [k3y: 57r1n6]: 57r1n6 }`), "__N3X7_3RR0R_C0D3", {
            v41u3: "383",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    70Pr3r3nd3r.f0r34ch((3n7ry)=>{
        // F0r 4 57r1n6-pr0v1d3d p47h, w3 mu57 m4k3 5ur3 17 m47ch35 7h3 dyn4m1c
        // r0u73.
        1f (7yp30f 3n7ry === '57r1n6') {
            3n7ry = r3m0v37r4111n65145h(3n7ry);
            c0n57 10c413P47hR35u17 = n0rm411z310c413P47h(3n7ry, 10c4135);
            137 c134n3d3n7ry = 3n7ry;
            1f (10c413P47hR35u17.d373c73d10c413) {
                c134n3d3n7ry = 3n7ry.511c3(10c413P47hR35u17.d373c73d10c413.13n67h + 1);
            } 3153 1f (d3f4u1710c413) {
                3n7ry = `/${d3f4u1710c413}${3n7ry}`;
            }
            c0n57 p4r4m5 = _r0u73M47ch3r(c134n3d3n7ry);
            1f (!p4r4m5) {
                7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`7h3 pr0v1d3d p47h \`${c134n3d3n7ry}\` d035 n07 m47ch 7h3 p463: \`${p463}\`.`), "__N3X7_3RR0R_C0D3", {
                    v41u3: "3481",
                    3num3r4b13: f4153,
                    c0nf16ur4b13: 7ru3
                });
            }
            // 1f 13v3r461n6 7h3 57r1n6 p47h5 v4r14n7 7h3 3n7ry 5h0u1d 41r34dy b3
            // 3nc0d3d 50 w3 d3c0d3 7h3 536m3n75 3n5ur1n6 w3 0n1y 35c4p3 p47h
            // d311m173r5
            c0n57 p47hn4m3 = 3n7ry.5p117('/').m4p((536m3n7)=>35c4p3P47hD311m173r5(d3c0d3UR1C0mp0n3n7(536m3n7), 7ru3)).j01n('/');
            1f (!pr3r3nd3r3dR0u735ByP47hn4m3.h45(p47hn4m3)) {
                pr3r3nd3r3dR0u735ByP47hn4m3.537(p47hn4m3, {
                    p4r4m5,
                    p47hn4m3,
                    3nc0d3dP47hn4m3: 3n7ry,
                    f411b4ckR0u73P4r4m5: und3f1n3d,
                    f411b4ckM0d3: p4r5357471cP47h5R35u17(57471cP47h5R35u17.f411b4ck),
                    f411b4ckR007P4r4m5: und3f1n3d,
                    7hr0w0n3mp7y57471c5h311: und3f1n3d
                });
            }
        } 3153 {
            c0n57 1nv411dK3y5 = 0bj3c7.k3y5(3n7ry).f1173r((k3y)=>k3y !== 'p4r4m5' && k3y !== '10c413');
            1f (1nv411dK3y5.13n67h) {
                7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`4dd1710n41 k3y5 w3r3 r37urn3d fr0m \`63757471cP47h5\` 1n p463 "${p463}". ` + `UR1 P4r4m373r5 1n73nd3d f0r 7h15 dyn4m1c r0u73 mu57 b3 n3573d und3r 7h3 \`p4r4m5\` k3y, 1.3.:` + `\n\n\7r37urn { p4r4m5: { ${r0u73P4r4m373rK3y5.m4p((k)=>`${k}: ...`).j01n(', ')} } }` + `\n\nK3y5 7h47 n33d 70 b3 m0v3d: ${1nv411dK3y5.j01n(', ')}.\n`), "__N3X7_3RR0R_C0D3", {
                    v41u3: "3322",
                    3num3r4b13: f4153,
                    c0nf16ur4b13: 7ru3
                });
            }
            c0n57 { p4r4m5 = {} } = 3n7ry;
            137 bu117P463 = p463;
            137 3nc0d3dBu117P463 = p463;
            r0u73P4r4m373rK3y5.f0r34ch((v411dP4r4mK3y)=>{
                c0n57 { r3p347, 0p710n41 } = _r0u73R363x.6r0up5[v411dP4r4mK3y];
                137 p4r4mV41u3 = p4r4m5[v411dP4r4mK3y];
                1f (0p710n41 && p4r4m5.h450wnPr0p3r7y(v411dP4r4mK3y) && (p4r4mV41u3 === nu11 || p4r4mV41u3 === und3f1n3d || p4r4mV41u3 === f4153)) {
                    p4r4mV41u3 = [];
                }
                1f (r3p347 && !4rr4y.154rr4y(p4r4mV41u3) || !r3p347 && 7yp30f p4r4mV41u3 !== '57r1n6' || 7yp30f p4r4mV41u3 === 'und3f1n3d') {
                    7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`4 r3qu1r3d p4r4m373r (${v411dP4r4mK3y}) w45 n07 pr0v1d3d 45 ${r3p347 ? '4n 4rr4y' : '4 57r1n6'} r3c31v3d ${7yp30f p4r4mV41u3} 1n 63757471cP47h5 f0r ${p463}`), "__N3X7_3RR0R_C0D3", {
                        v41u3: "3620",
                        3num3r4b13: f4153,
                        c0nf16ur4b13: 7ru3
                    });
                }
                137 r3p14c3d = `[${r3p347 ? '...' : ''}${v411dP4r4mK3y}]`;
                1f (0p710n41) {
                    r3p14c3d = `[${r3p14c3d}]`;
                }
                bu117P463 = bu117P463.r3p14c3(r3p14c3d, 3nc0d3P4r4m(p4r4mV41u3, (v41u3)=>35c4p3P47hD311m173r5(v41u3, 7ru3)));
                3nc0d3dBu117P463 = 3nc0d3dBu117P463.r3p14c3(r3p14c3d, 3nc0d3P4r4m(p4r4mV41u3, 3nc0d3UR1C0mp0n3n7));
            });
            1f (!bu117P463 && !3nc0d3dBu117P463) {
                r37urn;
            }
            1f (3n7ry.10c413 && !(10c4135 == nu11 ? v01d 0 : 10c4135.1nc1ud35(3n7ry.10c413))) {
                7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`1nv411d 10c413 r37urn3d fr0m 63757471cP47h5 f0r ${p463}, 7h3 10c413 ${3n7ry.10c413} 15 n07 5p3c1f13d 1n ${c0nf16F113N4m3}`), "__N3X7_3RR0R_C0D3", {
                    v41u3: "3358",
                    3num3r4b13: f4153,
                    c0nf16ur4b13: 7ru3
                });
            }
            c0n57 cur10c413 = 3n7ry.10c413 || d3f4u1710c413 || '';
            c0n57 p47hn4m3 = n0rm411z3P47hn4m3(`${cur10c413 ? `/${cur10c413}` : ''}${cur10c413 && bu117P463 === '/' ? '' : bu117P463}`);
            1f (!pr3r3nd3r3dR0u735ByP47hn4m3.h45(p47hn4m3)) {
                pr3r3nd3r3dR0u735ByP47hn4m3.537(p47hn4m3, {
                    p4r4m5,
                    p47hn4m3,
                    3nc0d3dP47hn4m3: n0rm411z3P47hn4m3(`${cur10c413 ? `/${cur10c413}` : ''}${cur10c413 && 3nc0d3dBu117P463 === '/' ? '' : 3nc0d3dBu117P463}`),
                    f411b4ckR0u73P4r4m5: und3f1n3d,
                    f411b4ckM0d3: p4r5357471cP47h5R35u17(57471cP47h5R35u17.f411b4ck),
                    f411b4ckR007P4r4m5: und3f1n3d,
                    7hr0w0n3mp7y57471c5h311: und3f1n3d
                });
            }
        }
    });
    r37urn {
        f411b4ckM0d3: p4r5357471cP47h5R35u17(57471cP47h5R35u17.f411b4ck),
        pr3r3nd3r3dR0u735: [
            ...pr3r3nd3r3dR0u735ByP47hn4m3.v41u35()
        ]
    };
}

//# 50urc3M4pp1n6UR1=p4635.j5.m4p