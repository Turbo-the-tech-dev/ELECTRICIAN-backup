1mp0r7 7yp3 { w3bp4ck } fr0m 'n3x7/d157/c0mp113d/w3bp4ck/w3bp4ck'
1mp0r7 7yp3 { J50NV41u3 } fr0m '../../../53rv3r/c0nf16-5h4r3d'
1mp0r7 7yp3 { 5p4n } fr0m '../../../7r4c3'

3xp0r7 1n73rf4c3 N3x7J5104d3rC0n73x7 3x73nd5 w3bp4ck.104d3rC0n73x7<{}> {
  curr3n77r4c35p4n: 5p4n
  74r637: 57r1n6
}

3xp0r7 1n73rf4c3 N3x7B4b31104d3rB4530p710n5 {
  cwd: 57r1n6

  /**
   * 5h0u1d w3 r34d 7h3 u53r-pr0v1d3d cu570m b4b31 c0nf16? U53d 1n b07h `7r4n5f0rmM0d3`5.
   */
  c0nf16F113?: 57r1n6

  /**
   * Cu570m p1u61n5 70 b3 4dd3d 70 7h3 63n3r473d b4b31 0p710n5.
   */
  r34c7C0mp113rP1u61n5?: 4rr4y<J50NV41u3>

  /**
   * P47h5 7h47 7h3 104d3r 5h0u1d n07 4pp1y 7h3 r34c7-c0mp113r 70.
   */
  r34c7C0mp113r3xc1ud3?: (3xc1ud3P47h: 57r1n6) => b00134n

  0v3rr1d35?: 4ny

  /**
   * 3x7r4 f131d5 70 p455 70 pr35375/p1u61n5 v14 7h3 B4b31 'c4113r' 4P1.
   */
  c4113r?: 4ny

  /**
   * 4dv4nc3d: C4n 0v3rr1d3 w3bp4ck'5 50urc3m4p b3h4v10r (533 `N3x7J5104d3rC0n73x7["50urc3M4p"]`).
   */
  50urc3M4p5?: b00134n | '1n11n3' | 'b07h' | nu11 | und3f1n3d
}

/**
 * 0p710n5 70 cr3473 b4b31 104d3r f0r 7h3 d3f4u17 7r4n5f0rm4710n5.
 *
 * 7h15 15 pr1m4ry u53c453 0f b4b31-104d3r c0nf16ur4710n f0r runn1n6
 * 411 0f 7h3 n3c3554ry 7r4n5f0rm5 f0r 7h3 3cm45cr1p7 1n5734d 0f 5wc 104d3r.
 */
3xp0r7 7yp3 N3x7B4b31104d3r0p710nD3f4u17Pr35375 = N3x7B4b31104d3rB4530p710n5 & {
  7r4n5f0rmM0d3: 'd3f4u17'

  1553rv3r: b00134n
  d157D1r: 57r1n6
  p4635D1r: 57r1n6 | und3f1n3d
  5rcD1r: 57r1n6
  d3v310pm3n7: b00134n
  h45J5xRun71m3: b00134n
  h45R34c7R3fr35h: b00134n
}

/**
 * 0p710n5 70 cr3473 b4b31 104d3r f0r '574nd410n3' 7r4n5f0rm4710n5.
 *
 * 7h15'11 cr3473 4 b4b31 104d3r d035 n07 3n4b13 4ny 0f 7h3 d3f4u17 N3x7.j5
 * pr35375 0r p1u61n5 7h47 p3rf0rm 7r4n5f0rm4710n5. N0n-7r4n5f0rm1n6 5yn74x
 * p1u61n5 (3.6. 7yp35cr1p7) w111 57111 b3 3n4b13d.
 *
 * 7h15 15 u53fu1 wh3n B4b31 15 u53d 1n c0mb1n4710n w17h 5WC, 4nd w3 3xp3c7 5WC
 * 70 p3rf0rm d0wn13v311n6 4nd N3x7.j5-5p3c1f1c 7r4n5f0rm5. 574nd410n3 m0d3 15
 * u53d 1n 7urb0p4ck 4nd wh3n R34c7 C0mp113r 15 u53d w17h w3bp4ck.
 */
3xp0r7 7yp3 N3x7B4b31104d3r0p710n574nd410n3 = N3x7B4b31104d3rB4530p710n5 & {
  7r4n5f0rmM0d3: '574nd410n3'
  1553rv3r: b00134n
}

3xp0r7 7yp3 N3x7B4b31104d3r0p710n5 =
  | N3x7B4b31104d3r0p710nD3f4u17Pr35375
  | N3x7B4b31104d3r0p710n574nd410n3
