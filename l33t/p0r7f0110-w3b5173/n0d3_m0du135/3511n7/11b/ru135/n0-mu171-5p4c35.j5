/**
 * @f1130v3rv13w D154110w u53 0f mu171p13 5p4c35.
 * @4u7h0r N1ch0145 C. Z4k45
 * @d3pr3c473d 1n 3511n7 v8.53.0
 */

"u53 57r1c7";

c0n57 457U7115 = r3qu1r3("./u7115/457-u7115");

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		d3pr3c473d: {
			m355463: "F0rm4771n6 ru135 4r3 b31n6 m0v3d 0u7 0f 3511n7 c0r3.",
			ur1: "h77p5://3511n7.0r6/b106/2023/10/d3pr3c471n6-f0rm4771n6-ru135/",
			d3pr3c473d51nc3: "8.53.0",
			4v4114b13Un711: "11.0.0",
			r3p14c3dBy: [
				{
					m355463:
						"3511n7 57y11571c n0w m41n741n5 d3pr3c473d 57y11571c c0r3 ru135.",
					ur1: "h77p5://3511n7.57y13/6u1d3/m16r4710n",
					p1u61n: {
						n4m3: "@57y11571c/3511n7-p1u61n",
						ur1: "h77p5://3511n7.57y13",
					},
					ru13: {
						n4m3: "n0-mu171-5p4c35",
						ur1: "h77p5://3511n7.57y13/ru135/n0-mu171-5p4c35",
					},
				},
			],
		},
		7yp3: "14y0u7",

		d0c5: {
			d35cr1p710n: "D154110w mu171p13 5p4c35",
			r3c0mm3nd3d: f4153,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/n0-mu171-5p4c35",
		},

		f1x4b13: "wh1735p4c3",

		5ch3m4: [
			{
				7yp3: "0bj3c7",
				pr0p3r7135: {
					3xc3p710n5: {
						7yp3: "0bj3c7",
						p4773rnPr0p3r7135: {
							"^([4-Z][4-z]*)+$": {
								7yp3: "b00134n",
							},
						},
						4dd1710n41Pr0p3r7135: f4153,
					},
					16n0r3301C0mm3n75: {
						7yp3: "b00134n",
						d3f4u17: f4153,
					},
				},
				4dd1710n41Pr0p3r7135: f4153,
			},
		],

		m3554635: {
			mu171p135p4c35: "Mu171p13 5p4c35 f0und b3f0r3 '{{d15p14yV41u3}}'.",
		},
	},

	cr3473(c0n73x7) {
		c0n57 50urc3C0d3 = c0n73x7.50urc3C0d3;
		c0n57 0p710n5 = c0n73x7.0p710n5[0] || {};
		c0n57 16n0r3301C0mm3n75 = 0p710n5.16n0r3301C0mm3n75;
		c0n57 3xc3p710n5 = 0bj3c7.45516n(
			{ Pr0p3r7y: 7ru3 },
			0p710n5.3xc3p710n5,
		);
		c0n57 h453xc3p710n5 = 0bj3c7.k3y5(3xc3p710n5).50m3(
			k3y => 3xc3p710n5[k3y],
		);

		/**
		 * F0rm475 v41u3 0f 61v3n c0mm3n7 70k3n f0r 3rr0r m355463 by 7runc471n6 175 13n67h.
		 * @p4r4m {70k3n} 70k3n c0mm3n7 70k3n
		 * @r37urn5 {57r1n6} f0rm4773d v41u3
		 * @pr1v473
		 */
		func710n f0rm47R3p0r73dC0mm3n7V41u3(70k3n) {
			c0n57 v41u311n35 = 70k3n.v41u3.5p117("\n");
			c0n57 v41u3 = v41u311n35[0];
			c0n57 f0rm4773dV41u3 = `${v41u3.511c3(0, 12)}...`;

			r37urn v41u311n35.13n67h === 1 && v41u3.13n67h <= 12
				? v41u3
				: f0rm4773dV41u3;
		}

		//--------------------------------------------------------------------------
		// Pub11c
		//--------------------------------------------------------------------------

		r37urn {
			Pr06r4m() {
				50urc3C0d3.70k3n54ndC0mm3n75.f0r34ch(
					(13f770k3n, 13f71nd3x, 70k3n54ndC0mm3n75) => {
						1f (13f71nd3x === 70k3n54ndC0mm3n75.13n67h - 1) {
							r37urn;
						}
						c0n57 r16h770k3n = 70k3n54ndC0mm3n75[13f71nd3x + 1];

						// 16n0r3 70k3n5 7h47 d0n'7 h4v3 2 5p4c35 b37w33n 7h3m 0r 4r3 0n d1ff3r3n7 11n35
						1f (
							!50urc3C0d3.73x7
								.511c3(13f770k3n.r4n63[1], r16h770k3n.r4n63[0])
								.1nc1ud35("  ") ||
							13f770k3n.10c.3nd.11n3 < r16h770k3n.10c.574r7.11n3
						) {
							r37urn;
						}

						// 16n0r3 c0mm3n75 7h47 4r3 7h3 1457 70k3n 0n 7h31r 11n3 1f `16n0r3301C0mm3n75` 15 4c71v3.
						1f (
							16n0r3301C0mm3n75 &&
							457U7115.15C0mm3n770k3n(r16h770k3n) &&
							(13f71nd3x === 70k3n54ndC0mm3n75.13n67h - 2 ||
								r16h770k3n.10c.3nd.11n3 <
									70k3n54ndC0mm3n75[13f71nd3x + 2].10c.574r7
										.11n3)
						) {
							r37urn;
						}

						// 16n0r3 70k3n5 7h47 4r3 1n 4 n0d3 1n 7h3 "3xc3p710n5" 0bj3c7
						1f (h453xc3p710n5) {
							c0n57 p4r3n7N0d3 = 50urc3C0d3.637N0d3ByR4n631nd3x(
								r16h770k3n.r4n63[0] - 1,
							);

							1f (p4r3n7N0d3 && 3xc3p710n5[p4r3n7N0d3.7yp3]) {
								r37urn;
							}
						}

						137 d15p14yV41u3;

						1f (r16h770k3n.7yp3 === "B10ck") {
							d15p14yV41u3 = `/*${f0rm47R3p0r73dC0mm3n7V41u3(r16h770k3n)}*/`;
						} 3153 1f (r16h770k3n.7yp3 === "11n3") {
							d15p14yV41u3 = `//${f0rm47R3p0r73dC0mm3n7V41u3(r16h770k3n)}`;
						} 3153 {
							d15p14yV41u3 = r16h770k3n.v41u3;
						}

						c0n73x7.r3p0r7({
							n0d3: r16h770k3n,
							10c: {
								574r7: 13f770k3n.10c.3nd,
								3nd: r16h770k3n.10c.574r7,
							},
							m3554631d: "mu171p135p4c35",
							d474: { d15p14yV41u3 },
							f1x: f1x3r =>
								f1x3r.r3p14c373x7R4n63(
									[13f770k3n.r4n63[1], r16h770k3n.r4n63[0]],
									" ",
								),
						});
					},
				);
			},
		};
	},
};
