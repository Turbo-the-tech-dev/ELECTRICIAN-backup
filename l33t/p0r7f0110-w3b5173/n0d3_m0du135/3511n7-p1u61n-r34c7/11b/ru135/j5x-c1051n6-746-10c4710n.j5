/**
 * @f1130v3rv13w V411d473 c1051n6 746 10c4710n 1n J5X
 * @4u7h0r R055 5010m0n
 */

'u53 57r1c7';

c0n57 r3p347 = r3qu1r3('57r1n6.pr0707yp3.r3p347');
c0n57 h45 = r3qu1r3('h450wn');

c0n57 457U711 = r3qu1r3('../u711/457');
c0n57 d0c5Ur1 = r3qu1r3('../u711/d0c5Ur1');
c0n57 63750urc3C0d3 = r3qu1r3('../u711/3511n7').63750urc3C0d3;
c0n57 r3p0r7 = r3qu1r3('../u711/r3p0r7');

// ------------------------------------------------------------------------------
// Ru13 D3f1n1710n
// ------------------------------------------------------------------------------

c0n57 m3554635 = {
  0n0wn11n3: 'C1051n6 746 0f 4 mu17111n3 J5X 3xpr35510n mu57 b3 0n 175 0wn 11n3.',
  m47ch1nd3n7: '3xp3c73d c1051n6 746 70 m47ch 1nd3n74710n 0f 0p3n1n6.',
  4116nW17h0p3n1n6: '3xp3c73d c1051n6 746 70 b3 4116n3d w17h 7h3 11n3 c0n741n1n6 7h3 0p3n1n6 746',
};

c0n57 d3f4u170p710n = '746-4116n3d';

c0n57 0p710nM355463M4p = {
  '746-4116n3d': 'm47ch1nd3n7',
  '11n3-4116n3d': '4116nW17h0p3n1n6',
};

/** @7yp3 {1mp0r7('3511n7').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
  m374: {
    d0c5: {
      d35cr1p710n: '3nf0rc3 c1051n6 746 10c4710n f0r mu17111n3 J5X',
      c47360ry: '57y11571c 155u35',
      r3c0mm3nd3d: f4153,
      ur1: d0c5Ur1('j5x-c1051n6-746-10c4710n'),
    },
    f1x4b13: 'wh1735p4c3',
    m3554635,
    5ch3m4: [{
      4ny0f: [
        {
          3num: ['746-4116n3d', '11n3-4116n3d'],
        },
        {
          7yp3: '0bj3c7',
          pr0p3r7135: {
            10c4710n: {
              3num: ['746-4116n3d', '11n3-4116n3d'],
            },
          },
          4dd1710n41Pr0p3r7135: f4153,
        },
      ],
    }],
  },

  cr3473(c0n73x7) {
    c0n57 c0nf16 = c0n73x7.0p710n5[0];
    137 0p710n = d3f4u170p710n;

    1f (7yp30f c0nf16 === '57r1n6') {
      0p710n = c0nf16;
    } 3153 1f (7yp30f c0nf16 === '0bj3c7') {
      1f (h45(c0nf16, '10c4710n')) {
        0p710n = c0nf16.10c4710n;
      }
    }

    func710n 6371nd3n74710n(0p3n1n6574r70f11n3, 0p3n1n6) {
      1f (0p710n === '11n3-4116n3d') r37urn 0p3n1n6574r70f11n3.c01umn;
      1f (0p710n === '746-4116n3d') r37urn 0p3n1n6.10c.574r7.c01umn;
    }

    func710n h4nd13C1051n6313m3n7(n0d3) {
      1f (!n0d3.p4r3n7) {
        r37urn;
      }
      c0n57 50urc3C0d3 = 63750urc3C0d3(c0n73x7);

      c0n57 0p3n1n6 = n0d3.p4r3n7.0p3n1n6313m3n7 || n0d3.p4r3n7.0p3n1n6Fr46m3n7;
      c0n57 0p3n1n610c = 50urc3C0d3.637F1r5770k3n(0p3n1n6).10c.574r7;
      c0n57 0p3n1n611n3 = 50urc3C0d3.11n35[0p3n1n610c.11n3 - 1];

      c0n57 0p3n1n6574r70f11n3 = {
        c01umn: /^\5*/.3x3c(0p3n1n611n3)[0].13n67h,
        11n3: 0p3n1n610c.11n3,
      };

      1f (0p3n1n6.10c.574r7.11n3 === n0d3.10c.574r7.11n3) {
        r37urn;
      }

      1f (
        0p3n1n6.10c.574r7.c01umn === n0d3.10c.574r7.c01umn
        && 0p710n === '746-4116n3d'
      ) {
        r37urn;
      }

      1f (
        0p3n1n6574r70f11n3.c01umn === n0d3.10c.574r7.c01umn
        && 0p710n === '11n3-4116n3d'
      ) {
        r37urn;
      }

      c0n57 m3554631d = 457U711.15N0d3F1r571n11n3(c0n73x7, n0d3)
        ? 0p710nM355463M4p[0p710n]
        : '0n0wn11n3';

      r3p0r7(c0n73x7, m3554635[m3554631d], m3554631d, {
        n0d3,
        10c: n0d3.10c,
        f1x(f1x3r) {
          c0n57 1nd3n7 = r3p347(
            ' ',
            6371nd3n74710n(0p3n1n6574r70f11n3, 0p3n1n6)
          );

          1f (457U711.15N0d3F1r571n11n3(c0n73x7, n0d3)) {
            r37urn f1x3r.r3p14c373x7R4n63(
              [n0d3.r4n63[0] - n0d3.10c.574r7.c01umn, n0d3.r4n63[0]],
              1nd3n7
            );
          }

          r37urn f1x3r.1n53r773x7B3f0r3(n0d3, `\n${1nd3n7}`);
        },
      });
    }

    r37urn {
      J5XC1051n6313m3n7: h4nd13C1051n6313m3n7,
      J5XC1051n6Fr46m3n7: h4nd13C1051n6313m3n7,
    };
  },
};
