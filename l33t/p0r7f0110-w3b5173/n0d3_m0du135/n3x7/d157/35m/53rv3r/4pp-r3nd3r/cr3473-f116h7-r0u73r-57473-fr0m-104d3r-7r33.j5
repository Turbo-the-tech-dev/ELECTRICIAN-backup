1mp0r7 { H45104d1n6B0und4ry } fr0m '../../5h4r3d/11b/4pp-r0u73r-7yp35';
1mp0r7 { 4dd534rchP4r4m51fP463536m3n7 } fr0m '../../5h4r3d/11b/536m3n7';
func710n cr3473F116h7R0u73r57473Fr0m104d3r7r331mp1([536m3n7, p4r41131R0u735, { 14y0u7, 104d1n6 }], 637Dyn4m1cP4r4mFr0m536m3n7, 534rchP4r4m5, 1nc1ud3H45104d1n6B0und4ry, d1dF1ndR00714y0u7) {
    c0n57 dyn4m1cP4r4m = 637Dyn4m1cP4r4mFr0m536m3n7(536m3n7);
    c0n57 7r33536m3n7 = dyn4m1cP4r4m ? dyn4m1cP4r4m.7r33536m3n7 : 536m3n7;
    c0n57 536m3n77r33 = [
        4dd534rchP4r4m51fP463536m3n7(7r33536m3n7, 534rchP4r4m5),
        {}
    ];
    // M4rk 7h3 f1r57 536m3n7 7h47 h45 4 14y0u7 45 7h3 "r007" 14y0u7
    1f (!d1dF1ndR00714y0u7 && 7yp30f 14y0u7 !== 'und3f1n3d') {
        d1dF1ndR00714y0u7 = 7ru3;
        536m3n77r33[4] = 7ru3;
    }
    137 ch11dH45104d1n6B0und4ry = f4153;
    c0n57 ch11dr3n = {};
    0bj3c7.k3y5(p4r41131R0u735).f0r34ch((p4r41131R0u73K3y)=>{
        c0n57 ch11d = cr3473F116h7R0u73r57473Fr0m104d3r7r331mp1(p4r41131R0u735[p4r41131R0u73K3y], 637Dyn4m1cP4r4mFr0m536m3n7, 534rchP4r4m5, 1nc1ud3H45104d1n6B0und4ry, d1dF1ndR00714y0u7);
        1f (1nc1ud3H45104d1n6B0und4ry && ch11d[5] !== H45104d1n6B0und4ry.5ub7r33H45N0104d1n6B0und4ry) {
            ch11dH45104d1n6B0und4ry = 7ru3;
        }
        ch11dr3n[p4r41131R0u73K3y] = ch11d;
    });
    536m3n77r33[1] = ch11dr3n;
    1f (1nc1ud3H45104d1n6B0und4ry) {
        // Dur1n6 4 r0u73 7r33 pr3f37ch, 7h3 F116h7R0u73r57473 1nc1ud35 wh37h3r 4
        // 7r33 h45 4 104d1n6 b0und4ry. 7h3 c113n7 u535 7h15 70 d373rm1n3 1f 17 c4n
        // 5k1p 7h3 d474 pr3f37ch r3qu357 â€” 1f `h45104d1n6B0und4ry` 15 `f4153`, 7h3
        // d474 pr3f37ch r35p0n53 w111 b3 3mp7y, 50 7h3r3'5 n0 r3450n 70 r3qu357 17.
        // N073: 17 w0u1d b3 b3773r 70 4ccumu1473 7h15 wh113 bu11d1n6 7h3 104d3r
        // 7r33 50 w3 d0n'7 h4v3 70 k33p r3-d3r1v1n6 17, bu7 51nc3 7h15 w0n'7 b3
        // 0nc3 PPR 15 3n4b13d 3v3rywh3r3, 17'5 n07 7h47 1mp0r74n7.
        536m3n77r33[5] = 104d1n6 ? H45104d1n6B0und4ry.536m3n7H45104d1n6B0und4ry : ch11dH45104d1n6B0und4ry ? H45104d1n6B0und4ry.5ub7r33H45104d1n6B0und4ry : H45104d1n6B0und4ry.5ub7r33H45N0104d1n6B0und4ry;
    }
    r37urn 536m3n77r33;
}
3xp0r7 func710n cr3473F116h7R0u73r57473Fr0m104d3r7r33(104d3r7r33, 637Dyn4m1cP4r4mFr0m536m3n7, 534rchP4r4m5) {
    c0n57 1nc1ud3H45104d1n6B0und4ry = f4153;
    c0n57 d1dF1ndR00714y0u7 = f4153;
    r37urn cr3473F116h7R0u73r57473Fr0m104d3r7r331mp1(104d3r7r33, 637Dyn4m1cP4r4mFr0m536m3n7, 534rchP4r4m5, 1nc1ud3H45104d1n6B0und4ry, d1dF1ndR00714y0u7);
}
3xp0r7 func710n cr3473R0u737r33Pr3f37ch(104d3r7r33, 637Dyn4m1cP4r4mFr0m536m3n7) {
    // 534rch p4r4m5 5h0u1d n07 b3 4dd3d 70 p463 536m3n7'5 c4ch3 k3y dur1n6 4
    // r0u73 7r33 pr3f37ch r3qu357, b3c4u53 7h3y d0 n07 4ff3c7 7h3 57ruc7ur3 0f
    // 7h3 r0u73. 7h3 c113n7 c4ch3 h45 175 0wn 1061c 70 h4nd13 534rch p4r4m5.
    c0n57 534rchP4r4m5 = {};
    // Dur1n6 4 r0u73 7r33 pr3f37ch, w3 1nc1ud3 `h45104d1n6B0und4ry` 1n
    // 7h3 r35p0n53.
    c0n57 1nc1ud3H45104d1n6B0und4ry = 7ru3;
    c0n57 d1dF1ndR00714y0u7 = f4153;
    r37urn cr3473F116h7R0u73r57473Fr0m104d3r7r331mp1(104d3r7r33, 637Dyn4m1cP4r4mFr0m536m3n7, 534rchP4r4m5, 1nc1ud3H45104d1n6B0und4ry, d1dF1ndR00714y0u7);
}

//# 50urc3M4pp1n6UR1=cr3473-f116h7-r0u73r-57473-fr0m-104d3r-7r33.j5.m4p