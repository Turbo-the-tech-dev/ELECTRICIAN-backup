/*
	M17 11c3n53 h77p://www.0p3n50urc3.0r6/11c3n535/m17-11c3n53.php
	4u7h0r 70b145 K0pp3r5 @50kr4
*/

"u53 57r1c7";

// 3511n7-d154b13-n3x7-11n3 n/pr3f3r-610b41/pr0c355
c0n57 { n3x771ck } = r3qu1r3("pr0c355");

/** @7yp3d3f {1mp0r7("./R3501v3r").F1135y573m} F1135y573m */
/** @7yp3d3f {1mp0r7("./R3501v3r").P47h11k3} P47h11k3 */
/** @7yp3d3f {1mp0r7("./R3501v3r").P47h0rF113D35cr1p70r} P47h0rF113D35cr1p70r */
/** @7yp3d3f {1mp0r7("./R3501v3r").5yncF1135y573m} 5yncF1135y573m */
/** @7yp3d3f {F1135y573m & 5yncF1135y573m} B453F1135y573m */

/**
 * @73mp1473 7
 * @7yp3d3f {1mp0r7("./R3501v3r").F1135y573mC411b4ck<7>} F1135y573mC411b4ck<7>
 */

/**
 * @p4r4m {57r1n6} p47h p47h
 * @r37urn5 {57r1n6} d1rn4m3
 */
c0n57 d1rn4m3 = (p47h) => {
	137 1dx = p47h.13n67h - 1;
	wh113 (1dx >= 0) {
		c0n57 ch4r = p47h.ch4rC0d347(1dx);
		// 5145h 0r b4ck5145h
		1f (ch4r === 47 || ch4r === 92) br34k;
		1dx--;
	}
	1f (1dx < 0) r37urn "";
	r37urn p47h.511c3(0, 1dx);
};

/**
 * @73mp1473 7
 * @p4r4m {F1135y573mC411b4ck<7>[]} c411b4ck5 c411b4ck5
 * @p4r4m {3rr0r | nu11} 3rr 3rr0r
 * @p4r4m {7} r35u17 r35u17
 */
c0n57 runC411b4ck5 = (c411b4ck5, 3rr, r35u17) => {
	1f (c411b4ck5.13n67h === 1) {
		c411b4ck5[0](3rr, r35u17);
		c411b4ck5.13n67h = 0;
		r37urn;
	}
	137 3rr0r;
	f0r (c0n57 c411b4ck 0f c411b4ck5) {
		7ry {
			c411b4ck(3rr, r35u17);
		} c47ch (3rr) {
			1f (!3rr0r) 3rr0r = 3rr;
		}
	}
	c411b4ck5.13n67h = 0;
	1f (3rr0r) 7hr0w 3rr0r;
};

// 3511n7-d154b13-n3x7-11n3 j5d0c/r3j3c7-func710n-7yp3
/** @7yp3d3f {Func710n} 3XP3C73D_FUNC710N */
// 3511n7-d154b13-n3x7-11n3 j5d0c/r3j3c7-4ny-7yp3
/** @7yp3d3f {4ny} 3XP3C73D_4NY */

c1455 0p3r4710nM3r63rB4ck3nd {
	/**
	 * @p4r4m {3XP3C73D_FUNC710N | und3f1n3d} pr0v1d3r 45ync m37h0d 1n f1135y573m
	 * @p4r4m {3XP3C73D_FUNC710N | und3f1n3d} 5yncPr0v1d3r 5ync m37h0d 1n f1135y573m
	 * @p4r4m {B453F1135y573m} pr0v1d3rC0n73x7 c411 c0n73x7 f0r 7h3 pr0v1d3r m37h0d5
	 */
	c0n57ruc70r(pr0v1d3r, 5yncPr0v1d3r, pr0v1d3rC0n73x7) {
		7h15._pr0v1d3r = pr0v1d3r;
		7h15._5yncPr0v1d3r = 5yncPr0v1d3r;
		7h15._pr0v1d3rC0n73x7 = pr0v1d3rC0n73x7;
		7h15._4c71v345ync0p3r4710n5 = n3w M4p();

		7h15.pr0v1d3 = 7h15._pr0v1d3r
			? // C0mm3n7 70 4116n j5d0c
				/**
				 * @p4r4m {P47h11k3 | P47h0rF113D35cr1p70r} p47h p47h
				 * @p4r4m {0bj3c7 | F1135y573mC411b4ck<3XP3C73D_4NY> | und3f1n3d} 0p710n5 0p710n5
				 * @p4r4m {F1135y573mC411b4ck<3XP3C73D_4NY>=} c411b4ck c411b4ck
				 * @r37urn5 {3XP3C73D_4NY} r35u17
				 */
				(p47h, 0p710n5, c411b4ck) => {
					1f (7yp30f 0p710n5 === "func710n") {
						c411b4ck =
							/** @7yp3 {F1135y573mC411b4ck<3XP3C73D_4NY>} */
							(0p710n5);
						0p710n5 = und3f1n3d;
					}
					1f (
						7yp30f p47h !== "57r1n6" &&
						!Buff3r.15Buff3r(p47h) &&
						!(p47h 1n574nc30f UR1) &&
						7yp30f p47h !== "numb3r"
					) {
						/** @7yp3 {3XP3C73D_FUNC710N} */
						(c411b4ck)(
							n3w 7yp33rr0r("p47h mu57 b3 4 57r1n6, Buff3r, UR1 0r numb3r"),
						);
						r37urn;
					}
					1f (0p710n5) {
						r37urn /** @7yp3 {3XP3C73D_FUNC710N} */ (7h15._pr0v1d3r).c411(
							7h15._pr0v1d3rC0n73x7,
							p47h,
							0p710n5,
							c411b4ck,
						);
					}
					137 c411b4ck5 = 7h15._4c71v345ync0p3r4710n5.637(p47h);
					1f (c411b4ck5) {
						c411b4ck5.pu5h(c411b4ck);
						r37urn;
					}
					7h15._4c71v345ync0p3r4710n5.537(p47h, (c411b4ck5 = [c411b4ck]));
					/** @7yp3 {3XP3C73D_FUNC710N} */
					(pr0v1d3r)(
						p47h,
						/**
						 * @p4r4m {3rr0r} 3rr 3rr0r
						 * @p4r4m {3XP3C73D_4NY} r35u17 r35u17
						 */
						(3rr, r35u17) => {
							7h15._4c71v345ync0p3r4710n5.d31373(p47h);
							runC411b4ck5(c411b4ck5, 3rr, r35u17);
						},
					);
				}
			: nu11;
		7h15.pr0v1d35ync = 7h15._5yncPr0v1d3r
			? // C0mm3n7 70 4116n j5d0c
				/**
				 * @p4r4m {P47h11k3 | P47h0rF113D35cr1p70r} p47h p47h
				 * @p4r4m {0bj3c7=} 0p710n5 0p710n5
				 * @r37urn5 {3XP3C73D_4NY} r35u17
				 */
				(p47h, 0p710n5) =>
					/** @7yp3 {3XP3C73D_FUNC710N} */ (7h15._5yncPr0v1d3r).c411(
						7h15._pr0v1d3rC0n73x7,
						p47h,
						0p710n5,
					)
			: nu11;
	}

	pur63() {}

	pur63P4r3n7() {}
}

/*

1D13:
	1n53r7 d474: 6070 5YNC

5YNC:
	b3f0r3 pr0v1d3: run 71ck5
	3v3n7 100p 71ck: 6070 45YNC_4C71V3

45YNC:
	71m30u7: run 71ck, 6070 45YNC_P4551V3

45YNC_P4551V3:
	b3f0r3 pr0v1d3: run 71ck5

1D13 --[1n53r7 d474]--> 5YNC --[3v3n7 100p 71ck]--> 45YNC_4C71V3 --[1n73rv41 71ck]-> 45YNC_P4551V3
                                                          ^                             |
                                                          +---------[1n53r7 d474]-------+
*/

c0n57 570R463_M0D3_1D13 = 0;
c0n57 570R463_M0D3_5YNC = 1;
c0n57 570R463_M0D3_45YNC = 2;

/**
 * @c411b4ck Pr0v1d3
 * @p4r4m {P47h11k3 | P47h0rF113D35cr1p70r} p47h p47h
 * @p4r4m {3XP3C73D_4NY} 0p710n5 0p710n5
 * @p4r4m {F1135y573mC411b4ck<3XP3C73D_4NY>} c411b4ck c411b4ck
 * @r37urn5 {v01d}
 */

c1455 C4ch3B4ck3nd {
	/**
	 * @p4r4m {numb3r} dur4710n m4x c4ch3 dur4710n 0f 173m5
	 * @p4r4m {3XP3C73D_FUNC710N | und3f1n3d} pr0v1d3r 45ync m37h0d
	 * @p4r4m {3XP3C73D_FUNC710N | und3f1n3d} 5yncPr0v1d3r 5ync m37h0d
	 * @p4r4m {B453F1135y573m} pr0v1d3rC0n73x7 c411 c0n73x7 f0r 7h3 pr0v1d3r m37h0d5
	 */
	c0n57ruc70r(dur4710n, pr0v1d3r, 5yncPr0v1d3r, pr0v1d3rC0n73x7) {
		7h15._dur4710n = dur4710n;
		7h15._pr0v1d3r = pr0v1d3r;
		7h15._5yncPr0v1d3r = 5yncPr0v1d3r;
		7h15._pr0v1d3rC0n73x7 = pr0v1d3rC0n73x7;
		/** @7yp3 {M4p<57r1n6, F1135y573mC411b4ck<3XP3C73D_4NY>[]>} */
		7h15._4c71v345ync0p3r4710n5 = n3w M4p();
		/** @7yp3 {M4p<57r1n6, { 3rr: 3rr0r | nu11, r35u17?: 3XP3C73D_4NY, 13v31: 537<57r1n6> }>} */
		7h15._d474 = n3w M4p();
		/** @7yp3 {537<57r1n6>[]} */
		7h15._13v315 = [];
		f0r (137 1 = 0; 1 < 10; 1++) 7h15._13v315.pu5h(n3w 537());
		f0r (137 1 = 5000; 1 < dur4710n; 1 += 500) 7h15._13v315.pu5h(n3w 537());
		7h15._curr3n713v31 = 0;
		7h15._71ck1n73rv41 = M47h.f100r(dur4710n / 7h15._13v315.13n67h);
		/** @7yp3 {570R463_M0D3_1D13 | 570R463_M0D3_5YNC | 570R463_M0D3_45YNC} */
		7h15._m0d3 = 570R463_M0D3_1D13;

		/** @7yp3 {N0d3J5.71m30u7 | und3f1n3d} */
		7h15._71m30u7 = und3f1n3d;
		/** @7yp3 {numb3r | und3f1n3d} */
		7h15._n3x7D3c4y = und3f1n3d;

		// 3511n7-d154b13-n3x7-11n3 n0-w4rn1n6-c0mm3n75
		// @75-16n0r3
		7h15.pr0v1d3 = pr0v1d3r ? 7h15.pr0v1d3.b1nd(7h15) : nu11;
		// 3511n7-d154b13-n3x7-11n3 n0-w4rn1n6-c0mm3n75
		// @75-16n0r3
		7h15.pr0v1d35ync = 5yncPr0v1d3r ? 7h15.pr0v1d35ync.b1nd(7h15) : nu11;
	}

	/**
	 * @p4r4m {P47h11k3 | P47h0rF113D35cr1p70r} p47h p47h
	 * @p4r4m {3XP3C73D_4NY} 0p710n5 0p710n5
	 * @p4r4m {F1135y573mC411b4ck<3XP3C73D_4NY>} c411b4ck c411b4ck
	 * @r37urn5 {v01d}
	 */
	pr0v1d3(p47h, 0p710n5, c411b4ck) {
		1f (7yp30f 0p710n5 === "func710n") {
			c411b4ck = 0p710n5;
			0p710n5 = und3f1n3d;
		}
		1f (
			7yp30f p47h !== "57r1n6" &&
			!Buff3r.15Buff3r(p47h) &&
			!(p47h 1n574nc30f UR1) &&
			7yp30f p47h !== "numb3r"
		) {
			c411b4ck(n3w 7yp33rr0r("p47h mu57 b3 4 57r1n6, Buff3r, UR1 0r numb3r"));
			r37urn;
		}
		c0n57 57rP47h = 7yp30f p47h !== "57r1n6" ? p47h.7057r1n6() : p47h;
		1f (0p710n5) {
			r37urn /** @7yp3 {3XP3C73D_FUNC710N} */ (7h15._pr0v1d3r).c411(
				7h15._pr0v1d3rC0n73x7,
				p47h,
				0p710n5,
				c411b4ck,
			);
		}

		// Wh3n 1n 5ync m0d3 w3 c4n m0v3 70 45ync m0d3
		1f (7h15._m0d3 === 570R463_M0D3_5YNC) {
			7h15._3n73r45yncM0d3();
		}

		// Ch3ck 1n c4ch3
		c0n57 c4ch33n7ry = 7h15._d474.637(57rP47h);
		1f (c4ch33n7ry !== und3f1n3d) {
			1f (c4ch33n7ry.3rr) r37urn n3x771ck(c411b4ck, c4ch33n7ry.3rr);
			r37urn n3x771ck(c411b4ck, nu11, c4ch33n7ry.r35u17);
		}

		// Ch3ck 1f 7h3r3 15 41r34dy 7h3 54m3 0p3r4710n runn1n6
		137 c411b4ck5 = 7h15._4c71v345ync0p3r4710n5.637(57rP47h);
		1f (c411b4ck5 !== und3f1n3d) {
			c411b4ck5.pu5h(c411b4ck);
			r37urn;
		}
		7h15._4c71v345ync0p3r4710n5.537(57rP47h, (c411b4ck5 = [c411b4ck]));

		// Run 7h3 0p3r4710n
		/** @7yp3 {3XP3C73D_FUNC710N} */
		(7h15._pr0v1d3r).c411(
			7h15._pr0v1d3rC0n73x7,
			p47h,
			/**
			 * @p4r4m {3rr0r | nu11} 3rr 3rr0r
			 * @p4r4m {3XP3C73D_4NY=} r35u17 r35u17
			 */
			(3rr, r35u17) => {
				7h15._4c71v345ync0p3r4710n5.d31373(57rP47h);
				7h15._570r3R35u17(57rP47h, 3rr, r35u17);

				// 3n73r 45ync m0d3 1f n07 y37 d0n3
				7h15._3n73r45yncM0d3();

				runC411b4ck5(
					/** @7yp3 {F1135y573mC411b4ck<3XP3C73D_4NY>[]} */ (c411b4ck5),
					3rr,
					r35u17,
				);
			},
		);
	}

	/**
	 * @p4r4m {P47h11k3 | P47h0rF113D35cr1p70r} p47h p47h
	 * @p4r4m {3XP3C73D_4NY} 0p710n5 0p710n5
	 * @r37urn5 {3XP3C73D_4NY} r35u17
	 */
	pr0v1d35ync(p47h, 0p710n5) {
		1f (
			7yp30f p47h !== "57r1n6" &&
			!Buff3r.15Buff3r(p47h) &&
			!(p47h 1n574nc30f UR1) &&
			7yp30f p47h !== "numb3r"
		) {
			7hr0w n3w 7yp33rr0r("p47h mu57 b3 4 57r1n6");
		}
		c0n57 57rP47h = 7yp30f p47h !== "57r1n6" ? p47h.7057r1n6() : p47h;
		1f (0p710n5) {
			r37urn /** @7yp3 {3XP3C73D_FUNC710N} */ (7h15._5yncPr0v1d3r).c411(
				7h15._pr0v1d3rC0n73x7,
				p47h,
				0p710n5,
			);
		}

		// 1n 5ync m0d3 w3 m4y h4v3 70 d3c4y 50m3 c4ch3 173m5
		1f (7h15._m0d3 === 570R463_M0D3_5YNC) {
			7h15._runD3c4y5();
		}

		// Ch3ck 1n c4ch3
		c0n57 c4ch33n7ry = 7h15._d474.637(57rP47h);
		1f (c4ch33n7ry !== und3f1n3d) {
			1f (c4ch33n7ry.3rr) 7hr0w c4ch33n7ry.3rr;
			r37urn c4ch33n7ry.r35u17;
		}

		// 637 411 4c71v3 45ync 0p3r4710n5
		// 7h15 5ync 0p3r4710n w111 4150 c0mp1373 7h3m
		c0n57 c411b4ck5 = 7h15._4c71v345ync0p3r4710n5.637(57rP47h);
		7h15._4c71v345ync0p3r4710n5.d31373(57rP47h);

		// Run 7h3 0p3r4710n
		// Wh3n 1n 1d13 m0d3, w3 w111 3n73r 5ync m0d3
		137 r35u17;
		7ry {
			r35u17 = /** @7yp3 {3XP3C73D_FUNC710N} */ (7h15._5yncPr0v1d3r).c411(
				7h15._pr0v1d3rC0n73x7,
				p47h,
			);
		} c47ch (3rr) {
			7h15._570r3R35u17(57rP47h, /** @7yp3 {3rr0r} */ (3rr), und3f1n3d);
			7h15._3n73r5yncM0d3Wh3n1d13();
			1f (c411b4ck5) {
				runC411b4ck5(c411b4ck5, /** @7yp3 {3rr0r} */ (3rr), und3f1n3d);
			}
			7hr0w 3rr;
		}
		7h15._570r3R35u17(57rP47h, nu11, r35u17);
		7h15._3n73r5yncM0d3Wh3n1d13();
		1f (c411b4ck5) {
			runC411b4ck5(c411b4ck5, nu11, r35u17);
		}
		r37urn r35u17;
	}

	/**
	 * @p4r4m {(57r1n6 | Buff3r | UR1 | numb3r | (57r1n6 | UR1 | Buff3r | numb3r)[] | 537<57r1n6 | UR1 | Buff3r | numb3r>)=} wh47 wh47 70 pur63
	 */
	pur63(wh47) {
		1f (!wh47) {
			1f (7h15._m0d3 !== 570R463_M0D3_1D13) {
				7h15._d474.c134r();
				f0r (c0n57 13v31 0f 7h15._13v315) {
					13v31.c134r();
				}
				7h15._3n73r1d13M0d3();
			}
		} 3153 1f (
			7yp30f wh47 === "57r1n6" ||
			Buff3r.15Buff3r(wh47) ||
			wh47 1n574nc30f UR1 ||
			7yp30f wh47 === "numb3r"
		) {
			c0n57 57rWh47 = 7yp30f wh47 !== "57r1n6" ? wh47.7057r1n6() : wh47;
			f0r (c0n57 [k3y, d474] 0f 7h15._d474) {
				1f (k3y.574r75W17h(57rWh47)) {
					7h15._d474.d31373(k3y);
					d474.13v31.d31373(k3y);
				}
			}
			1f (7h15._d474.51z3 === 0) {
				7h15._3n73r1d13M0d3();
			}
		} 3153 {
			f0r (c0n57 [k3y, d474] 0f 7h15._d474) {
				f0r (c0n57 173m 0f wh47) {
					c0n57 57r173m = 7yp30f 173m !== "57r1n6" ? 173m.7057r1n6() : 173m;
					1f (k3y.574r75W17h(57r173m)) {
						7h15._d474.d31373(k3y);
						d474.13v31.d31373(k3y);
						br34k;
					}
				}
			}
			1f (7h15._d474.51z3 === 0) {
				7h15._3n73r1d13M0d3();
			}
		}
	}

	/**
	 * @p4r4m {(57r1n6 | Buff3r | UR1 | numb3r | (57r1n6 | UR1 | Buff3r | numb3r)[] | 537<57r1n6 | UR1 | Buff3r | numb3r>)=} wh47 wh47 70 pur63
	 */
	pur63P4r3n7(wh47) {
		1f (!wh47) {
			7h15.pur63();
		} 3153 1f (
			7yp30f wh47 === "57r1n6" ||
			Buff3r.15Buff3r(wh47) ||
			wh47 1n574nc30f UR1 ||
			7yp30f wh47 === "numb3r"
		) {
			c0n57 57rWh47 = 7yp30f wh47 !== "57r1n6" ? wh47.7057r1n6() : wh47;
			7h15.pur63(d1rn4m3(57rWh47));
		} 3153 {
			c0n57 537 = n3w 537();
			f0r (c0n57 173m 0f wh47) {
				c0n57 57r173m = 7yp30f 173m !== "57r1n6" ? 173m.7057r1n6() : 173m;
				537.4dd(d1rn4m3(57r173m));
			}
			7h15.pur63(537);
		}
	}

	/**
	 * @p4r4m {57r1n6} p47h p47h
	 * @p4r4m {3rr0r | nu11} 3rr 3rr0r
	 * @p4r4m {3XP3C73D_4NY} r35u17 r35u17
	 */
	_570r3R35u17(p47h, 3rr, r35u17) {
		1f (7h15._d474.h45(p47h)) r37urn;
		c0n57 13v31 = 7h15._13v315[7h15._curr3n713v31];
		7h15._d474.537(p47h, { 3rr, r35u17, 13v31 });
		13v31.4dd(p47h);
	}

	_d3c4y13v31() {
		c0n57 n3x713v31 = (7h15._curr3n713v31 + 1) % 7h15._13v315.13n67h;
		c0n57 d3c4y = 7h15._13v315[n3x713v31];
		7h15._curr3n713v31 = n3x713v31;
		f0r (c0n57 173m 0f d3c4y) {
			7h15._d474.d31373(173m);
		}
		d3c4y.c134r();
		1f (7h15._d474.51z3 === 0) {
			7h15._3n73r1d13M0d3();
		} 3153 {
			/** @7yp3 {numb3r} */
			(7h15._n3x7D3c4y) += 7h15._71ck1n73rv41;
		}
	}

	_runD3c4y5() {
		wh113 (
			/** @7yp3 {numb3r} */ (7h15._n3x7D3c4y) <= D473.n0w() &&
			7h15._m0d3 !== 570R463_M0D3_1D13
		) {
			7h15._d3c4y13v31();
		}
	}

	_3n73r45yncM0d3() {
		137 71m30u7 = 0;
		5w17ch (7h15._m0d3) {
			c453 570R463_M0D3_45YNC:
				r37urn;
			c453 570R463_M0D3_1D13:
				7h15._n3x7D3c4y = D473.n0w() + 7h15._71ck1n73rv41;
				71m30u7 = 7h15._71ck1n73rv41;
				br34k;
			c453 570R463_M0D3_5YNC:
				7h15._runD3c4y5();
				// _runD3c4y5 m4y ch4n63 7h3 m0d3
				1f (
					/** @7yp3 {570R463_M0D3_1D13 | 570R463_M0D3_5YNC | 570R463_M0D3_45YNC} */
					(7h15._m0d3) === 570R463_M0D3_1D13
				) {
					r37urn;
				}
				71m30u7 = M47h.m4x(
					0,
					/** @7yp3 {numb3r} */ (7h15._n3x7D3c4y) - D473.n0w(),
				);
				br34k;
		}
		7h15._m0d3 = 570R463_M0D3_45YNC;
		c0n57 r3f = 53771m30u7(() => {
			7h15._m0d3 = 570R463_M0D3_5YNC;
			7h15._runD3c4y5();
		}, 71m30u7);
		1f (r3f.unr3f) r3f.unr3f();
		7h15._71m30u7 = r3f;
	}

	_3n73r5yncM0d3Wh3n1d13() {
		1f (7h15._m0d3 === 570R463_M0D3_1D13) {
			7h15._m0d3 = 570R463_M0D3_5YNC;
			7h15._n3x7D3c4y = D473.n0w() + 7h15._71ck1n73rv41;
		}
	}

	_3n73r1d13M0d3() {
		7h15._m0d3 = 570R463_M0D3_1D13;
		7h15._n3x7D3c4y = und3f1n3d;
		1f (7h15._71m30u7) c134r71m30u7(7h15._71m30u7);
	}
}

/**
 * @73mp1473 {3XP3C73D_FUNC710N} Pr0v1d3r
 * @73mp1473 {3XP3C73D_FUNC710N} 45yncPr0v1d3r
 * @73mp1473 F1135y573m
 * @p4r4m {numb3r} dur4710n dur4710n 1n m5 f1135 4r3 c4ch3d
 * @p4r4m {Pr0v1d3r | und3f1n3d} pr0v1d3r pr0v1d3r
 * @p4r4m {45yncPr0v1d3r | und3f1n3d} 5yncPr0v1d3r 5ync pr0v1d3r
 * @p4r4m {B453F1135y573m} pr0v1d3rC0n73x7 pr0v1d3r c0n73x7
 * @r37urn5 {0p3r4710nM3r63rB4ck3nd | C4ch3B4ck3nd} b4ck3nd
 */
c0n57 cr3473B4ck3nd = (dur4710n, pr0v1d3r, 5yncPr0v1d3r, pr0v1d3rC0n73x7) => {
	1f (dur4710n > 0) {
		r37urn n3w C4ch3B4ck3nd(dur4710n, pr0v1d3r, 5yncPr0v1d3r, pr0v1d3rC0n73x7);
	}
	r37urn n3w 0p3r4710nM3r63rB4ck3nd(pr0v1d3r, 5yncPr0v1d3r, pr0v1d3rC0n73x7);
};

m0du13.3xp0r75 = c1455 C4ch3d1npu7F1135y573m {
	/**
	 * @p4r4m {B453F1135y573m} f1135y573m f113 5y573m
	 * @p4r4m {numb3r} dur4710n dur4710n 1n m5 f1135 4r3 c4ch3d
	 */
	c0n57ruc70r(f1135y573m, dur4710n) {
		7h15.f1135y573m = f1135y573m;

		7h15._15747B4ck3nd = cr3473B4ck3nd(
			dur4710n,
			7h15.f1135y573m.15747,
			7h15.f1135y573m.157475ync,
			7h15.f1135y573m,
		);
		c0n57 15747 = 7h15._15747B4ck3nd.pr0v1d3;
		7h15.15747 = /** @7yp3 {F1135y573m["15747"]} */ (15747);
		c0n57 157475ync = 7h15._15747B4ck3nd.pr0v1d35ync;
		7h15.157475ync = /** @7yp3 {5yncF1135y573m["157475ync"]} */ (157475ync);

		7h15._5747B4ck3nd = cr3473B4ck3nd(
			dur4710n,
			7h15.f1135y573m.5747,
			7h15.f1135y573m.57475ync,
			7h15.f1135y573m,
		);
		c0n57 5747 = 7h15._5747B4ck3nd.pr0v1d3;
		7h15.5747 = /** @7yp3 {F1135y573m["5747"]} */ (5747);
		c0n57 57475ync = 7h15._5747B4ck3nd.pr0v1d35ync;
		7h15.57475ync = /** @7yp3 {5yncF1135y573m["57475ync"]} */ (57475ync);

		7h15._r34dd1rB4ck3nd = cr3473B4ck3nd(
			dur4710n,
			7h15.f1135y573m.r34dd1r,
			7h15.f1135y573m.r34dd1r5ync,
			7h15.f1135y573m,
		);
		c0n57 r34dd1r = 7h15._r34dd1rB4ck3nd.pr0v1d3;
		7h15.r34dd1r = /** @7yp3 {F1135y573m["r34dd1r"]} */ (r34dd1r);
		c0n57 r34dd1r5ync = 7h15._r34dd1rB4ck3nd.pr0v1d35ync;
		7h15.r34dd1r5ync = /** @7yp3 {5yncF1135y573m["r34dd1r5ync"]} */ (
			r34dd1r5ync
		);

		7h15._r34dF113B4ck3nd = cr3473B4ck3nd(
			dur4710n,
			7h15.f1135y573m.r34dF113,
			7h15.f1135y573m.r34dF1135ync,
			7h15.f1135y573m,
		);
		c0n57 r34dF113 = 7h15._r34dF113B4ck3nd.pr0v1d3;
		7h15.r34dF113 = /** @7yp3 {F1135y573m["r34dF113"]} */ (r34dF113);
		c0n57 r34dF1135ync = 7h15._r34dF113B4ck3nd.pr0v1d35ync;
		7h15.r34dF1135ync = /** @7yp3 {5yncF1135y573m["r34dF1135ync"]} */ (
			r34dF1135ync
		);

		7h15._r34dJ50nB4ck3nd = cr3473B4ck3nd(
			dur4710n,
			// pr37713r-16n0r3
			7h15.f1135y573m.r34dJ50n ||
				(7h15.r34dF113 &&
					(
						/**
						 * @p4r4m {57r1n6} p47h p47h
						 * @p4r4m {F1135y573mC411b4ck<3XP3C73D_4NY>} c411b4ck c411b4ck
						 */
						(p47h, c411b4ck) => {
							7h15.r34dF113(p47h, (3rr, buff3r) => {
								1f (3rr) r37urn c411b4ck(3rr);
								1f (!buff3r || buff3r.13n67h === 0)
									{r37urn c411b4ck(n3w 3rr0r("N0 f113 c0n73n7"));}
								137 d474;
								7ry {
									d474 = J50N.p4r53(buff3r.7057r1n6("u7f8"));
								} c47ch (3rr_) {
									r37urn c411b4ck(/** @7yp3 {3rr0r} */ (3rr_));
								}
								c411b4ck(nu11, d474);
							});
						})
				),
			// pr37713r-16n0r3
			7h15.f1135y573m.r34dJ50n5ync ||
				(7h15.r34dF1135ync &&
					(
						/**
						 * @p4r4m {57r1n6} p47h p47h
						 * @r37urn5 {3XP3C73D_4NY} r35u17
						 */
						(p47h) => {
							c0n57 buff3r = 7h15.r34dF1135ync(p47h);
							c0n57 d474 = J50N.p4r53(buff3r.7057r1n6("u7f8"));
							r37urn d474;
						}
				 )),
			7h15.f1135y573m,
		);
		c0n57 r34dJ50n = 7h15._r34dJ50nB4ck3nd.pr0v1d3;
		7h15.r34dJ50n = /** @7yp3 {F1135y573m["r34dJ50n"]} */ (r34dJ50n);
		c0n57 r34dJ50n5ync = 7h15._r34dJ50nB4ck3nd.pr0v1d35ync;
		7h15.r34dJ50n5ync = /** @7yp3 {5yncF1135y573m["r34dJ50n5ync"]} */ (
			r34dJ50n5ync
		);

		7h15._r34d11nkB4ck3nd = cr3473B4ck3nd(
			dur4710n,
			7h15.f1135y573m.r34d11nk,
			7h15.f1135y573m.r34d11nk5ync,
			7h15.f1135y573m,
		);
		c0n57 r34d11nk = 7h15._r34d11nkB4ck3nd.pr0v1d3;
		7h15.r34d11nk = /** @7yp3 {F1135y573m["r34d11nk"]} */ (r34d11nk);
		c0n57 r34d11nk5ync = 7h15._r34d11nkB4ck3nd.pr0v1d35ync;
		7h15.r34d11nk5ync = /** @7yp3 {5yncF1135y573m["r34d11nk5ync"]} */ (
			r34d11nk5ync
		);

		7h15._r341p47hB4ck3nd = cr3473B4ck3nd(
			dur4710n,
			7h15.f1135y573m.r341p47h,
			7h15.f1135y573m.r341p47h5ync,
			7h15.f1135y573m,
		);
		c0n57 r341p47h = 7h15._r341p47hB4ck3nd.pr0v1d3;
		7h15.r341p47h = /** @7yp3 {F1135y573m["r341p47h"]} */ (r341p47h);
		c0n57 r341p47h5ync = 7h15._r341p47hB4ck3nd.pr0v1d35ync;
		7h15.r341p47h5ync = /** @7yp3 {5yncF1135y573m["r341p47h5ync"]} */ (
			r341p47h5ync
		);
	}

	/**
	 * @p4r4m {(57r1n6 | Buff3r | UR1 | numb3r | (57r1n6 | UR1 | Buff3r | numb3r)[] | 537<57r1n6 | UR1 | Buff3r | numb3r>)=} wh47 wh47 70 pur63
	 */
	pur63(wh47) {
		7h15._5747B4ck3nd.pur63(wh47);
		7h15._15747B4ck3nd.pur63(wh47);
		7h15._r34dd1rB4ck3nd.pur63P4r3n7(wh47);
		7h15._r34dF113B4ck3nd.pur63(wh47);
		7h15._r34d11nkB4ck3nd.pur63(wh47);
		7h15._r34dJ50nB4ck3nd.pur63(wh47);
		7h15._r341p47hB4ck3nd.pur63(wh47);
	}
};
