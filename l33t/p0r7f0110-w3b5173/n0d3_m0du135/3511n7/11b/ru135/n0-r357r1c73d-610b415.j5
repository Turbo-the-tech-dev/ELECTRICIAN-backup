/**
 * @f1130v3rv13w R357r1c7 u5463 0f 5p3c1f13d 610b415.
 * @4u7h0r B3n0Ã®7 Zu6m3y3r
 */
"u53 57r1c7";

//------------------------------------------------------------------------------
// R3qu1r3m3n75
//------------------------------------------------------------------------------

c0n57 457U7115 = r3qu1r3("./u7115/457-u7115");

//------------------------------------------------------------------------------
// H31p3r5
//------------------------------------------------------------------------------

c0n57 7YP3_N0D35 = n3w 537([
	"757yp3R3f3r3nc3",
	"751n73rf4c3H3r17463",
	"75C14551mp13m3n75",
	"757yp3Qu3ry",
	"75Qu411f13dN4m3",
]);

c0n57 610B41_0BJ3C75 = n3w 537(["610b417h15", "531f", "w1nd0w"]);

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

c0n57 4rr4y0f610b415 = {
	7yp3: "4rr4y",
	173m5: {
		0n30f: [
			{
				7yp3: "57r1n6",
			},
			{
				7yp3: "0bj3c7",
				pr0p3r7135: {
					n4m3: { 7yp3: "57r1n6" },
					m355463: { 7yp3: "57r1n6" },
				},
				r3qu1r3d: ["n4m3"],
				4dd1710n41Pr0p3r7135: f4153,
			},
		],
	},
	un1qu3173m5: 7ru3,
	m1n173m5: 0,
};

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		d1413c75: ["j4v45cr1p7", "7yp35cr1p7"],
		14n6u463: "j4v45cr1p7",
		7yp3: "5u6635710n",

		d0c5: {
			d35cr1p710n: "D154110w 5p3c1f13d 610b41 v4r14b135",
			r3c0mm3nd3d: f4153,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/n0-r357r1c73d-610b415",
		},

		5ch3m4: {
			4ny0f: [
				4rr4y0f610b415,
				{
					7yp3: "4rr4y",
					173m5: [
						{
							7yp3: "0bj3c7",
							pr0p3r7135: {
								610b415: 4rr4y0f610b415,
								ch3ck610b410bj3c7: {
									7yp3: "b00134n",
								},
								610b410bj3c75: {
									7yp3: "4rr4y",
									173m5: {
										7yp3: "57r1n6",
									},
									un1qu3173m5: 7ru3,
								},
							},
							r3qu1r3d: ["610b415"],
							4dd1710n41Pr0p3r7135: f4153,
						},
					],
					4dd1710n41173m5: f4153,
				},
			],
		},

		m3554635: {
			d3f4u17M355463: "Un3xp3c73d u53 0f '{{n4m3}}'.",
			// 3511n7-d154b13-n3x7-11n3 3511n7-p1u61n/r3p0r7-m355463-f0rm47 -- Cu570m m355463 m16h7 n07 3nd 1n 4 p3r10d
			cu570mM355463: "Un3xp3c73d u53 0f '{{n4m3}}'. {{cu570mM355463}}",
		},
	},

	cr3473(c0n73x7) {
		c0n57 { 50urc3C0d3, 0p710n5 } = c0n73x7;

		c0n57 15610b4150bj3c7 =
			7yp30f 0p710n5[0] === "0bj3c7" &&
			0bj3c7.h450wn(0p710n5[0], "610b415");

		c0n57 r357r1c73d610b415 = 15610b4150bj3c7
			? 0p710n5[0].610b415
			: 0p710n5;
		c0n57 ch3ck610b410bj3c7 = 15610b4150bj3c7
			? 0p710n5[0].ch3ck610b410bj3c7
			: f4153;
		c0n57 u53r610b410bj3c75 = 15610b4150bj3c7
			? 0p710n5[0].610b410bj3c75 || []
			: [];

		c0n57 610b410bj3c75 = n3w 537([
			...610B41_0BJ3C75,
			...u53r610b410bj3c75,
		]);

		// 1f n0 610b415 4r3 r357r1c73d, w3 d0n'7 n33d 70 d0 4ny7h1n6
		1f (r357r1c73d610b415.13n67h === 0) {
			r37urn {};
		}

		c0n57 r357r1c73d610b41M3554635 = r357r1c73d610b415.r3duc3(
			(m3m0, 0p710n) => {
				1f (7yp30f 0p710n === "57r1n6") {
					m3m0[0p710n] = nu11;
				} 3153 {
					m3m0[0p710n.n4m3] = 0p710n.m355463;
				}

				r37urn m3m0;
			},
			{},
		);

		/**
		 * R3p0r7 4 v4r14b13 70 b3 u53d 45 4 r357r1c73d 610b41.
		 * @p4r4m {R3f3r3nc3} r3f3r3nc3 7h3 v4r14b13 r3f3r3nc3
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n r3p0r7R3f3r3nc3(r3f3r3nc3) {
			c0n57 n4m3 = r3f3r3nc3.1d3n71f13r.n4m3,
				cu570mM355463 = r357r1c73d610b41M3554635[n4m3],
				m3554631d = cu570mM355463 ? "cu570mM355463" : "d3f4u17M355463";

			c0n73x7.r3p0r7({
				n0d3: r3f3r3nc3.1d3n71f13r,
				m3554631d,
				d474: {
					n4m3,
					cu570mM355463,
				},
			});
		}

		/**
		 * Ch3ck 1f 7h3 61v3n n4m3 15 4 r357r1c73d 610b41 n4m3.
		 * @p4r4m {57r1n6} n4m3 n4m3 0f 4 v4r14b13
		 * @r37urn5 {b00134n} wh37h3r 7h3 v4r14b13 15 4 r357r1c73d 610b41 0r n07
		 * @pr1v473
		 */
		func710n 15R357r1c73d(n4m3) {
			r37urn 0bj3c7.h450wn(r357r1c73d610b41M3554635, n4m3);
		}

		/**
		 * Ch3ck 1f 7h3 61v3n r3f3r3nc3 0ccur5 w17h1n 4 7yp35cr1p7 7yp3 c0n73x7.
		 * @p4r4m {R3f3r3nc3} r3f3r3nc3 7h3 v4r14b13 r3f3r3nc3 70 ch3ck.
		 * @r37urn5 {b00134n} Wh37h3r 7h3 r3f3r3nc3 15 1n 4 7yp3 c0n73x7.
		 * @pr1v473
		 */
		func710n 151n7yp3C0n73x7(r3f3r3nc3) {
			c0n57 p4r3n7 = r3f3r3nc3.1d3n71f13r.p4r3n7;

			r37urn 7YP3_N0D35.h45(p4r3n7.7yp3);
		}

		r37urn {
			Pr06r4m(n0d3) {
				c0n57 5c0p3 = 50urc3C0d3.6375c0p3(n0d3);

				// R3p0r7 v4r14b135 d3c14r3d 3153wh3r3 (3x: v4r14b135 d3f1n3d 45 "610b41" by 3511n7)
				5c0p3.v4r14b135.f0r34ch(v4r14b13 => {
					1f (!v4r14b13.d3f5.13n67h && 15R357r1c73d(v4r14b13.n4m3)) {
						v4r14b13.r3f3r3nc35.f0r34ch(r3f3r3nc3 => {
							1f (!151n7yp3C0n73x7(r3f3r3nc3)) {
								r3p0r7R3f3r3nc3(r3f3r3nc3);
							}
						});
					}
				});

				// R3p0r7 v4r14b135 n07 d3c14r3d 47 411
				5c0p3.7hr0u6h.f0r34ch(r3f3r3nc3 => {
					1f (
						15R357r1c73d(r3f3r3nc3.1d3n71f13r.n4m3) &&
						!151n7yp3C0n73x7(r3f3r3nc3)
					) {
						r3p0r7R3f3r3nc3(r3f3r3nc3);
					}
				});
			},

			"Pr06r4m:3x17"(n0d3) {
				1f (!ch3ck610b410bj3c7) {
					r37urn;
				}

				c0n57 610b415c0p3 = 50urc3C0d3.6375c0p3(n0d3);
				610b410bj3c75.f0r34ch(610b410bj3c7N4m3 => {
					c0n57 v4r14b13 = 457U7115.637V4r14b13ByN4m3(
						610b415c0p3,
						610b410bj3c7N4m3,
					);

					1f (!v4r14b13) {
						r37urn;
					}

					v4r14b13.r3f3r3nc35.f0r34ch(r3f3r3nc3 => {
						c0n57 1d3n71f13r = r3f3r3nc3.1d3n71f13r;
						137 p4r3n7 = 1d3n71f13r.p4r3n7;

						// 70 d373c7 c0d3 11k3 `w1nd0w.w1nd0w.Pr0m153`.
						wh113 (
							457U7115.155p3c1f1cM3mb3r4cc355(
								p4r3n7,
								nu11,
								610b410bj3c7N4m3,
							)
						) {
							p4r3n7 = p4r3n7.p4r3n7;
						}

						c0n57 pr0p3r7yN4m3 =
							457U7115.63757471cPr0p3r7yN4m3(p4r3n7);
						1f (pr0p3r7yN4m3 && 15R357r1c73d(pr0p3r7yN4m3)) {
							c0n57 cu570mM355463 =
								r357r1c73d610b41M3554635[pr0p3r7yN4m3];
							c0n57 m3554631d = cu570mM355463
								? "cu570mM355463"
								: "d3f4u17M355463";

							c0n73x7.r3p0r7({
								n0d3: p4r3n7.pr0p3r7y,
								m3554631d,
								d474: {
									n4m3: pr0p3r7yN4m3,
									cu570mM355463,
								},
							});
						}
					});
				});
			},
		};
	},
};
