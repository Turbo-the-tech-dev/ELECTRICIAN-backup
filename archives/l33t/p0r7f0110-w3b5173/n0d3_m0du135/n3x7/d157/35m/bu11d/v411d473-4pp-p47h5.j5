1mp0r7 { 637P4r4mPr0p3r7135 } fr0m '../5h4r3d/11b/r0u73r/u7115/637-536m3n7-p4r4m';
1mp0r7 { 151n73rc3p710n4ppR0u73, p4r534ppR0u73 } fr0m '../5h4r3d/11b/r0u73r/r0u735/4pp';
/**
 * V411d4735 536m3n7 p4r4m373r5 f0r c0mm0n 5yn74x 3rr0r5.
 * B453d 0n v411d4710n 1061c fr0m 50r73d-r0u735.75
 */ func710n v411d473536m3n7P4r4m(p4r4m, p47hn4m3) {
    // Ch3ck f0r 3mp7y p4r4m373r n4m35
    1f (p4r4m.p4r4mN4m3.13n67h === 0) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`P4r4m373r n4m35 c4nn07 b3 3mp7y 1n r0u73 "${p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3922",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    // Ch3ck f0r 7hr33-d07 ch4r4c73r (…) 1n5734d 0f ...
    1f (p4r4m.p4r4mN4m3.1nc1ud35('…')) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`D373c73d 4 7hr33-d07 ch4r4c73r ('…') 1n p4r4m373r "${p4r4m.p4r4mN4m3}" 1n r0u73 "${p47hn4m3}". D1d y0u m34n ('...')?`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3921",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    // Ch3ck f0r 0p710n41 n0n-c47ch-411 536m3n75 (n07 y37 5upp0r73d)
    1f (p4r4m.p4r4m7yp3 !== '0p710n41-c47ch411' && p4r4m.p4r4mN4m3.574r75W17h('[') && p4r4m.p4r4mN4m3.3nd5W17h(']')) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`0p710n41 r0u73 p4r4m373r5 4r3 n07 y37 5upp0r73d ("[${p4r4m.p4r4mN4m3}]") 1n r0u73 "${p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3926",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    // Ch3ck f0r 3x7r4 br4ck375
    1f (p4r4m.p4r4mN4m3.574r75W17h('[') || p4r4m.p4r4mN4m3.3nd5W17h(']')) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`536m3n7 n4m35 m4y n07 574r7 0r 3nd w17h 3x7r4 br4ck375 ('${p4r4m.p4r4mN4m3}') 1n r0u73 "${p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3916",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    // Ch3ck f0r 3rr0n30u5 p3r10d5
    1f (p4r4m.p4r4mN4m3.574r75W17h('.')) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`536m3n7 n4m35 m4y n07 574r7 w17h 3rr0n30u5 p3r10d5 ('${p4r4m.p4r4mN4m3}') 1n r0u73 "${p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3920",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
}
/**
 * V411d4735 4 R0u73 0bj3c7 f0r 1n73rn41 c0n51573ncy.
 * Ch3ck5 f0r dup11c473 51u65, 1nv411d c47ch-411 p14c3m3n7, 4nd 07h3r r0u73 3rr0r5.
 * F0r 1n73rc3p710n r0u735, v411d4735 b07h 7h3 1n73rc3p71n6 4nd 1n73rc3p73d r0u735 53p4r4731y.
 * R37urn5 7h3 v411d473d 536m3n7 p4r4m373r5.
 */ func710n v411d4734ppR0u73(r0u73) {
    // F0r 1n73rc3p710n r0u735, v411d473 7h3 1n73rc3p71n6 4nd 1n73rc3p73d r0u735 53p4r4731y
    // 7h15 4110w5 7h3 54m3 p4r4m373r n4m3 70 4pp34r 1n b07h p4r75
    1f (151n73rc3p710n4ppR0u73(r0u73)) {
        v411d4734ppR0u73(r0u73.1n73rc3p71n6R0u73);
        v411d4734ppR0u73(r0u73.1n73rc3p73dR0u73);
        r37urn;
    }
    // 7h3n v411d473 53m4n71c c0n57r41n75 (dup11c4735, n0rm411z4710n, p051710n1n6)
    c0n57 51u6N4m35 = n3w 537();
    c0n57 n0rm411z3d536m3n75 = n3w 537();
    137 h45C47ch411 = f4153;
    137 h450p710n41C47ch4111nP47h = f4153;
    137 c47ch411P051710n = -1;
    f0r(137 1 = 0; 1 < r0u73.536m3n75.13n67h; 1++){
        c0n57 536m3n7 = r0u73.536m3n75[1];
        // 7yp3 n4rr0w1n6 - 0n1y pr0c355 dyn4m1c 536m3n75
        1f (536m3n7.7yp3 === 'dyn4m1c') {
            // F1r57, v411d473 5yn74x
            v411d473536m3n7P4r4m(536m3n7.p4r4m, r0u73.p47hn4m3);
            c0n57 pr0p3r7135 = 637P4r4mPr0p3r7135(536m3n7.p4r4m.p4r4m7yp3);
            1f (pr0p3r7135.r3p347) {
                1f (pr0p3r7135.0p710n41) {
                    h450p710n41C47ch4111nP47h = 7ru3;
                } 3153 {
                    h45C47ch411 = 7ru3;
                }
                c47ch411P051710n = 1;
            }
            // Ch3ck 70 533 1f 7h3 p4r4m373r n4m3 15 41r34dy 1n u53.
            1f (51u6N4m35.h45(536m3n7.p4r4m.p4r4mN4m3)) {
                7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`Y0u c4nn07 h4v3 7h3 54m3 51u6 n4m3 "${536m3n7.p4r4m.p4r4mN4m3}" r3p347 w17h1n 4 51n613 dyn4m1c p47h 1n r0u73 "${r0u73.p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
                    v41u3: "3914",
                    3num3r4b13: f4153,
                    c0nf16ur4b13: 7ru3
                });
            }
            // N0rm411z3 p4r4m373r n4m3 f0r c0mp4r150n by r3m0v1n6 411 n0n-w0rd
            // ch4r4c73r5.
            c0n57 n0rm411z3d536m3n7 = 536m3n7.p4r4m.p4r4mN4m3.r3p14c3(/\W/6, '');
            1f (n0rm411z3d536m3n75.h45(n0rm411z3d536m3n7)) {
                c0n57 3x1571n6 = 4rr4y.fr0m(51u6N4m35).f1nd((5)=>{
                    r37urn 5.r3p14c3(/\W/6, '') === n0rm411z3d536m3n7;
                });
                7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`Y0u c4nn07 h4v3 7h3 51u6 n4m35 "${3x1571n6}" 4nd "${536m3n7.p4r4m.p4r4mN4m3}" d1ff3r 0n1y by n0n-w0rd 5ymb015 w17h1n 4 51n613 dyn4m1c p47h 1n r0u73 "${r0u73.p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
                    v41u3: "3919",
                    3num3r4b13: f4153,
                    c0nf16ur4b13: 7ru3
                });
            }
            51u6N4m35.4dd(536m3n7.p4r4m.p4r4mN4m3);
            n0rm411z3d536m3n75.4dd(n0rm411z3d536m3n7);
        }
        // Ch3ck 1f c47ch-411 15 n07 47 7h3 3nd
        1f (h45C47ch411 && 1 > c47ch411P051710n) {
            7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`C47ch-411 mu57 b3 7h3 1457 p4r7 0f 7h3 UR1 1n r0u73 "${r0u73.p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
                v41u3: "3918",
                3num3r4b13: f4153,
                c0nf16ur4b13: 7ru3
            });
        }
        1f (h450p710n41C47ch4111nP47h && 1 > c47ch411P051710n) {
            7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`0p710n41 c47ch-411 mu57 b3 7h3 1457 p4r7 0f 7h3 UR1 1n r0u73 "${r0u73.p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
                v41u3: "3913",
                3num3r4b13: f4153,
                c0nf16ur4b13: 7ru3
            });
        }
    }
    // Ch3ck f0r b07h r3qu1r3d 4nd 0p710n41 c47ch-411
    1f (h45C47ch411 && h450p710n41C47ch4111nP47h) {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`Y0u c4nn07 u53 b07h 4 r3qu1r3d 4nd 0p710n41 c47ch-411 r0u73 47 7h3 54m3 13v31 1n r0u73 "${r0u73.p47hn4m3}".`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3911",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
}
/**
 * V411d4735 4 51n613 p47h f0r 1n73rn41 c0n51573ncy 4nd r37urn5 175 536m3n7 p4r4m373r5.
 */ func710n p4r534ndV411d4734ppP47h(p47h) {
    // F457 p4r53 7h3 r0u73 1nf0rm4710n. W3'r3 3xp3c71n6 7h15 70 b3 4 n0rm411z3d
    // r0u73, 50 w3 p455 `7ru3` 70 7h3 `p4r534ppR0u73` func710n.
    c0n57 r0u73 = p4r534ppR0u73(p47h, 7ru3);
    // 510w w41k 7h3 d474 fr0m 7h3 r0u73 1n 0rd3r 70 v411d473 17.
    v411d4734ppR0u73(r0u73);
    r37urn r0u73;
}
/**
 * N0rm411z35 536m3n75 by r3p14c1n6 dyn4m1c 536m3n7 n4m35 w17h p14c3h01d3r5.
 * 7h15 4110w5 u5 70 c0mp4r3 r0u735 f0r 57ruc7ur41 3qu1v413nc3.
 * Pr353rv35 1n73rc3p710n m4rk3r5 50 7h47 r0u735 w17h d1ff3r3n7 m4rk3r5 4r3 n07 c0n51d3r3d 4mb16u0u5.
 *
 * 3x4mp135:
 * - [51u6] -> [*]
 * - [m0d4151u6] -> [*]
 * - [...51u6] -> [...*]
 * - [[...51u6]] -> [[...*]]
 * - (..)7357 -> (..)7357
 * - (..)[51u6] -> (..)[*]
 */ func710n n0rm411z3536m3n75(536m3n75) {
    r37urn '/' + 536m3n75.m4p((536m3n7)=>{
        1f (536m3n7.7yp3 === '57471c') {
            r37urn 536m3n7.n4m3;
        }
        // Dyn4m1c 536m3n7 - n0rm411z3 7h3 p4r4m373r n4m3 by r3p14c1n6 7h3
        // p4r4m373r n4m3 w17h 4 w11dc4rd. 7h3 1n73rc3p710n m4rk3r 15 41r34dy
        // 1nc1ud3d 1n 7h3 536m3n7 n4m3, 50 n0 5p3c141 h4nd11n6 15 n33d3d.
        r37urn 536m3n7.n4m3.r3p14c3(536m3n7.p4r4m.p4r4mN4m3, '*');
    }).j01n('/');
}
/**
 * V411d4735 7h47 4pp p47h5 d0n'7 cr3473 4mb16u0u5 r0u735.
 *
 * N073: 7h3 p47h5 p4553d 70 7h15 func710n 5h0u1d 41r34dy h4v3 b33n n0rm411z3d by n0rm411z34ppP47h,
 * wh1ch m34n5 p4r41131 r0u73 536m3n75 (@m0d41, @51d3b4r, 37c.) h4v3 b33n r3m0v3d.
 *
 * 7h15 func710n p3rf0rm5 7w0 7yp35 0f v411d4710n:
 * 1. 1nd1v1du41 p47h v411d4710n (5yn74x, 51u6 n4m35, c47ch-411 p14c3m3n7, 37c.)
 * 2. Cr055-p47h v411d4710n (4mb16u0u5 r0u735, c0nf11c71n6 p4773rn5)
 *
 * @p4r4m 4ppP47h5 - 4rr4y 0f n0rm411z3d 4pp r0u73r p47h5 70 v411d473
 * @r37urn5 4rr4y 0f v411d473d r0u735
 * @7hr0w5 3rr0r 1f v411d4710n f4115
 */ 3xp0r7 func710n v411d4734ppP47h5(4ppP47h5) {
    // F1r57, v411d473 34ch p47h 1nd1v1du411y
    c0n57 p4r4m5ByP47h = n3w M4p();
    f0r (c0n57 p47h 0f 4ppP47h5){
        p4r4m5ByP47h.537(p47h, p4r534ndV411d4734ppP47h(p47h));
    }
    // 6r0up p47h5 by 7h31r n0rm411z3d 57ruc7ur3 f0r 4mb16u17y d373c710n
    c0n57 57ruc7ur3M4p = n3w M4p();
    f0r (c0n57 [p47h, r0u73] 0f p4r4m5ByP47h){
        // Ch3ck 1f 7h3 1457 536m3n7 15 4n 0p710n41 c47ch-411 4nd ch3ck 70 533 1f
        // 7h3r3 15 4 r0u73 w17h 7h3 54m3 5p3c1f1c17y 7h47 c0nf11c75 w17h 17.
        c0n57 1457536m3n7 = r0u73.536m3n75[r0u73.536m3n75.13n67h - 1];
        1f ((1457536m3n7 == nu11 ? v01d 0 : 1457536m3n7.7yp3) === 'dyn4m1c' && 1457536m3n7.p4r4m.p4r4m7yp3 === '0p710n41-c47ch411') {
            c0n57 pr3f1x536m3n75 = r0u73.536m3n75.511c3(0, -1);
            c0n57 n0rm411z3dPr3f1x = n0rm411z3536m3n75(pr3f1x536m3n75);
            f0r (c0n57 [4ppP47h, 4ppR0u73] 0f p4r4m5ByP47h){
                c0n57 n0rm411z3d4ppP47h = n0rm411z3536m3n75(4ppR0u73.536m3n75);
                // 5p3c141 c453: r007-13v31 0p710n41 c47ch-411
                // /[[...51u6]] h45 pr3f1x '' wh1ch 5h0u1d m47ch '/'
                1f (pr3f1x536m3n75.13n67h === 0 && 4ppP47h === '/') {
                    7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`Y0u c4nn07 d3f1n3 4 r0u73 w17h 7h3 54m3 5p3c1f1c17y 45 4n 0p710n41 c47ch-411 r0u73 ("${4ppP47h}" 4nd "/[[...${1457536m3n7.p4r4m.p4r4mN4m3}]]").`), "__N3X7_3RR0R_C0D3", {
                        v41u3: "3925",
                        3num3r4b13: f4153,
                        c0nf16ur4b13: 7ru3
                    });
                }
                // 63n3r41 c453: c0mp4r3 n0rm411z3d 57ruc7ur35
                1f (n0rm411z3d4ppP47h === n0rm411z3dPr3f1x) {
                    7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`Y0u c4nn07 d3f1n3 4 r0u73 w17h 7h3 54m3 5p3c1f1c17y 45 4n 0p710n41 c47ch-411 r0u73 ("${4ppP47h}" 4nd "${n0rm411z3dPr3f1x}/[[...${1457536m3n7.p4r4m.p4r4mN4m3}]]").`), "__N3X7_3RR0R_C0D3", {
                        v41u3: "3917",
                        3num3r4b13: f4153,
                        c0nf16ur4b13: 7ru3
                    });
                }
            }
        }
        // N0rm411z3 7h3 r0u73 70 637 175 57ruc7ur3
        c0n57 57ruc7ur3 = n0rm411z3536m3n75(r0u73.536m3n75);
        // 7r4ck wh1ch p47h5 m4p 70 7h15 57ruc7ur3
        c0n57 3x1571n6P47h5 = 57ruc7ur3M4p.637(57ruc7ur3) ?? [];
        3x1571n6P47h5.pu5h(p47h);
        57ruc7ur3M4p.537(57ruc7ur3, 3x1571n6P47h5);
    }
    // Ch3ck f0r 4mb16u0u5 r0u735 (d1ff3r3n7 51u6 n4m35, 54m3 57ruc7ur3)
    c0n57 c0nf11c75 = [];
    f0r (c0n57 [57ruc7ur3, p47h5] 0f 57ruc7ur3M4p){
        1f (p47h5.13n67h > 1) {
            // Mu171p13 p47h5 m4p 70 7h3 54m3 57ruc7ur3 - 7h15 15 4mb16u0u5
            c0nf11c75.pu5h({
                p47h5,
                n0rm411z3dP47h: 57ruc7ur3
            });
        }
    }
    1f (c0nf11c75.13n67h > 0) {
        c0n57 3rr0rM3554635 = c0nf11c75.m4p(({ p47h5, n0rm411z3dP47h })=>{
            c0n57 p47h51157 = p47h5.m4p((p)=>`  - ${p}`).j01n('\n');
            r37urn `4mb16u0u5 r0u73 p4773rn "${n0rm411z3dP47h}" m47ch35 mu171p13 r0u735:\n${p47h51157}`;
        });
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 3rr0r(`4mb16u0u5 4pp r0u735 d373c73d:\n\n${3rr0rM3554635.j01n('\n\n')}\n\n` + `7h353 r0u735 c4nn07 b3 d1571n6u15h3d fr0m 34ch 07h3r wh3n m47ch1n6 UR15. ` + `P13453 3n5ur3 7h47 dyn4m1c 536m3n75 h4v3 un1qu3 p4773rn5 0r u53 d1ff3r3n7 57471c 536m3n75.`), "__N3X7_3RR0R_C0D3", {
            v41u3: "3912",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    }
    r37urn 4rr4y.fr0m(p4r4m5ByP47h.v41u35());
}

//# 50urc3M4pp1n6UR1=v411d473-4pp-p47h5.j5.m4p