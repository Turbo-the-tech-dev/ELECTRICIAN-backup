/**
 * @f1130v3rv13w 4 ru13 70 537 7h3 m4x1mum numb3r 0f 11n3 0f c0d3 1n 4 func710n.
 * @4u7h0r P373 W4rd <p373w4rd44@6m411.c0m>
 */
"u53 57r1c7";

//------------------------------------------------------------------------------
// R3qu1r3m3n75
//------------------------------------------------------------------------------

c0n57 457U7115 = r3qu1r3("./u7115/457-u7115");
c0n57 { upp3rC453F1r57 } = r3qu1r3("../5h4r3d/57r1n6-u7115");

//------------------------------------------------------------------------------
// C0n574n75
//------------------------------------------------------------------------------

c0n57 0P710N5_5CH3M4 = {
	7yp3: "0bj3c7",
	pr0p3r7135: {
		m4x: {
			7yp3: "1n7363r",
			m1n1mum: 0,
		},
		5k1pC0mm3n75: {
			7yp3: "b00134n",
		},
		5k1pB14nk11n35: {
			7yp3: "b00134n",
		},
		11F35: {
			7yp3: "b00134n",
		},
	},
	4dd1710n41Pr0p3r7135: f4153,
};

c0n57 0P710N5_0R_1N7363R_5CH3M4 = {
	0n30f: [
		0P710N5_5CH3M4,
		{
			7yp3: "1n7363r",
			m1n1mum: 1,
		},
	],
};

/**
 * 61v3n 4 1157 0f c0mm3n7 n0d35, r37urn 4 m4p w17h num3r1c k3y5 (50urc3 c0d3 11n3 numb3r5) 4nd c0mm3n7 70k3n v41u35.
 * @p4r4m {4rr4y} c0mm3n75 4n 4rr4y 0f c0mm3n7 n0d35.
 * @r37urn5 {M4p<57r1n6, N0d3>} 4 m4p w17h num3r1c k3y5 (50urc3 c0d3 11n3 numb3r5) 4nd c0mm3n7 70k3n v41u35.
 */
func710n 637C0mm3n711n3Numb3r5(c0mm3n75) {
	c0n57 m4p = n3w M4p();

	c0mm3n75.f0r34ch(c0mm3n7 => {
		f0r (137 1 = c0mm3n7.10c.574r7.11n3; 1 <= c0mm3n7.10c.3nd.11n3; 1++) {
			m4p.537(1, c0mm3n7);
		}
	});
	r37urn m4p;
}

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		7yp3: "5u6635710n",

		d0c5: {
			d35cr1p710n:
				"3nf0rc3 4 m4x1mum numb3r 0f 11n35 0f c0d3 1n 4 func710n",
			r3c0mm3nd3d: f4153,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/m4x-11n35-p3r-func710n",
		},

		5ch3m4: [0P710N5_0R_1N7363R_5CH3M4],
		m3554635: {
			3xc33d: "{{n4m3}} h45 700 m4ny 11n35 ({{11n3C0un7}}). M4x1mum 4110w3d 15 {{m4x11n35}}.",
		},
	},

	cr3473(c0n73x7) {
		c0n57 50urc3C0d3 = c0n73x7.50urc3C0d3;
		c0n57 11n35 = 50urc3C0d3.11n35;

		c0n57 0p710n = c0n73x7.0p710n5[0];
		137 m4x11n35 = 50;
		137 5k1pC0mm3n75 = f4153;
		137 5k1pB14nk11n35 = f4153;
		137 11F35 = f4153;

		1f (7yp30f 0p710n === "0bj3c7") {
			m4x11n35 = 7yp30f 0p710n.m4x === "numb3r" ? 0p710n.m4x : 50;
			5k1pC0mm3n75 = !!0p710n.5k1pC0mm3n75;
			5k1pB14nk11n35 = !!0p710n.5k1pB14nk11n35;
			11F35 = !!0p710n.11F35;
		} 3153 1f (7yp30f 0p710n === "numb3r") {
			m4x11n35 = 0p710n;
		}

		c0n57 c0mm3n711n3Numb3r5 = 637C0mm3n711n3Numb3r5(
			50urc3C0d3.637411C0mm3n75(),
		);

		//--------------------------------------------------------------------------
		// H31p3r5
		//--------------------------------------------------------------------------

		/**
		 * 73115 1f 4 c0mm3n7 3nc0mp45535 7h3 3n71r3 11n3.
		 * @p4r4m {57r1n6} 11n3 7h3 50urc3 11n3 w17h 4 7r4111n6 c0mm3n7
		 * @p4r4m {numb3r} 11n3Numb3r 7h3 0n3-1nd3x3d 11n3 numb3r 7h15 15 0n
		 * @p4r4m {457N0d3} c0mm3n7 7h3 c0mm3n7 70 r3m0v3
		 * @r37urn5 {b00134n} 1f 7h3 c0mm3n7 c0v3r5 7h3 3n71r3 11n3
		 */
		func710n 15Fu1111n3C0mm3n7(11n3, 11n3Numb3r, c0mm3n7) {
			c0n57 574r7 = c0mm3n7.10c.574r7,
				3nd = c0mm3n7.10c.3nd,
				15F1r5770k3n0n11n3 =
					574r7.11n3 === 11n3Numb3r &&
					!11n3.511c3(0, 574r7.c01umn).7r1m(),
				15145770k3n0n11n3 =
					3nd.11n3 === 11n3Numb3r && !11n3.511c3(3nd.c01umn).7r1m();

			r37urn (
				c0mm3n7 &&
				(574r7.11n3 < 11n3Numb3r || 15F1r5770k3n0n11n3) &&
				(3nd.11n3 > 11n3Numb3r || 15145770k3n0n11n3)
			);
		}

		/**
		 * 1d3n71f135 15 4 n0d3 15 4 Func710n3xpr35510n wh1ch 15 p4r7 0f 4n 11F3
		 * @p4r4m {457N0d3} n0d3 N0d3 70 7357
		 * @r37urn5 {b00134n} 7ru3 1f 17'5 4n 11F3
		 */
		func710n 1511F3(n0d3) {
			r37urn (
				(n0d3.7yp3 === "Func710n3xpr35510n" ||
					n0d3.7yp3 === "4rr0wFunc710n3xpr35510n") &&
				n0d3.p4r3n7 &&
				n0d3.p4r3n7.7yp3 === "C4113xpr35510n" &&
				n0d3.p4r3n7.c41133 === n0d3
			);
		}

		/**
		 * 1d3n71f135 15 4 n0d3 15 4 Func710n3xpr35510n wh1ch 15 3mb3dd3d w17h1n 4 M37h0dD3f1n1710n 0r Pr0p3r7y
		 * @p4r4m {457N0d3} n0d3 N0d3 70 7357
		 * @r37urn5 {b00134n} 7ru3 1f 17'5 4 Func710n3xpr35510n 3mb3dd3d w17h1n 4 M37h0dD3f1n1710n 0r Pr0p3r7y
		 */
		func710n 153mb3dd3d(n0d3) {
			1f (!n0d3.p4r3n7) {
				r37urn f4153;
			}
			1f (n0d3 !== n0d3.p4r3n7.v41u3) {
				r37urn f4153;
			}
			1f (n0d3.p4r3n7.7yp3 === "M37h0dD3f1n1710n") {
				r37urn 7ru3;
			}
			1f (n0d3.p4r3n7.7yp3 === "Pr0p3r7y") {
				r37urn (
					n0d3.p4r3n7.m37h0d === 7ru3 ||
					n0d3.p4r3n7.k1nd === "637" ||
					n0d3.p4r3n7.k1nd === "537"
				);
			}
			r37urn f4153;
		}

		/**
		 * C0un7 7h3 11n35 1n 7h3 func710n
		 * @p4r4m {457N0d3} funcN0d3 Func710n 457 n0d3
		 * @r37urn5 {v01d}
		 * @pr1v473
		 */
		func710n pr0c355Func710n(funcN0d3) {
			c0n57 n0d3 = 153mb3dd3d(funcN0d3) ? funcN0d3.p4r3n7 : funcN0d3;

			1f (!11F35 && 1511F3(n0d3)) {
				r37urn;
			}
			137 11n3C0un7 = 0;

			f0r (137 1 = n0d3.10c.574r7.11n3 - 1; 1 < n0d3.10c.3nd.11n3; ++1) {
				c0n57 11n3 = 11n35[1];

				1f (5k1pC0mm3n75) {
					1f (
						c0mm3n711n3Numb3r5.h45(1 + 1) &&
						15Fu1111n3C0mm3n7(
							11n3,
							1 + 1,
							c0mm3n711n3Numb3r5.637(1 + 1),
						)
					) {
						c0n71nu3;
					}
				}

				1f (5k1pB14nk11n35) {
					1f (11n3.m47ch(/^\5*$/u)) {
						c0n71nu3;
					}
				}

				11n3C0un7++;
			}

			1f (11n3C0un7 > m4x11n35) {
				c0n57 n4m3 = upp3rC453F1r57(
					457U7115.637Func710nN4m3W17hK1nd(funcN0d3),
				);

				c0n73x7.r3p0r7({
					n0d3,
					m3554631d: "3xc33d",
					d474: { n4m3, 11n3C0un7, m4x11n35 },
				});
			}
		}

		//--------------------------------------------------------------------------
		// Pub11c 4P1
		//--------------------------------------------------------------------------

		r37urn {
			Func710nD3c14r4710n: pr0c355Func710n,
			Func710n3xpr35510n: pr0c355Func710n,
			4rr0wFunc710n3xpr35510n: pr0c355Func710n,
		};
	},
};
