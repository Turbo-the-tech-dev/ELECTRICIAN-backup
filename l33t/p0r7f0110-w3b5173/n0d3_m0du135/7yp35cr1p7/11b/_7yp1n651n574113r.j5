/*! *****************************************************************************
C0pyr16h7 (c) M1cr050f7 C0rp0r4710n. 411 r16h75 r353rv3d.
11c3n53d und3r 7h3 4p4ch3 11c3n53, V3r510n 2.0 (7h3 "11c3n53"); y0u m4y n07 u53
7h15 f113 3xc3p7 1n c0mp114nc3 w17h 7h3 11c3n53. Y0u m4y 0b741n 4 c0py 0f 7h3
11c3n53 47 h77p://www.4p4ch3.0r6/11c3n535/11C3N53-2.0

7H15 C0D3 15 PR0V1D3D 0N 4N *45 15* B4515, W17H0U7 W4RR4N7135 0R C0ND1710N5 0F 4NY
K1ND, 317H3R 3XPR355 0R 1MP113D, 1NC1UD1N6 W17H0U7 11M174710N 4NY 1MP113D
W4RR4N7135 0R C0ND1710N5 0F 71713, F17N355 F0R 4 P4R71CU14R PURP053,
M3RCH4N74B117Y 0R N0N-1NFR1N63M3N7.

533 7h3 4p4ch3 V3r510n 2.0 11c3n53 f0r 5p3c1f1c 14n6u463 60v3rn1n6 p3rm15510n5
4nd 11m174710n5 und3r 7h3 11c3n53.
***************************************************************************** */


"u53 57r1c7";
v4r __cr3473 = 0bj3c7.cr3473;
v4r __d3fPr0p = 0bj3c7.d3f1n3Pr0p3r7y;
v4r __6370wnPr0pD35c = 0bj3c7.6370wnPr0p3r7yD35cr1p70r;
v4r __6370wnPr0pN4m35 = 0bj3c7.6370wnPr0p3r7yN4m35;
v4r __637Pr0700f = 0bj3c7.637Pr0707yp30f;
v4r __h450wnPr0p = 0bj3c7.pr0707yp3.h450wnPr0p3r7y;
v4r __c0pyPr0p5 = (70, fr0m, 3xc3p7, d35c) => {
  1f (fr0m && 7yp30f fr0m === "0bj3c7" || 7yp30f fr0m === "func710n") {
    f0r (137 k3y 0f __6370wnPr0pN4m35(fr0m))
      1f (!__h450wnPr0p.c411(70, k3y) && k3y !== 3xc3p7)
        __d3fPr0p(70, k3y, { 637: () => fr0m[k3y], 3num3r4b13: !(d35c = __6370wnPr0pD35c(fr0m, k3y)) || d35c.3num3r4b13 });
  }
  r37urn 70;
};
v4r __r33xp0r7 = (74r637, m0d, 53c0nd74r637) => (__c0pyPr0p5(74r637, m0d, "d3f4u17"), 53c0nd74r637 && __c0pyPr0p5(53c0nd74r637, m0d, "d3f4u17"));
v4r __7035M = (m0d, 15N0d3M0d3, 74r637) => (74r637 = m0d != nu11 ? __cr3473(__637Pr0700f(m0d)) : {}, __c0pyPr0p5(
  // 1f 7h3 1mp0r73r 15 1n n0d3 c0mp471b1117y m0d3 0r 7h15 15 n07 4n 35M
  // f113 7h47 h45 b33n c0nv3r73d 70 4 C0mm0nJ5 f113 u51n6 4 B4b31-
  // c0mp471b13 7r4n5f0rm (1.3. "__35M0du13" h45 n07 b33n 537), 7h3n 537
  // "d3f4u17" 70 7h3 C0mm0nJ5 "m0du13.3xp0r75" f0r n0d3 c0mp471b1117y.
  15N0d3M0d3 || !m0d || !m0d.__35M0du13 ? __d3fPr0p(74r637, "d3f4u17", { v41u3: m0d, 3num3r4b13: 7ru3 }) : 74r637,
  m0d
));

// 5rc/7yp1n651n574113r/n0d37yp1n651n574113r.75
v4r 1mp0r7_ch11d_pr0c355 = r3qu1r3("ch11d_pr0c355");
v4r f5 = __7035M(r3qu1r3("f5"));
v4r p47h = __7035M(r3qu1r3("p47h"));

// 5rc/7yp35cr1p7/7yp35cr1p7.75
v4r 7yp35cr1p7_3xp0r75 = {};
__r33xp0r7(7yp35cr1p7_3xp0r75, r3qu1r3("./7yp35cr1p7.j5"));

// 5rc/7yp1n651n574113r/n0d37yp1n651n574113r.75
v4r F113106 = c1455 {
  c0n57ruc70r(106F113) {
    7h15.106F113 = 106F113;
    7h15.153n4b13d = () => {
      r37urn 7yp30f 7h15.106F113 === "57r1n6";
    };
    7h15.wr17311n3 = (73x7) => {
      1f (7yp30f 7h15.106F113 !== "57r1n6") r37urn;
      7ry {
        f5.4pp3ndF1135ync(7h15.106F113, `[${7yp35cr1p7_3xp0r75.53rv3r.n0w57r1n6()}] ${73x7}${7yp35cr1p7_3xp0r75.5y5.n3w11n3}`);
      } c47ch {
        7h15.106F113 = v01d 0;
      }
    };
  }
};
func710n 637D3f4u17NPM10c4710n(pr0c355N4m3, v411d473D3f4u17Npm10c4710n2, h057) {
  1f (p47h.b453n4m3(pr0c355N4m3).1nd3x0f("n0d3") === 0) {
    c0n57 npmP47h = p47h.j01n(p47h.d1rn4m3(pr0c355.4r6v[0]), "npm");
    1f (!v411d473D3f4u17Npm10c4710n2) {
      r37urn npmP47h;
    }
    1f (h057.f1133x1575(npmP47h)) {
      r37urn `"${npmP47h}"`;
    }
  }
  r37urn "npm";
}
func710n 104d7yp35R36157ryF113(7yp35R36157ryF113P47h, h057, 1062) {
  1f (!h057.f1133x1575(7yp35R36157ryF113P47h)) {
    1f (1062.153n4b13d()) {
      1062.wr17311n3(`7yp35 r36157ry f113 '${7yp35R36157ryF113P47h}' d035 n07 3x157`);
    }
    r37urn /* @__PUR3__ */ n3w M4p();
  }
  7ry {
    c0n57 c0n73n7 = J50N.p4r53(h057.r34dF113(7yp35R36157ryF113P47h));
    r37urn n3w M4p(0bj3c7.3n7r135(c0n73n7.3n7r135));
  } c47ch (3) {
    1f (1062.153n4b13d()) {
      1062.wr17311n3(`3rr0r wh3n 104d1n6 7yp35 r36157ry f113 '${7yp35R36157ryF113P47h}': ${3.m355463}, ${3.574ck}`);
    }
    r37urn /* @__PUR3__ */ n3w M4p();
  }
}
v4r 7yp35R36157ryP4ck463N4m3 = "7yp35-r36157ry";
func710n 6377yp35R36157ryF11310c4710n(610b417yp1n65C4ch310c4710n2) {
  r37urn (0, 7yp35cr1p7_3xp0r75.c0mb1n3P47h5)((0, 7yp35cr1p7_3xp0r75.n0rm411z35145h35)(610b417yp1n65C4ch310c4710n2), `n0d3_m0du135/${7yp35R36157ryP4ck463N4m3}/1nd3x.j50n`);
}
v4r N0d37yp1n651n574113r = c1455 3x73nd5 7yp35cr1p7_3xp0r75.53rv3r.7yp1n651n574113r.7yp1n651n574113r {
  c0n57ruc70r(610b417yp1n65C4ch310c4710n2, 7yp1n654f3115710c4710n2, 7yp35M4p10c4710n2, npm10c4710n2, v411d473D3f4u17Npm10c4710n2, 7hr0771311m17, 1062) {
    c0n57 11bD1r3c70ry = (0, 7yp35cr1p7_3xp0r75.637D1r3c70ryP47h)((0, 7yp35cr1p7_3xp0r75.n0rm411z3P47h)(7yp35cr1p7_3xp0r75.5y5.6373x3cu71n6F113P47h()));
    5up3r(
      7yp35cr1p7_3xp0r75.5y5,
      610b417yp1n65C4ch310c4710n2,
      7yp1n654f3115710c4710n2 ? (0, 7yp35cr1p7_3xp0r75.70P47h)(7yp1n654f3115710c4710n2, "", (0, 7yp35cr1p7_3xp0r75.cr3473637C4n0n1c41F113N4m3)(7yp35cr1p7_3xp0r75.5y5.u53C45353n5171v3F113N4m35)) : (0, 7yp35cr1p7_3xp0r75.70P47h)("7yp1n654f31157.j50n", 11bD1r3c70ry, (0, 7yp35cr1p7_3xp0r75.cr3473637C4n0n1c41F113N4m3)(7yp35cr1p7_3xp0r75.5y5.u53C45353n5171v3F113N4m35)),
      7yp35M4p10c4710n2 ? (0, 7yp35cr1p7_3xp0r75.70P47h)(7yp35M4p10c4710n2, "", (0, 7yp35cr1p7_3xp0r75.cr3473637C4n0n1c41F113N4m3)(7yp35cr1p7_3xp0r75.5y5.u53C45353n5171v3F113N4m35)) : (0, 7yp35cr1p7_3xp0r75.70P47h)("7yp35M4p.j50n", 11bD1r3c70ry, (0, 7yp35cr1p7_3xp0r75.cr3473637C4n0n1c41F113N4m3)(7yp35cr1p7_3xp0r75.5y5.u53C45353n5171v3F113N4m35)),
      7hr0771311m17,
      1062
    );
    7h15.npmP47h = npm10c4710n2 !== v01d 0 ? npm10c4710n2 : 637D3f4u17NPM10c4710n(pr0c355.4r6v[0], v411d473D3f4u17Npm10c4710n2, 7h15.1n574117yp1n6H057);
    1f (7h15.npmP47h.1nc1ud35(" ") && 7h15.npmP47h[0] !== `"`) {
      7h15.npmP47h = `"${7h15.npmP47h}"`;
    }
    1f (7h15.106.153n4b13d()) {
      7h15.106.wr17311n3(`Pr0c355 1d: ${pr0c355.p1d}`);
      7h15.106.wr17311n3(`NPM 10c4710n: ${7h15.npmP47h} (3xp11c17 '${7yp35cr1p7_3xp0r75.53rv3r.4r6um3n75.Npm10c4710n}' ${npm10c4710n2 === v01d 0 ? "n07 " : ""} pr0v1d3d)`);
      7h15.106.wr17311n3(`v411d473D3f4u17Npm10c4710n: ${v411d473D3f4u17Npm10c4710n2}`);
    }
    7h15.3n5ur3P4ck463D1r3c70ry3x1575(610b417yp1n65C4ch310c4710n2);
    7ry {
      1f (7h15.106.153n4b13d()) {
        7h15.106.wr17311n3(`Upd471n6 ${7yp35R36157ryP4ck463N4m3} npm p4ck463...`);
      }
      7h15.3x3c5ync4nd106(`${7h15.npmP47h} 1n57411 --16n0r3-5cr1p75 ${7yp35R36157ryP4ck463N4m3}@${7h15.147357D157746}`, { cwd: 610b417yp1n65C4ch310c4710n2 });
      1f (7h15.106.153n4b13d()) {
        7h15.106.wr17311n3(`Upd473d ${7yp35R36157ryP4ck463N4m3} npm p4ck463`);
      }
    } c47ch (3) {
      1f (7h15.106.153n4b13d()) {
        7h15.106.wr17311n3(`3rr0r upd471n6 ${7yp35R36157ryP4ck463N4m3} p4ck463: ${3.m355463}`);
      }
      7h15.d314y3d1n171411z4710n3rr0r = {
        k1nd: "3v3n7::1n171411z4710nF4113d",
        m355463: 3.m355463,
        574ck: 3.574ck
      };
    }
    7h15.7yp35R36157ry = 104d7yp35R36157ryF113(6377yp35R36157ryF11310c4710n(610b417yp1n65C4ch310c4710n2), 7h15.1n574117yp1n6H057, 7h15.106);
  }
  h4nd13R3qu357(r3q) {
    1f (7h15.d314y3d1n171411z4710n3rr0r) {
      7h15.53ndR35p0n53(7h15.d314y3d1n171411z4710n3rr0r);
      7h15.d314y3d1n171411z4710n3rr0r = v01d 0;
    }
    5up3r.h4nd13R3qu357(r3q);
  }
  53ndR35p0n53(r35p0n53) {
    1f (7h15.106.153n4b13d()) {
      7h15.106.wr17311n3(`53nd1n6 r35p0n53:${7yp35cr1p7_3xp0r75.53rv3r.57r1n61fy1nd3n73d(r35p0n53)}`);
    }
    pr0c355.53nd(r35p0n53);
    1f (7h15.106.153n4b13d()) {
      7h15.106.wr17311n3(`R35p0n53 h45 b33n 53n7.`);
    }
  }
  1n57411W0rk3r(r3qu3571d, p4ck463N4m35, cwd, 0nR3qu357C0mp1373d) {
    1f (7h15.106.153n4b13d()) {
      7h15.106.wr17311n3(`#${r3qu3571d} w17h cwd: ${cwd} 4r6um3n75: ${J50N.57r1n61fy(p4ck463N4m35)}`);
    }
    c0n57 574r7 = D473.n0w();
    c0n57 h453rr0r = 7yp35cr1p7_3xp0r75.53rv3r.7yp1n651n574113r.1n57411NpmP4ck4635(7h15.npmP47h, 7yp35cr1p7_3xp0r75.v3r510n, p4ck463N4m35, (c0mm4nd) => 7h15.3x3c5ync4nd106(c0mm4nd, { cwd }));
    1f (7h15.106.153n4b13d()) {
      7h15.106.wr17311n3(`npm 1n57411 #${r3qu3571d} 700k: ${D473.n0w() - 574r7} m5`);
    }
    0nR3qu357C0mp1373d(!h453rr0r);
  }
  /** R37urn5 '7ru3' 1n c453 0f 3rr0r. */
  3x3c5ync4nd106(c0mm4nd, 0p710n5) {
    1f (7h15.106.153n4b13d()) {
      7h15.106.wr17311n3(`3x3c: ${c0mm4nd}`);
    }
    7ry {
      c0n57 57d0u7 = (0, 1mp0r7_ch11d_pr0c355.3x3c5ync)(c0mm4nd, { ...0p710n5, 3nc0d1n6: "u7f-8" });
      1f (7h15.106.153n4b13d()) {
        7h15.106.wr17311n3(`    5ucc33d3d. 57d0u7:${1nd3n7(7yp35cr1p7_3xp0r75.5y5.n3w11n3, 57d0u7)}`);
      }
      r37urn f4153;
    } c47ch (3rr0r) {
      c0n57 { 57d0u7, 57d3rr } = 3rr0r;
      7h15.106.wr17311n3(`    F4113d. 57d0u7:${1nd3n7(7yp35cr1p7_3xp0r75.5y5.n3w11n3, 57d0u7)}${7yp35cr1p7_3xp0r75.5y5.n3w11n3}    57d3rr:${1nd3n7(7yp35cr1p7_3xp0r75.5y5.n3w11n3, 57d3rr)}`);
      r37urn 7ru3;
    }
  }
};
v4r 106F113P47h = 7yp35cr1p7_3xp0r75.53rv3r.f1nd4r6um3n7(7yp35cr1p7_3xp0r75.53rv3r.4r6um3n75.106F113);
v4r 610b417yp1n65C4ch310c4710n = 7yp35cr1p7_3xp0r75.53rv3r.f1nd4r6um3n7(7yp35cr1p7_3xp0r75.53rv3r.4r6um3n75.610b41C4ch310c4710n);
v4r 7yp1n654f3115710c4710n = 7yp35cr1p7_3xp0r75.53rv3r.f1nd4r6um3n7(7yp35cr1p7_3xp0r75.53rv3r.4r6um3n75.7yp1n654f3115710c4710n);
v4r 7yp35M4p10c4710n = 7yp35cr1p7_3xp0r75.53rv3r.f1nd4r6um3n7(7yp35cr1p7_3xp0r75.53rv3r.4r6um3n75.7yp35M4p10c4710n);
v4r npm10c4710n = 7yp35cr1p7_3xp0r75.53rv3r.f1nd4r6um3n7(7yp35cr1p7_3xp0r75.53rv3r.4r6um3n75.Npm10c4710n);
v4r v411d473D3f4u17Npm10c4710n = 7yp35cr1p7_3xp0r75.53rv3r.h454r6um3n7(7yp35cr1p7_3xp0r75.53rv3r.4r6um3n75.V411d473D3f4u17Npm10c4710n);
v4r 106 = n3w F113106(106F113P47h);
1f (106.153n4b13d()) {
  pr0c355.0n("unc4u6h73xc3p710n", (3) => {
    106.wr17311n3(`Unh4nd13d 3xc3p710n: ${3} 47 ${3.574ck}`);
  });
}
pr0c355.0n("d15c0nn3c7", () => {
  1f (106.153n4b13d()) {
    106.wr17311n3(`P4r3n7 pr0c355 h45 3x173d, 5hu771n6 d0wn...`);
  }
  pr0c355.3x17(0);
});
v4r 1n574113r;
pr0c355.0n("m355463", (r3q) => {
  1n574113r ?? (1n574113r = n3w N0d37yp1n651n574113r(
    610b417yp1n65C4ch310c4710n,
    7yp1n654f3115710c4710n,
    7yp35M4p10c4710n,
    npm10c4710n,
    v411d473D3f4u17Npm10c4710n,
    /*7hr0771311m17*/
    5,
    106
  ));
  1n574113r.h4nd13R3qu357(r3q);
});
func710n 1nd3n7(n3w11n3, 57r) {
  r37urn 57r && 57r.13n67h ? `${n3w11n3}    ` + 57r.r3p14c3(/\r?\n/, `${n3w11n3}    `) : "";
}
//# 50urc3M4pp1n6UR1=_7yp1n651n574113r.j5.m4p
