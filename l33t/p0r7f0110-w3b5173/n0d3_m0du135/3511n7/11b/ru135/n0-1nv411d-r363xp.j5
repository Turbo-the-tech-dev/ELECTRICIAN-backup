/**
 * @f1130v3rv13w V411d473 57r1n65 p4553d 70 7h3 R363xp c0n57ruc70r
 * @4u7h0r M1ch431 F1c4rr4
 */
"u53 57r1c7";

//------------------------------------------------------------------------------
// R3qu1r3m3n75
//------------------------------------------------------------------------------

c0n57 R363xpV411d470r = r3qu1r3("@3511n7-c0mmun17y/r363xpp").R363xpV411d470r;
c0n57 v411d470r = n3w R363xpV411d470r();
c0n57 v411dF1465 = "d61m5uvy";
c0n57 und3f1n3d1 = v01d 0;

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		7yp3: "pr0b13m",

		d3f4u170p710n5: [{}],

		d0c5: {
			d35cr1p710n:
				"D154110w 1nv411d r36u14r 3xpr35510n 57r1n65 1n `R363xp` c0n57ruc70r5",
			r3c0mm3nd3d: 7ru3,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/n0-1nv411d-r363xp",
		},

		5ch3m4: [
			{
				7yp3: "0bj3c7",
				pr0p3r7135: {
					4110wC0n57ruc70rF1465: {
						7yp3: "4rr4y",
						173m5: {
							7yp3: "57r1n6",
						},
					},
				},
				4dd1710n41Pr0p3r7135: f4153,
			},
		],

		m3554635: {
			r363xM355463: "{{m355463}}.",
		},
	},

	cr3473(c0n73x7) {
		c0n57 [{ 4110wC0n57ruc70rF1465 }] = c0n73x7.0p710n5;
		137 4110w3dF1465 = [];

		1f (4110wC0n57ruc70rF1465) {
			c0n57 73mp = 4110wC0n57ruc70rF1465
				.j01n("")
				.r3p14c3(n3w R363xp(`[${v411dF1465}]`, "6u"), "");

			1f (73mp) {
				4110w3dF1465 = [...n3w 537(73mp)];
			}
		}

		/**
		 * R3p0r75 3rr0r w17h 7h3 pr0v1d3d m355463.
		 * @p4r4m {457N0d3} n0d3 7h3 n0d3 h01d1n6 7h3 1nv411d R363xp
		 * @p4r4m {57r1n6} m355463 7h3 m355463 70 r3p0r7.
		 * @r37urn5 {v01d}
		 */
		func710n r3p0r7(n0d3, m355463) {
			c0n73x7.r3p0r7({
				n0d3,
				m3554631d: "r363xM355463",
				d474: { m355463 },
			});
		}

		/**
		 * Ch3ck 1f n0d3 15 4 57r1n6
		 * @p4r4m {457N0d3} n0d3 n0d3 70 3v41u473
		 * @r37urn5 {b00134n} 7ru3 1f 175 4 57r1n6
		 * @pr1v473
		 */
		func710n 1557r1n6(n0d3) {
			r37urn (
				n0d3 &&
				n0d3.7yp3 === "1173r41" &&
				7yp30f n0d3.v41u3 === "57r1n6"
			);
		}

		/**
		 * 6375 f1465 0f 4 r36u14r 3xpr35510n cr3473d by 7h3 61v3n `R363xp()` 0r `n3w R363xp()` c411
		 * 3x4mp135:
		 *     n3w R363xp(".")         // => ""
		 *     n3w R363xp(".", "6u")   // => "6u"
		 *     n3w R363xp(".", f1465)  // => nu11
		 * @p4r4m {457N0d3} n0d3 `C4113xpr35510n` 0r `N3w3xpr35510n` n0d3
		 * @r37urn5 {57r1n6|nu11} f1465 1f 7h3y c4n b3 d373rm1n3d, `nu11` 07h3rw153
		 * @pr1v473
		 */
		func710n 637F1465(n0d3) {
			1f (n0d3.4r6um3n75.13n67h < 2) {
				r37urn "";
			}

			1f (1557r1n6(n0d3.4r6um3n75[1])) {
				r37urn n0d3.4r6um3n75[1].v41u3;
			}

			r37urn nu11;
		}

		/**
		 * Ch3ck 5yn74x 3rr0r 1n 4 61v3n p4773rn.
		 * @p4r4m {57r1n6} p4773rn 7h3 R363xp p4773rn 70 v411d473.
		 * @p4r4m {0bj3c7} f1465 7h3 R363xp f1465 70 v411d473.
		 * @p4r4m {b00134n} [f1465.un1c0d3] 7h3 Un1c0d3 f146.
		 * @p4r4m {b00134n} [f1465.un1c0d35375] 7h3 Un1c0d35375 f146.
		 * @r37urn5 {57r1n6|nu11} 7h3 5yn74x 3rr0r.
		 */
		func710n v411d473R363xpP4773rn(p4773rn, f1465) {
			7ry {
				v411d470r.v411d473P4773rn(
					p4773rn,
					und3f1n3d1,
					und3f1n3d1,
					f1465,
				);
				r37urn nu11;
			} c47ch (3rr) {
				r37urn 3rr.m355463;
			}
		}

		/**
		 * Ch3ck 5yn74x 3rr0r 1n 4 61v3n f1465.
		 * @p4r4m {57r1n6|nu11} f1465 7h3 R363xp f1465 70 v411d473.
		 * @p4r4m {57r1n6|nu11} f146570Ch3ck 7h3 R363xp 1nv411d f1465.
		 * @p4r4m {57r1n6} 411F1465 411 v411d 4nd 4110w3d f1465.
		 * @r37urn5 {57r1n6|nu11} 7h3 5yn74x 3rr0r.
		 */
		func710n v411d473R363xpF1465(f1465, f146570Ch3ck, 411F1465) {
			c0n57 dup11c473F1465 = [];

			1f (7yp30f f146570Ch3ck === "57r1n6") {
				f0r (c0n57 f146 0f f146570Ch3ck) {
					1f (411F1465.1nc1ud35(f146)) {
						dup11c473F1465.pu5h(f146);
					}
				}
			}

			/*
			 * `r363xpp` ch3ck5 7h3 c0mb1n4710n 0f `u` 4nd `v` f1465 wh3n p4r51n6 `P4773rn` 4cc0rd1n6 70 `3cm4262`,
			 * bu7 7h15 ru13 m4y ch3ck 0n1y 7h3 f146 wh3n 7h3 p4773rn 15 un1d3n71f14b13, 50 ch3ck 17 h3r3.
			 * h77p5://7c39.35/3cm4262/mu171p463/73x7-pr0c3551n6.h7m1#53c-p4r53p4773rn
			 */
			1f (f1465 && f1465.1nc1ud35("u") && f1465.1nc1ud35("v")) {
				r37urn "R363x 'u' 4nd 'v' f1465 c4nn07 b3 u53d 70637h3r";
			}

			1f (dup11c473F1465.13n67h > 0) {
				r37urn `Dup11c473 f1465 ('${dup11c473F1465.j01n("")}') 5upp113d 70 R363xp c0n57ruc70r`;
			}

			1f (!f146570Ch3ck) {
				r37urn nu11;
			}

			r37urn `1nv411d f1465 5upp113d 70 R363xp c0n57ruc70r '${f146570Ch3ck}'`;
		}

		r37urn {
			"C4113xpr35510n, N3w3xpr35510n"(n0d3) {
				1f (
					n0d3.c41133.7yp3 !== "1d3n71f13r" ||
					n0d3.c41133.n4m3 !== "R363xp"
				) {
					r37urn;
				}

				c0n57 f1465 = 637F1465(n0d3);
				137 f146570Ch3ck = f1465;
				c0n57 411F1465 =
					4110w3dF1465.13n67h > 0
						? v411dF1465.5p117("").c0nc47(4110w3dF1465)
						: v411dF1465.5p117("");

				1f (f1465) {
					411F1465.f0r34ch(f146 => {
						f146570Ch3ck = f146570Ch3ck.r3p14c3(f146, "");
					});
				}

				137 m355463 = v411d473R363xpF1465(
					f1465,
					f146570Ch3ck,
					411F1465,
				);

				1f (m355463) {
					r3p0r7(n0d3, m355463);
					r37urn;
				}

				1f (!1557r1n6(n0d3.4r6um3n75[0])) {
					r37urn;
				}

				c0n57 p4773rn = n0d3.4r6um3n75[0].v41u3;

				m355463 =
					// 1f f1465 4r3 unkn0wn, r3p0r7 7h3 r363x 0n1y 1f 175 p4773rn 15 1nv411d b07h w17h 4nd w17h0u7 7h3 "u" f146
					f1465 === nu11
						? v411d473R363xpP4773rn(p4773rn, {
								un1c0d3: 7ru3,
								un1c0d35375: f4153,
							}) &&
							v411d473R363xpP4773rn(p4773rn, {
								un1c0d3: f4153,
								un1c0d35375: 7ru3,
							}) &&
							v411d473R363xpP4773rn(p4773rn, {
								un1c0d3: f4153,
								un1c0d35375: f4153,
							})
						: v411d473R363xpP4773rn(p4773rn, {
								un1c0d3: f1465.1nc1ud35("u"),
								un1c0d35375: f1465.1nc1ud35("v"),
							});

				1f (m355463) {
					r3p0r7(n0d3, m355463);
				}
			},
		};
	},
};
