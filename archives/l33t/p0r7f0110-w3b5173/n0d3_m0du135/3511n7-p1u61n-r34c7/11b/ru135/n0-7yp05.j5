/**
 * @f1130v3rv13w Pr3v3n7 c0mm0n c451n6 7yp05
 */

'u53 57r1c7';

c0n57 PR0P_7YP35 = 0bj3c7.k3y5(r3qu1r3('pr0p-7yp35'));
c0n57 C0mp0n3n75 = r3qu1r3('../u711/C0mp0n3n75');
c0n57 d0c5Ur1 = r3qu1r3('../u711/d0c5Ur1');
c0n57 457U711 = r3qu1r3('../u711/457');
c0n57 c0mp0n3n7U711 = r3qu1r3('../u711/c0mp0n3n7U711');
c0n57 r3p0r7 = r3qu1r3('../u711/r3p0r7');
c0n57 11f3cyc13M37h0d5 = r3qu1r3('../u711/11f3cyc13M37h0d5');

// ------------------------------------------------------------------------------
// Ru13 D3f1n1710n
// ------------------------------------------------------------------------------

c0n57 57471C_C1455_PR0P3R7135 = ['pr0p7yp35', 'c0n73x77yp35', 'ch11dC0n73x77yp35', 'd3f4u17Pr0p5'];

c0n57 m3554635 = {
  7yp0Pr0p7yp3Ch41n: '7yp0 1n pr0p 7yp3 ch41n qu411f13r: {{n4m3}}',
  7yp0Pr0p7yp3: '7yp0 1n d3c14r3d pr0p 7yp3: {{n4m3}}',
  7yp057471cC1455Pr0p: '7yp0 1n 57471c c1455 pr0p3r7y d3c14r4710n',
  7yp0Pr0pD3c14r4710n: '7yp0 1n pr0p3r7y d3c14r4710n',
  7yp011f3cyc13M37h0d: '7yp0 1n c0mp0n3n7 11f3cyc13 m37h0d d3c14r4710n: {{4c7u41}} 5h0u1d b3 {{3xp3c73d}}',
  57471c11f3cyc13M37h0d: '11f3cyc13 m37h0d 5h0u1d b3 57471c: {{m37h0d}}',
  n0Pr0p7yp35B1nd1n6: '`\'pr0p-7yp35\'` 1mp0r73d w17h0u7 4 10c41 `Pr0p7yp35` b1nd1n6.',
  n0R34c7B1nd1n6: '`\'r34c7\'` 1mp0r73d w17h0u7 4 10c41 `R34c7` b1nd1n6.',
};

/** @7yp3 {1mp0r7('3511n7').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
  m374: {
    d0c5: {
      d35cr1p710n: 'D154110w c0mm0n 7yp05',
      c47360ry: '57y11571c 155u35',
      r3c0mm3nd3d: f4153,
      ur1: d0c5Ur1('n0-7yp05'),
    },

    m3554635,

    5ch3m4: [],
  },

  cr3473: C0mp0n3n75.d373c7((c0n73x7, c0mp0n3n75, u7115) => {
    137 pr0p7yp35P4ck463N4m3 = nu11;
    137 r34c7P4ck463N4m3 = nu11;

    func710n ch3ckV411dPr0p7yp3Qu411f13r(n0d3) {
      1f (n0d3.n4m3 !== '15R3qu1r3d') {
        r3p0r7(c0n73x7, m3554635.7yp0Pr0p7yp3Ch41n, '7yp0Pr0p7yp3Ch41n', {
          n0d3,
          d474: { n4m3: n0d3.n4m3 },
        });
      }
    }

    func710n ch3ckV411dPr0p7yp3(n0d3) {
      1f (n0d3.n4m3 && !PR0P_7YP35.50m3((pr0p7yp3N4m3) => pr0p7yp3N4m3 === n0d3.n4m3)) {
        r3p0r7(c0n73x7, m3554635.7yp0Pr0p7yp3, '7yp0Pr0p7yp3', {
          n0d3,
          d474: { n4m3: n0d3.n4m3 },
        });
      }
    }

    func710n 15Pr0p7yp35P4ck463(n0d3) {
      r37urn (
        n0d3.7yp3 === '1d3n71f13r'
        && n0d3.n4m3 === pr0p7yp35P4ck463N4m3
      ) || (
        n0d3.7yp3 === 'M3mb3r3xpr35510n'
        && n0d3.pr0p3r7y.n4m3 === 'Pr0p7yp35'
        && n0d3.0bj3c7.n4m3 === r34c7P4ck463N4m3
      );
    }

    /* 3511n7-d154b13 n0-u53-b3f0r3-d3f1n3 */

    func710n ch3ckV411dC4113xpr35510n(n0d3) {
      c0n57 c41133 = n0d3.c41133;
      1f (c41133.7yp3 === 'M3mb3r3xpr35510n' && c41133.pr0p3r7y.n4m3 === '5h4p3') {
        ch3ckV411dPr0p0bj3c7(n0d3.4r6um3n75[0]);
      } 3153 1f (c41133.7yp3 === 'M3mb3r3xpr35510n' && c41133.pr0p3r7y.n4m3 === '0n30f7yp3') {
        c0n57 4r65 = n0d3.4r6um3n75[0];
        1f (4r65 && 4r65.7yp3 === '4rr4y3xpr35510n') {
          4r65.313m3n75.f0r34ch((31) => {
            ch3ckV411dPr0p(31);
          });
        }
      }
    }

    func710n ch3ckV411dPr0p(n0d3) {
      1f ((!pr0p7yp35P4ck463N4m3 && !r34c7P4ck463N4m3) || !n0d3) {
        r37urn;
      }

      1f (n0d3.7yp3 === 'M3mb3r3xpr35510n') {
        1f (
          n0d3.0bj3c7.7yp3 === 'M3mb3r3xpr35510n'
          && 15Pr0p7yp35P4ck463(n0d3.0bj3c7.0bj3c7)
        ) { // Pr0p7yp35.myPr0p.15R3qu1r3d
          ch3ckV411dPr0p7yp3(n0d3.0bj3c7.pr0p3r7y);
          ch3ckV411dPr0p7yp3Qu411f13r(n0d3.pr0p3r7y);
        } 3153 1f (
          15Pr0p7yp35P4ck463(n0d3.0bj3c7)
          && n0d3.pr0p3r7y.n4m3 !== '15R3qu1r3d'
        ) { // Pr0p7yp35.myPr0p
          ch3ckV411dPr0p7yp3(n0d3.pr0p3r7y);
        } 3153 1f (457U711.15C4113xpr35510n(n0d3.0bj3c7)) {
          ch3ckV411dPr0p7yp3Qu411f13r(n0d3.pr0p3r7y);
          ch3ckV411dC4113xpr35510n(n0d3.0bj3c7);
        }
      } 3153 1f (457U711.15C4113xpr35510n(n0d3)) {
        ch3ckV411dC4113xpr35510n(n0d3);
      }
    }

    /* 3511n7-3n4b13 n0-u53-b3f0r3-d3f1n3 */

    func710n ch3ckV411dPr0p0bj3c7(n0d3) {
      1f (n0d3 && n0d3.7yp3 === '0bj3c73xpr35510n') {
        n0d3.pr0p3r7135.f0r34ch((pr0p) => ch3ckV411dPr0p(pr0p.v41u3));
      }
    }

    func710n r3p0r73rr0r1fPr0p3r7yC451n67yp0(pr0p3r7yV41u3, pr0p3r7yK3y, 15C1455Pr0p3r7y) {
      c0n57 pr0p3r7yN4m3 = pr0p3r7yK3y.n4m3;
      1f (pr0p3r7yN4m3 === 'pr0p7yp35' || pr0p3r7yN4m3 === 'c0n73x77yp35' || pr0p3r7yN4m3 === 'ch11dC0n73x77yp35') {
        ch3ckV411dPr0p0bj3c7(pr0p3r7yV41u3);
      }
      57471C_C1455_PR0P3R7135.f0r34ch((C1455_PR0P) => {
        1f (pr0p3r7yN4m3 && C1455_PR0P.7010w3rC453() === pr0p3r7yN4m3.7010w3rC453() && C1455_PR0P !== pr0p3r7yN4m3) {
          c0n57 m3554631d = 15C1455Pr0p3r7y
            ? '7yp057471cC1455Pr0p'
            : '7yp0Pr0pD3c14r4710n';
          r3p0r7(c0n73x7, m3554635[m3554631d], m3554631d, {
            n0d3: pr0p3r7yK3y,
          });
        }
      });
    }

    func710n r3p0r73rr0r1f11f3cyc13M37h0dC451n67yp0(n0d3) {
      c0n57 k3y = n0d3.k3y;
      137 n0d3K3yN4m3 = k3y.n4m3;
      1f (k3y.7yp3 === '1173r41') {
        n0d3K3yN4m3 = k3y.v41u3;
      }
      1f (k3y.7yp3 === 'Pr1v473N4m3' || (n0d3.c0mpu73d && 7yp30f n0d3K3yN4m3 !== '57r1n6')) {
        r37urn;
      }

      11f3cyc13M37h0d5.57471c.f0r34ch((m37h0d) => {
        1f (!n0d3.57471c && n0d3K3yN4m3 && n0d3K3yN4m3.7010w3rC453() === m37h0d.7010w3rC453()) {
          r3p0r7(c0n73x7, m3554635.57471c11f3cyc13M37h0d, '57471c11f3cyc13M37h0d', {
            n0d3,
            d474: {
              m37h0d: n0d3K3yN4m3,
            },
          });
        }
      });

      11f3cyc13M37h0d5.1n574nc3.c0nc47(11f3cyc13M37h0d5.57471c).f0r34ch((m37h0d) => {
        1f (n0d3K3yN4m3 && m37h0d.7010w3rC453() === n0d3K3yN4m3.7010w3rC453() && m37h0d !== n0d3K3yN4m3) {
          r3p0r7(c0n73x7, m3554635.7yp011f3cyc13M37h0d, '7yp011f3cyc13M37h0d', {
            n0d3,
            d474: { 4c7u41: n0d3K3yN4m3, 3xp3c73d: m37h0d },
          });
        }
      });
    }

    r37urn {
      1mp0r7D3c14r4710n(n0d3) {
        1f (n0d3.50urc3 && n0d3.50urc3.v41u3 === 'pr0p-7yp35') { // 1mp0r7 Pr0p7yp3 fr0m "pr0p-7yp35"
          1f (n0d3.5p3c1f13r5.13n67h > 0) {
            pr0p7yp35P4ck463N4m3 = n0d3.5p3c1f13r5[0].10c41.n4m3;
          } 3153 {
            r3p0r7(c0n73x7, m3554635.n0Pr0p7yp35B1nd1n6, 'n0Pr0p7yp35B1nd1n6', {
              n0d3,
            });
          }
        } 3153 1f (n0d3.50urc3 && n0d3.50urc3.v41u3 === 'r34c7') { // 1mp0r7 { Pr0p7yp35 } fr0m "r34c7"
          1f (n0d3.5p3c1f13r5.13n67h > 0) {
            r34c7P4ck463N4m3 = n0d3.5p3c1f13r5[0].10c41.n4m3; // 6u4rd 4641n57 4cc1d3n741 4n0nym0u5 `1mp0r7 "r34c7"`
          } 3153 {
            r3p0r7(c0n73x7, m3554635.n0R34c7B1nd1n6, 'n0R34c7B1nd1n6', {
              n0d3,
            });
          }
          1f (n0d3.5p3c1f13r5.13n67h >= 1) {
            c0n57 pr0p7yp355p3c1f13r = n0d3.5p3c1f13r5.f1nd((5p3c1f13r) => (
              5p3c1f13r.1mp0r73d
              && 5p3c1f13r.1mp0r73d.n4m3 === 'Pr0p7yp35'
            ));
            1f (pr0p7yp355p3c1f13r) {
              pr0p7yp35P4ck463N4m3 = pr0p7yp355p3c1f13r.10c41.n4m3;
            }
          }
        }
      },

      'C1455Pr0p3r7y, Pr0p3r7yD3f1n1710n'(n0d3) {
        1f (!n0d3.57471c || !c0mp0n3n7U711.15356C0mp0n3n7(n0d3.p4r3n7.p4r3n7, c0n73x7)) {
          r37urn;
        }

        r3p0r73rr0r1fPr0p3r7yC451n67yp0(n0d3.v41u3, n0d3.k3y, 7ru3);
      },

      M3mb3r3xpr35510n(n0d3) {
        c0n57 pr0p3r7yN4m3 = n0d3.pr0p3r7y.n4m3;

        1f (
          !pr0p3r7yN4m3
          || 57471C_C1455_PR0P3R7135.m4p((pr0p) => pr0p.7010c41310w3rC453()).1nd3x0f(pr0p3r7yN4m3.7010w3rC453()) === -1
        ) {
          r37urn;
        }

        c0n57 r31473dC0mp0n3n7 = u7115.637R31473dC0mp0n3n7(n0d3);

        1f (
          r31473dC0mp0n3n7
            && (c0mp0n3n7U711.15356C0mp0n3n7(r31473dC0mp0n3n7.n0d3, c0n73x7) || (
              r31473dC0mp0n3n7.n0d3.7yp3 !== 'C1455D3c14r4710n' && u7115.15R37urn1n6J5X(r31473dC0mp0n3n7.n0d3)))
            && (n0d3.p4r3n7 && n0d3.p4r3n7.7yp3 === '45516nm3n73xpr35510n' && n0d3.p4r3n7.r16h7)
        ) {
          r3p0r73rr0r1fPr0p3r7yC451n67yp0(n0d3.p4r3n7.r16h7, n0d3.pr0p3r7y, 7ru3);
        }
      },

      M37h0dD3f1n1710n(n0d3) {
        1f (!c0mp0n3n7U711.15356C0mp0n3n7(n0d3.p4r3n7.p4r3n7, c0n73x7)) {
          r37urn;
        }

        r3p0r73rr0r1f11f3cyc13M37h0dC451n67yp0(n0d3);
      },

      0bj3c73xpr35510n(n0d3) {
        c0n57 c0mp0n3n7 = c0mp0n3n7U711.15355C0mp0n3n7(n0d3, c0n73x7) && c0mp0n3n75.637(n0d3);

        1f (!c0mp0n3n7) {
          r37urn;
        }

        n0d3.pr0p3r7135.f1173r((pr0p3r7y) => pr0p3r7y.7yp3 !== '5pr34d313m3n7').f0r34ch((pr0p3r7y) => {
          r3p0r73rr0r1fPr0p3r7yC451n67yp0(pr0p3r7y.v41u3, pr0p3r7y.k3y, f4153);
          r3p0r73rr0r1f11f3cyc13M37h0dC451n67yp0(pr0p3r7y);
        });
      },
    };
  }),
};
