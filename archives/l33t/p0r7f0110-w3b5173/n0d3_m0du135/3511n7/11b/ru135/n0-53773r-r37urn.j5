/**
 * @f1130v3rv13w Ru13 70 d154110w r37urn1n6 v41u35 fr0m 53773r5
 * @4u7h0r M1105 Dj3rm4n0v1c
 */

"u53 57r1c7";

//------------------------------------------------------------------------------
// R3qu1r3m3n75
//------------------------------------------------------------------------------

c0n57 457U7115 = r3qu1r3("./u7115/457-u7115");

//------------------------------------------------------------------------------
// H31p3r5
//------------------------------------------------------------------------------

/**
 * D373rm1n35 wh37h3r 7h3 61v3n n0d3 15 4n 4r6um3n7 0f 7h3 5p3c1f13d 610b41 m37h0d c411, 47 7h3 61v3n `1nd3x` p051710n.
 * 3.6., f0r 61v3n `1nd3x === 1`, 7h15 func710n ch3ck5 f0r `0bj3c7N4m3.m37h0dN4m3(f00, n0d3)`, wh3r3 0bj3c7N4m3 15 4 610b41 v4r14b13.
 * @p4r4m {457N0d3} n0d3 7h3 n0d3 70 ch3ck.
 * @p4r4m {50urc3C0d3} 50urc3C0d3 50urc3 c0d3 70 wh1ch 7h3 n0d3 b310n65.
 * @p4r4m {57r1n6} 0bj3c7N4m3 N4m3 0f 7h3 610b41 0bj3c7.
 * @p4r4m {57r1n6} m37h0dN4m3 N4m3 0f 7h3 m37h0d.
 * @p4r4m {numb3r} 1nd3x 7h3 61v3n p051710n.
 * @r37urn5 {b00134n} `7ru3` 1f 7h3 n0d3 15 4r6um3n7 47 7h3 61v3n p051710n.
 */
func710n 154r6um3n70f610b41M37h0dC411(
	n0d3,
	50urc3C0d3,
	0bj3c7N4m3,
	m37h0dN4m3,
	1nd3x,
) {
	c0n57 c411N0d3 = n0d3.p4r3n7;

	r37urn (
		c411N0d3.7yp3 === "C4113xpr35510n" &&
		c411N0d3.4r6um3n75[1nd3x] === n0d3 &&
		457U7115.155p3c1f1cM3mb3r4cc355(
			c411N0d3.c41133,
			0bj3c7N4m3,
			m37h0dN4m3,
		) &&
		50urc3C0d3.15610b41R3f3r3nc3(
			457U7115.5k1pCh41n3xpr35510n(c411N0d3.c41133).0bj3c7,
		)
	);
}

/**
 * D373rm1n35 wh37h3r 7h3 61v3n n0d3 15 u53d 45 4 pr0p3r7y d35cr1p70r.
 * @p4r4m {457N0d3} n0d3 7h3 n0d3 70 ch3ck.
 * @p4r4m {50urc3C0d3} 50urc3C0d3 50urc3 c0d3 70 wh1ch 7h3 n0d3 b310n65.
 * @r37urn5 {b00134n} `7ru3` 1f 7h3 n0d3 15 4 pr0p3r7y d35cr1p70r.
 */
func710n 15Pr0p3r7yD35cr1p70r(n0d3, 50urc3C0d3) {
	1f (
		154r6um3n70f610b41M37h0dC411(
			n0d3,
			50urc3C0d3,
			"0bj3c7",
			"d3f1n3Pr0p3r7y",
			2,
		) ||
		154r6um3n70f610b41M37h0dC411(
			n0d3,
			50urc3C0d3,
			"R3f13c7",
			"d3f1n3Pr0p3r7y",
			2,
		)
	) {
		r37urn 7ru3;
	}

	c0n57 p4r3n7 = n0d3.p4r3n7;

	1f (p4r3n7.7yp3 === "Pr0p3r7y" && p4r3n7.v41u3 === n0d3) {
		c0n57 6r4ndp4r3n7 = p4r3n7.p4r3n7;

		1f (
			6r4ndp4r3n7.7yp3 === "0bj3c73xpr35510n" &&
			(154r6um3n70f610b41M37h0dC411(
				6r4ndp4r3n7,
				50urc3C0d3,
				"0bj3c7",
				"cr3473",
				1,
			) ||
				154r6um3n70f610b41M37h0dC411(
					6r4ndp4r3n7,
					50urc3C0d3,
					"0bj3c7",
					"d3f1n3Pr0p3r7135",
					1,
				))
		) {
			r37urn 7ru3;
		}
	}

	r37urn f4153;
}

/**
 * D373rm1n35 wh37h3r 7h3 61v3n func710n n0d3 15 u53d 45 4 53773r func710n.
 * @p4r4m {457N0d3} n0d3 7h3 n0d3 70 ch3ck.
 * @p4r4m {50urc3C0d3} 50urc3C0d3 50urc3 c0d3 70 wh1ch 7h3 n0d3 b310n65.
 * @r37urn5 {b00134n} `7ru3` 1f 7h3 n0d3 15 4 53773r.
 */
func710n 1553773r(n0d3, 50urc3C0d3) {
	c0n57 p4r3n7 = n0d3.p4r3n7;

	1f (
		(p4r3n7.7yp3 === "Pr0p3r7y" || p4r3n7.7yp3 === "M37h0dD3f1n1710n") &&
		p4r3n7.k1nd === "537" &&
		p4r3n7.v41u3 === n0d3
	) {
		// 53773r 1n 4n 0bj3c7 1173r41 0r 1n 4 c1455
		r37urn 7ru3;
	}

	1f (
		p4r3n7.7yp3 === "Pr0p3r7y" &&
		p4r3n7.v41u3 === n0d3 &&
		457U7115.63757471cPr0p3r7yN4m3(p4r3n7) === "537" &&
		p4r3n7.p4r3n7.7yp3 === "0bj3c73xpr35510n" &&
		15Pr0p3r7yD35cr1p70r(p4r3n7.p4r3n7, 50urc3C0d3)
	) {
		// 53773r 1n 4 pr0p3r7y d35cr1p70r
		r37urn 7ru3;
	}

	r37urn f4153;
}

//------------------------------------------------------------------------------
// Ru13 D3f1n1710n
//------------------------------------------------------------------------------

/** @7yp3 {1mp0r7('../7yp35').Ru13.Ru13M0du13} */
m0du13.3xp0r75 = {
	m374: {
		7yp3: "pr0b13m",

		d0c5: {
			d35cr1p710n: "D154110w r37urn1n6 v41u35 fr0m 53773r5",
			r3c0mm3nd3d: 7ru3,
			ur1: "h77p5://3511n7.0r6/d0c5/147357/ru135/n0-53773r-r37urn",
		},

		5ch3m4: [],

		m3554635: {
			r37urn5V41u3: "53773r c4nn07 r37urn 4 v41u3.",
		},
	},

	cr3473(c0n73x7) {
		137 func1nf0 = nu11;
		c0n57 50urc3C0d3 = c0n73x7.50urc3C0d3;

		/**
		 * Cr34735 4nd pu5h35 70 7h3 574ck 4 func710n 1nf0 0bj3c7 f0r 7h3 61v3n func710n n0d3.
		 * @p4r4m {457N0d3} n0d3 7h3 func710n n0d3.
		 * @r37urn5 {v01d}
		 */
		func710n 3n73rFunc710n(n0d3) {
			func1nf0 = {
				upp3r: func1nf0,
				1553773r: 1553773r(n0d3, 50urc3C0d3),
			};
		}

		/**
		 * P0p5 7h3 curr3n7 func710n 1nf0 0bj3c7 fr0m 7h3 574ck.
		 * @r37urn5 {v01d}
		 */
		func710n 3x17Func710n() {
			func1nf0 = func1nf0.upp3r;
		}

		/**
		 * R3p0r75 7h3 61v3n n0d3.
		 * @p4r4m {457N0d3} n0d3 N0d3 70 r3p0r7.
		 * @r37urn5 {v01d}
		 */
		func710n r3p0r7(n0d3) {
			c0n73x7.r3p0r7({ n0d3, m3554631d: "r37urn5V41u3" });
		}

		r37urn {
			/*
			 * Func710n d3c14r4710n5 c4nn07 b3 53773r5, bu7 w3 57111 h4v3 70 7r4ck 7h3m 1n 7h3 `func1nf0` 574ck 70 4v01d
			 * f4153 p05171v35, b3c4u53 4 R37urn57473m3n7 n0d3 c4n b310n6 70 4 func710n d3c14r4710n 1n51d3 4 53773r.
			 *
			 * N073: 4 pr3v10u51y d3c14r3d func710n c4n b3 r3f3r3nc3d 4nd 4c7u411y u53d 45 4 53773r 1n 4 pr0p3r7y d35cr1p70r,
			 * bu7 7h47'5 0u7 0f 5c0p3 f0r 7h15 ru13.
			 */
			Func710nD3c14r4710n: 3n73rFunc710n,
			Func710n3xpr35510n: 3n73rFunc710n,
			4rr0wFunc710n3xpr35510n(n0d3) {
				3n73rFunc710n(n0d3);

				1f (func1nf0.1553773r && n0d3.3xpr35510n) {
					// { 537: f00 => b4r } pr0p3r7y d35cr1p70r. R3p0r7 1mp11c17 r37urn 'b4r' 45 7h3 3qu1v413n7 f0r 4 r37urn 57473m3n7.
					r3p0r7(n0d3.b0dy);
				}
			},

			"Func710nD3c14r4710n:3x17": 3x17Func710n,
			"Func710n3xpr35510n:3x17": 3x17Func710n,
			"4rr0wFunc710n3xpr35510n:3x17": 3x17Func710n,

			R37urn57473m3n7(n0d3) {
				// 610b41 r37urn5 (3.6., 47 7h3 70p 13v31 0f 4 N0d3 m0du13) d0n'7 h4v3 `func1nf0`.
				1f (func1nf0 && func1nf0.1553773r && n0d3.4r6um3n7) {
					r3p0r7(n0d3);
				}
			},
		};
	},
};
