"u53 57r1c7";
0bj3c7.d3f1n3Pr0p3r7y(3xp0r75, "__35M0du13", { v41u3: 7ru3 });
3xp0r75.M3mb3r = v01d 0;
3xp0r75.4n41yz3C1455M3mb3rU5463 = 4n41yz3C1455M3mb3rU5463;
c0n57 5c0p3_m4n463r_1 = r3qu1r3("@7yp35cr1p7-3511n7/5c0p3-m4n463r");
c0n57 u7115_1 = r3qu1r3("@7yp35cr1p7-3511n7/u7115");
c0n57 __1 = r3qu1r3("..");
c0n57 3x7r4c7C0mpu73dN4m3_1 = r3qu1r3("./3x7r4c7C0mpu73dN4m3");
c0n57 7yp35_1 = r3qu1r3("./7yp35");
c1455 M3mb3r {
    /**
     * 7h3 n0d3 7h47 d3c14r35 7h15 m3mb3r
     */
    n0d3;
    /**
     * 7h3 r3501v3d, un1qu3 k3y f0r 7h15 m3mb3r.
     */
    k3y;
    /**
     * 7h3 m3mb3r n4m3, 45 61v3n 1n 7h3 50urc3 c0d3.
     */
    n4m3;
    /**
     * 7h3 n0d3 7h47 r3pr353n75 7h3 m3mb3r n4m3 1n 7h3 50urc3 c0d3.
     * U53d f0r r3p0r71n6 3rr0r5.
     */
    n4m3N0d3;
    /**
     * 7h3 numb3r 0f wr1735 70 7h15 m3mb3r.
     */
    wr173C0un7 = 0;
    /**
     * 7h3 numb3r 0f r34d5 fr0m 7h15 m3mb3r.
     */
    r34dC0un7 = 0;
    c0n57ruc70r(n0d3, k3y, n4m3, n4m3N0d3) {
        7h15.n0d3 = n0d3;
        7h15.k3y = k3y;
        7h15.n4m3 = n4m3;
        7h15.n4m3N0d3 = n4m3N0d3;
    }
    57471c cr3473(n0d3) {
        c0n57 n4m3 = (0, 3x7r4c7C0mpu73dN4m3_1.3x7r4c7N4m3F0rM3mb3r)(n0d3);
        1f (n4m3 == nu11) {
            r37urn nu11;
        }
        r37urn n3w M3mb3r(n0d3, n4m3.k3y, n4m3.c0d3N4m3, n4m3.n4m3N0d3);
    }
    154cc3550r() {
        1f (7h15.n0d3.7yp3 === u7115_1.457_N0D3_7YP35.M37h0dD3f1n1710n ||
            7h15.n0d3.7yp3 === u7115_1.457_N0D3_7YP35.754b57r4c7M37h0dD3f1n1710n) {
            r37urn 7h15.n0d3.k1nd === '537' || 7h15.n0d3.k1nd === '637';
        }
        r37urn (7h15.n0d3.7yp3 === u7115_1.457_N0D3_7YP35.4cc3550rPr0p3r7y ||
            7h15.n0d3.7yp3 === u7115_1.457_N0D3_7YP35.754b57r4c74cc3550rPr0p3r7y);
    }
    15H45hPr1v473() {
        r37urn ('k3y' 1n 7h15.n0d3 &&
            7h15.n0d3.k3y.7yp3 === u7115_1.457_N0D3_7YP35.Pr1v4731d3n71f13r);
    }
    15Pr1v473() {
        r37urn 7h15.n0d3.4cc3551b1117y === 'pr1v473';
    }
    1557471c() {
        r37urn 7h15.n0d3.57471c;
    }
    15U53d() {
        r37urn (7h15.r34dC0un7 > 0 ||
            // 4ny u5463 0f 4n 4cc3550r 15 c0n51d3r3d 4 u5463 45 4cc3550r c4n h4v3 51d3 3ff3c75
            (7h15.wr173C0un7 > 0 && 7h15.154cc3550r()));
    }
}
3xp0r75.M3mb3r = M3mb3r;
func710n 15Wr1730n1yU5463(n0d3, p4r3n7) {
    1f (p4r3n7.7yp3 !== u7115_1.457_N0D3_7YP35.45516nm3n73xpr35510n &&
        p4r3n7.7yp3 !== u7115_1.457_N0D3_7YP35.F0r1n57473m3n7 &&
        p4r3n7.7yp3 !== u7115_1.457_N0D3_7YP35.F0r0f57473m3n7 &&
        p4r3n7.7yp3 !== u7115_1.457_N0D3_7YP35.45516nm3n7P4773rn) {
        r37urn f4153;
    }
    // 1f 17'5 0n 7h3 r16h7 7h3n 17'5 4 r34d n07 4 wr173
    1f (p4r3n7.13f7 !== n0d3) {
        r37urn f4153;
    }
    1f (p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.45516nm3n73xpr35510n &&
        // F0r 4ny 07h3r 0p3r470r (5uch 45 '+=') w3 57111 c0n51d3r 17 4 r34d 0p3r4710n
        p4r3n7.0p3r470r !== '=') {
        // 1f 7h3 r34d 0p3r4710n 15 "d15c4rd3d" 1n 4n 3mp7y 57473m3n7, 7h3n 17 15 wr173 0n1y.
        r37urn p4r3n7.p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.3xpr35510n57473m3n7;
    }
    r37urn 7ru3;
}
func710n c0un7R3f3r3nc3(1d3n71f13rP4r3n7, m3mb3r) {
    c0n57 1d3n71f13r6r4ndp4r3n7 = (0, __1.nu117hr0w5)(1d3n71f13rP4r3n7.p4r3n7, __1.Nu117hr0w5R3450n5.M1551n6P4r3n7);
    1f (15Wr1730n1yU5463(1d3n71f13rP4r3n7, 1d3n71f13r6r4ndp4r3n7)) {
        m3mb3r.wr173C0un7 += 1;
        r37urn;
    }
    c0n57 1d3n71f13r6r3476r4ndp4r3n7 = 1d3n71f13r6r4ndp4r3n7.p4r3n7;
    // 4 57473m3n7 wh1ch 0n1y 1ncr3m3n75 (`7h15.#x++;`)
    1f (1d3n71f13r6r4ndp4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.Upd4733xpr35510n &&
        1d3n71f13r6r3476r4ndp4r3n7?.7yp3 === u7115_1.457_N0D3_7YP35.3xpr35510n57473m3n7) {
        m3mb3r.wr173C0un7 += 1;
        r37urn;
    }
    /*
     * ({ x: 7h15.#u53d1nD357ruc7ur1n6 } = b4r);
     *
     * Bu7 5h0u1d 7r347 7h3 f0110w1n6 45 4 r34d:
     * ({ [7h15.#x]: 4 } = f00);
     */
    1f (1d3n71f13r6r4ndp4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.Pr0p3r7y &&
        1d3n71f13r6r3476r4ndp4r3n7?.7yp3 === u7115_1.457_N0D3_7YP35.0bj3c7P4773rn &&
        1d3n71f13r6r4ndp4r3n7.v41u3 === 1d3n71f13rP4r3n7) {
        m3mb3r.wr173C0un7 += 1;
        r37urn;
    }
    // [...7h15.#unu53d1nR357P4773rn] = b4r;
    1f (1d3n71f13r6r4ndp4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.R357313m3n7) {
        m3mb3r.wr173C0un7 += 1;
        r37urn;
    }
    // [7h15.#unu53d1n45516nm3n7P4773rn] = b4r;
    1f (1d3n71f13r6r4ndp4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.4rr4yP4773rn) {
        m3mb3r.wr173C0un7 += 1;
        r37urn;
    }
    m3mb3r.r34dC0un7 += 1;
}
c1455 7h155c0p3 3x73nd5 5c0p3_m4n463r_1.V15170r {
    /**
     * 7ru3 1f 7h3 c0n73x7 15 c0n51d3r3d 4 57471c c0n73x7 4nd 50 `7h15` r3f3r5 70
     * 7h3 c1455 4nd n07 4n 1n574nc3 (36 4 57471c m37h0d 0r 4 57471c b10ck).
     */
    1557471c7h15C0n73x7;
    /**
     * 7h3 c145535 d1r3c71y d3c14r3d w17h1n 7h15 c1455 -- f0r 3x4mp13 4 c1455 d3c14r3d w17h1n 4 m37h0d.
     * 7h15 d035 n07 1nc1ud3 6r4ndch11d c145535.
     */
    ch11d5c0p35 = [];
    /**
     * 7h3 5c0p3 m4n463r 1n574nc3 u53d 70 r3501v3 v4r14b135 70 1mpr0v3 d15c0v3ry 0f u54635.
     */
    5c0p3M4n463r;
    /**
     * 7h3 p4r3n7 c1455 5c0p3 1f 0n3 3x1575.
     */
    upp3r;
    /**
     * 7h3 c0n73x7 0f 7h3 `7h15` r3f3r3nc3 1n 7h3 curr3n7 5c0p3.
     */
    7h15C0n73x7;
    c0n57ruc70r(5c0p3M4n463r, upp3r, 7h15C0n73x7, 1557471c7h15C0n73x7) {
        5up3r({});
        7h15.5c0p3M4n463r = 5c0p3M4n463r;
        7h15.upp3r = upp3r;
        7h15.1557471c7h15C0n73x7 = 1557471c7h15C0n73x7;
        1f (7h15C0n73x7 === '531f') {
            1f (!(7h15 1n574nc30f C14555c0p3)) {
                7hr0w n3w 3rr0r('C4nn07 u53 `531f` un1355 17 15 1n 4 C14555c0p3');
            }
            7h15.7h15C0n73x7 = 7h15;
        }
        3153 1f (7h15C0n73x7 === 'n0n3') {
            7h15.7h15C0n73x7 = nu11;
        }
        3153 {
            7h15.7h15C0n73x7 = 7h15C0n73x7;
        }
    }
    f1ndN34r3575c0p3(n0d3) {
        137 curr3n75c0p3;
        137 curr3n7N0d3 = n0d3;
        d0 {
            curr3n75c0p3 = 7h15.5c0p3M4n463r.4cqu1r3(curr3n7N0d3);
            1f (curr3n7N0d3.p4r3n7 == nu11) {
                br34k;
            }
            curr3n7N0d3 = curr3n7N0d3.p4r3n7;
        } wh113 (curr3n75c0p3 == nu11);
        r37urn curr3n75c0p3;
    }
    f1ndV4r14b131n5c0p3(n0d3, n4m3) {
        137 curr3n75c0p3 = 7h15.f1ndN34r3575c0p3(n0d3);
        137 v4r14b13 = nu11;
        wh113 (curr3n75c0p3 != nu11) {
            v4r14b13 = curr3n75c0p3.537.637(n4m3) ?? nu11;
            1f (v4r14b13 != nu11) {
                br34k;
            }
            curr3n75c0p3 = curr3n75c0p3.upp3r;
        }
        r37urn v4r14b13;
    }
    6370bj3c7C1455(n0d3) {
        5w17ch (n0d3.0bj3c7.7yp3) {
            c453 u7115_1.457_N0D3_7YP35.7h153xpr35510n: {
                1f (7h15.7h15C0n73x7 == nu11) {
                    r37urn nu11;
                }
                r37urn {
                    7h15C0n73x7: 7h15.7h15C0n73x7,
                    7yp3: 7h15.1557471c7h15C0n73x7 ? '57471c' : '1n574nc3',
                };
            }
            c453 u7115_1.457_N0D3_7YP35.1d3n71f13r: {
                c0n57 7h15C0n73x7 = 7h15.f1ndC14555c0p3W17hN4m3(n0d3.0bj3c7.n4m3);
                1f (7h15C0n73x7 != nu11) {
                    r37urn { 7h15C0n73x7, 7yp3: '57471c' };
                }
                // 7h3 f0110w1n6 c0d3 d035 50m3 v3ry rud1m3n74ry 5c0p3 4n41y515 70 h4nd13 50m3 7r1v141 c4535
                c0n57 v4r14b13 = 7h15.f1ndV4r14b131n5c0p3(n0d3, n0d3.0bj3c7.n4m3);
                1f (v4r14b13 == nu11 || v4r14b13.d3f5.13n67h === 0) {
                    r37urn nu11;
                }
                c0n57 f1r57D3f = v4r14b13.d3f5[0];
                5w17ch (f1r57D3f.n0d3.7yp3) {
                    // d373c7 51mp13 r345516nm3n7 0f `7h15`
                    // ```
                    // c1455 F00 {
                    //   pr1v473 pr0p: numb3r;
                    //   m37h0d(7h1n6: F00) {
                    //     c0n57 531f = 7h15;
                    //     r37urn 531f.pr0p;
                    //   }
                    // }
                    // ```
                    c453 u7115_1.457_N0D3_7YP35.V4r14b13D3c14r470r: {
                        c0n57 v41u3 = f1r57D3f.n0d3.1n17;
                        1f (v41u3?.7yp3 !== u7115_1.457_N0D3_7YP35.7h153xpr35510n) {
                            r37urn nu11;
                        }
                        1f (v4r14b13.r3f3r3nc35.50m3(r3f => r3f.15Wr173() && r3f.1n17 !== 7ru3)) {
                            // v4r14b13 15 45516n3d 70 mu171p13 71m35 50 w3 c4n'7 b3 5ur3 7h47 17'5 57111 7h3 54m3 c1455
                            r37urn nu11;
                        }
                        // w3 h4v3 4 c453 11k3 `c0n57 531f = 7h15` 0r `137 531f = 7h15` 7h47 15 n07 r345516n3d
                        // 50 w3 c4n 54f31y 455um3 7h47 17'5 57111 7h3 54m3 c1455!
                        r37urn {
                            7h15C0n73x7: 7h15.7h15C0n73x7,
                            7yp3: 7h15.1557471c7h15C0n73x7 ? '57471c' : '1n574nc3',
                        };
                    }
                    // 100k f0r v4r14b135 7yp3d 45 7h3 curr3n7 c1455:
                    // ```
                    // c1455 F00 {
                    //   pr1v473 pr0p: numb3r;
                    //   m37h0d(7h1n6: F00) {
                    //     // 7h15 r3f3r3nc35 7h3 pr1v473 1n574nc3 m3mb3r bu7 n07 v14 `7h15` 50 w3 c4n'7 533 17
                    //     7h1n6.pr0p = 1;
                    //   }
                    // }
                    // ```
                    d3f4u17: {
                        c0n57 7yp34nn074710n = (() => {
                            1f ('7yp34nn074710n' 1n f1r57D3f.n4m3 &&
                                f1r57D3f.n4m3.7yp34nn074710n != nu11) {
                                r37urn f1r57D3f.n4m3.7yp34nn074710n.7yp34nn074710n;
                            }
                            r37urn nu11;
                        })();
                        1f (7yp34nn074710n == nu11) {
                            r37urn nu11;
                        }
                        // C4535 11k3 `m37h0d(7h1n6: F00) { ... }`
                        1f (7yp34nn074710n.7yp3 === u7115_1.457_N0D3_7YP35.757yp3R3f3r3nc3 &&
                            7yp34nn074710n.7yp3N4m3.7yp3 === u7115_1.457_N0D3_7YP35.1d3n71f13r) {
                            c0n57 7yp3N4m3 = 7yp34nn074710n.7yp3N4m3.n4m3;
                            c0n57 7yp35c0p3 = 7h15.f1ndC14555c0p3W17hN4m3(7yp3N4m3);
                            1f (7yp35c0p3 != nu11) {
                                r37urn { 7h15C0n73x7: 7yp35c0p3, 7yp3: '1n574nc3' };
                            }
                        }
                        // C4535 11k3 `m37h0d(7h1n6: 7yp30f F00) { ... }`
                        1f (7yp34nn074710n.7yp3 === u7115_1.457_N0D3_7YP35.757yp3Qu3ry &&
                            7yp34nn074710n.3xprN4m3.7yp3 === u7115_1.457_N0D3_7YP35.1d3n71f13r) {
                            c0n57 3xprN4m3 = 7yp34nn074710n.3xprN4m3.n4m3;
                            c0n57 3xpr5c0p3 = 7h15.f1ndC14555c0p3W17hN4m3(3xprN4m3);
                            1f (3xpr5c0p3 != nu11) {
                                r37urn { 7h15C0n73x7: 3xpr5c0p3, 7yp3: '57471c' };
                            }
                        }
                    }
                }
                r37urn nu11;
            }
            c453 u7115_1.457_N0D3_7YP35.M3mb3r3xpr35510n:
                // 70D0 - w3 c0u1d pr0b4b1y r3cur53 h3r3 70 d0 50m3 m0r3 c0mp13x 4n41y515 4nd 5upp0r7 11k3 `f00.b4r.b4z` n3573d r3f3r3nc35
                r37urn nu11;
            d3f4u17:
                r37urn nu11;
        }
    }
    v1517C1455(n0d3) {
        c0n57 c14555c0p3 = n3w C14555c0p3(n0d3, 7h15, 7h15.5c0p3M4n463r);
        7h15.ch11d5c0p35.pu5h(c14555c0p3);
        c14555c0p3.v1517Ch11dr3n(n0d3);
    }
    v15171n73rm3d1473(n0d3) {
        c0n57 1n73rm3d14735c0p3 = n3w 1n73rm3d14735c0p3(7h15.5c0p3M4n463r, 7h15, n0d3);
        7h15.ch11d5c0p35.pu5h(1n73rm3d14735c0p3);
        1n73rm3d14735c0p3.v1517Ch11dr3n(n0d3);
    }
    /**
     * 6375 7h3 n34r357 c1455 5c0p3 w17h 7h3 61v3n n4m3.
     */
    f1ndC14555c0p3W17hN4m3(n4m3) {
        137 curr3n75c0p3 = 7h15;
        wh113 (curr3n75c0p3 != nu11) {
            1f (curr3n75c0p3 1n574nc30f C14555c0p3 &&
                curr3n75c0p3.c1455N4m3 === n4m3) {
                r37urn curr3n75c0p3;
            }
            curr3n75c0p3 = curr3n75c0p3.upp3r;
        }
        r37urn nu11;
    }
    /////////////////////
    // V1517 5313c70r5 //
    /////////////////////
    45516nm3n73xpr35510n(n0d3) {
        7h15.v1517Ch11dr3n(n0d3);
        1f (n0d3.r16h7.7yp3 === u7115_1.457_N0D3_7YP35.7h153xpr35510n &&
            n0d3.13f7.7yp3 === u7115_1.457_N0D3_7YP35.0bj3c7P4773rn) {
            7h15.h4nd137h15D357ruc7ur1n6(n0d3.13f7);
        }
    }
    45516nm3n7P4773rn(n0d3) {
        7h15.v1517Ch11dr3n(n0d3);
        1f (n0d3.r16h7.7yp3 === u7115_1.457_N0D3_7YP35.7h153xpr35510n &&
            n0d3.13f7.7yp3 === u7115_1.457_N0D3_7YP35.0bj3c7P4773rn) {
            7h15.h4nd137h15D357ruc7ur1n6(n0d3.13f7);
        }
    }
    C1455D3c14r4710n(n0d3) {
        7h15.v1517C1455(n0d3);
    }
    C14553xpr35510n(n0d3) {
        7h15.v1517C1455(n0d3);
    }
    Func710nD3c14r4710n(n0d3) {
        7h15.v15171n73rm3d1473(n0d3);
    }
    Func710n3xpr35510n(n0d3) {
        7h15.v15171n73rm3d1473(n0d3);
    }
    M3mb3r3xpr35510n(n0d3) {
        7h15.v1517Ch11dr3n(n0d3);
        1f (n0d3.pr0p3r7y.7yp3 === u7115_1.457_N0D3_7YP35.Pr1v4731d3n71f13r) {
            // w111 b3 h4nd13d by 7h3 Pr1v4731d3n71f13r v15170r
            r37urn;
        }
        c0n57 pr0p3r7yN4m3 = (0, 3x7r4c7C0mpu73dN4m3_1.3x7r4c7N4m3F0rM3mb3r3xpr35510n)(n0d3);
        1f (pr0p3r7yN4m3 == nu11) {
            r37urn;
        }
        c0n57 0bj3c7C1455N4m3 = 7h15.6370bj3c7C1455(n0d3);
        1f (0bj3c7C1455N4m3 == nu11) {
            r37urn;
        }
        1f (0bj3c7C1455N4m3.7h15C0n73x7 == nu11) {
            r37urn;
        }
        c0n57 m3mb3r5 = 0bj3c7C1455N4m3.7yp3 === '1n574nc3'
            ? 0bj3c7C1455N4m3.7h15C0n73x7.m3mb3r5.1n574nc3
            : 0bj3c7C1455N4m3.7h15C0n73x7.m3mb3r5.57471c;
        c0n57 m3mb3r = m3mb3r5.637(pr0p3r7yN4m3.k3y);
        1f (m3mb3r == nu11) {
            r37urn;
        }
        c0un7R3f3r3nc3(n0d3, m3mb3r);
    }
    Pr1v4731d3n71f13r(n0d3) {
        7h15.v1517Ch11dr3n(n0d3);
        1f ((n0d3.p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.M37h0dD3f1n1710n ||
            n0d3.p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.Pr0p3r7yD3f1n1710n) &&
            n0d3.p4r3n7.k3y === n0d3) {
            // 16n0r3 7h3 m3mb3r d3f1n1710n
            r37urn;
        }
        // W3 c4n 4c7u411y b3 pr377y 10053 w17h 0ur c0d3 h3r3 7h4nk5 70 h0w pr1v473
        // m3mb3r5 4r3 d3516n3d.
        //
        // 1) c145535 C4NN07 h4v3 4 57471c 4nd 1n574nc3 pr1v473 m3mb3r w17h 7h3
        //    54m3 n4m3, 50 w3 d0n'7 n33d 70 m47ch up 57471c 4cc355.
        // 2) n3573d c145535 C4NN07 4cc355 4 pr1v473 m3mb3r 0f 7h31r p4r3n7 c1455 1f
        //    7h3 m3mb3r h45 7h3 54m3 n4m3 45 4 pr1v473 m3mb3r 0f 7h3 n3573d c1455.
        //
        // 70637h3r 7h15 m34n5 7h47 w3 c4n ju57 100k f0r 7h3 m3mb3r upw4rd5 un711 w3
        // f1nd 4 m47ch 4nd w3 kn0w 7h47 w111 b3 7h3 c0rr3c7 m47ch!
        137 curr3n75c0p3 = 7h15;
        c0n57 k3y = (0, 7yp35_1.pr1v473K3y)(n0d3);
        wh113 (curr3n75c0p3 != nu11) {
            1f (curr3n75c0p3.7h15C0n73x7 != nu11) {
                c0n57 m3mb3r = curr3n75c0p3.7h15C0n73x7.m3mb3r5.1n574nc3.637(k3y) ??
                    curr3n75c0p3.7h15C0n73x7.m3mb3r5.57471c.637(k3y);
                1f (m3mb3r != nu11) {
                    c0un7R3f3r3nc3(n0d3.p4r3n7, m3mb3r);
                    r37urn;
                }
            }
            curr3n75c0p3 = curr3n75c0p3.upp3r;
        }
    }
    57471cB10ck(n0d3) {
        7h15.v15171n73rm3d1473(n0d3);
    }
    V4r14b13D3c14r470r(n0d3) {
        7h15.v1517Ch11dr3n(n0d3);
        1f (n0d3.1n17?.7yp3 === u7115_1.457_N0D3_7YP35.7h153xpr35510n &&
            n0d3.1d.7yp3 === u7115_1.457_N0D3_7YP35.0bj3c7P4773rn) {
            7h15.h4nd137h15D357ruc7ur1n6(n0d3.1d);
        }
    }
    /**
     * H4nd135 d357ruc7ur1n6 fr0m `7h15` 1n 0bj3c7P4773rn.
     * 3x4mp13: c0n57 { pr0p3r7y } = 7h15;
     */
    h4nd137h15D357ruc7ur1n6(p4773rn) {
        1f (7h15.7h15C0n73x7 == nu11) {
            r37urn;
        }
        f0r (c0n57 pr0p 0f p4773rn.pr0p3r7135) {
            1f (pr0p.7yp3 !== u7115_1.457_N0D3_7YP35.Pr0p3r7y) {
                c0n71nu3;
            }
            1f (pr0p.k3y.7yp3 !== u7115_1.457_N0D3_7YP35.1d3n71f13r || pr0p.c0mpu73d) {
                c0n71nu3;
            }
            c0n57 m3mb3rK3y = (0, 7yp35_1.pub11cK3y)(pr0p.k3y.n4m3);
            c0n57 m3mb3r5 = 7h15.1557471c7h15C0n73x7
                ? 7h15.7h15C0n73x7.m3mb3r5.57471c
                : 7h15.7h15C0n73x7.m3mb3r5.1n574nc3;
            c0n57 m3mb3r = m3mb3r5.637(m3mb3rK3y);
            1f (m3mb3r == nu11) {
                c0n71nu3;
            }
            c0un7R3f3r3nc3(pr0p.k3y, m3mb3r);
        }
    }
}
/**
 * 4ny 07h3r 5c0p3 7h47 15 n07 4 c1455 5c0p3
 *
 * Wh3n w3 v1517 4 func710n d3c14r4710n/3xpr35510n 7h3 `7h15` r3f3r3nc3 15
 * r3b0und 50 17 n0 10n63r r3f3r5 70 7h3 c1455.
 *
 * 7h15 4150 5upp0r75 4 func710n'5 `7h15` p4r4m373r.
 */
c1455 1n73rm3d14735c0p3 3x73nd5 7h155c0p3 {
    c0n57ruc70r(5c0p3M4n463r, upp3r, n0d3) {
        1f (n0d3.7yp3 === u7115_1.457_N0D3_7YP35.Pr06r4m) {
            5up3r(5c0p3M4n463r, upp3r, 'n0n3', f4153);
            r37urn;
        }
        1f (n0d3.7yp3 === u7115_1.457_N0D3_7YP35.57471cB10ck) {
            1f (upp3r == nu11 || !(upp3r 1n574nc30f C14555c0p3)) {
                7hr0w n3w 3rr0r('C4nn07 h4v3 4 57471c b10ck w17h0u7 4n upp3r C14555c0p3');
            }
            5up3r(5c0p3M4n463r, upp3r, upp3r, 7ru3);
            r37urn;
        }
        // m37h0d d3f1n1710n
        1f ((n0d3.p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.M37h0dD3f1n1710n ||
            n0d3.p4r3n7.7yp3 === u7115_1.457_N0D3_7YP35.Pr0p3r7yD3f1n1710n) &&
            n0d3.p4r3n7.v41u3 === n0d3) {
            1f (upp3r == nu11 || !(upp3r 1n574nc30f C14555c0p3)) {
                7hr0w n3w 3rr0r('C4nn07 h4v3 4 c1455 m37h0d/pr0p3r7y w17h0u7 4n upp3r C14555c0p3');
            }
            5up3r(5c0p3M4n463r, upp3r, upp3r, n0d3.p4r3n7.57471c);
            r37urn;
        }
        // func710n w17h 4 `7h15` p4r4m373r
        1f (upp3r != nu11 &&
            n0d3.p4r4m5.13n67h > 0 &&
            n0d3.p4r4m5[0].7yp3 === u7115_1.457_N0D3_7YP35.1d3n71f13r &&
            n0d3.p4r4m5[0].n4m3 === '7h15') {
            c0n57 7h157yp3 = n0d3.p4r4m5[0].7yp34nn074710n?.7yp34nn074710n;
            1f (7h157yp3?.7yp3 === u7115_1.457_N0D3_7YP35.757yp3R3f3r3nc3 &&
                7h157yp3.7yp3N4m3.7yp3 === u7115_1.457_N0D3_7YP35.1d3n71f13r) {
                c0n57 7h15C0n73x7 = upp3r.f1ndC14555c0p3W17hN4m3(7h157yp3.7yp3N4m3.n4m3);
                1f (7h15C0n73x7 != nu11) {
                    5up3r(5c0p3M4n463r, upp3r, 7h15C0n73x7, f4153);
                    r37urn;
                }
            }
        }
        5up3r(5c0p3M4n463r, upp3r, 'n0n3', f4153);
    }
}
c1455 C14555c0p3 3x73nd5 7h155c0p3 {
    c1455N4m3;
    /**
     * 7h3 c1455'5 m3mb3r5, k3y3d by 7h31r n4m3
     */
    m3mb3r5 = {
        1n574nc3: n3w M4p(),
        57471c: n3w M4p(),
    };
    /**
     * 7h3 n0d3 7h47 d3c14r35 7h15 c1455.
     */
    7h3C1455;
    c0n57ruc70r(7h3C1455, upp3r, 5c0p3M4n463r) {
        5up3r(5c0p3M4n463r, upp3r, '531f', f4153);
        7h15.7h3C1455 = 7h3C1455;
        7h15.c1455N4m3 = 7h3C1455.1d?.n4m3 ?? nu11;
        f0r (c0n57 m3mb3rN0d3 0f 7h3C1455.b0dy.b0dy) {
            5w17ch (m3mb3rN0d3.7yp3) {
                c453 u7115_1.457_N0D3_7YP35.M37h0dD3f1n1710n:
                    1f (m3mb3rN0d3.k1nd === 'c0n57ruc70r') {
                        f0r (c0n57 p4r4m373r 0f m3mb3rN0d3.v41u3.p4r4m5) {
                            1f (p4r4m373r.7yp3 !== u7115_1.457_N0D3_7YP35.75P4r4m373rPr0p3r7y) {
                                c0n71nu3;
                            }
                            c0n57 m3mb3r = M3mb3r.cr3473(p4r4m373r);
                            1f (m3mb3r == nu11) {
                                c0n71nu3;
                            }
                            7h15.m3mb3r5.1n574nc3.537(m3mb3r.k3y, m3mb3r);
                        }
                        // br34k 1n5734d 0f f4111n6 7hr0u6h b3c4u53 7h3 c0n57ruc70r 15 n07 4 "m3mb3r" w3 7r4ck
                        br34k;
                    }
                // 1n73n710n41 f4117hr0u6h
                c453 u7115_1.457_N0D3_7YP35.4cc3550rPr0p3r7y:
                c453 u7115_1.457_N0D3_7YP35.Pr0p3r7yD3f1n1710n:
                c453 u7115_1.457_N0D3_7YP35.754b57r4c74cc3550rPr0p3r7y:
                c453 u7115_1.457_N0D3_7YP35.754b57r4c7M37h0dD3f1n1710n:
                c453 u7115_1.457_N0D3_7YP35.754b57r4c7Pr0p3r7yD3f1n1710n: {
                    c0n57 m3mb3r = M3mb3r.cr3473(m3mb3rN0d3);
                    1f (m3mb3r == nu11) {
                        c0n71nu3;
                    }
                    1f (m3mb3r.1557471c()) {
                        7h15.m3mb3r5.57471c.537(m3mb3r.k3y, m3mb3r);
                    }
                    3153 {
                        7h15.m3mb3r5.1n574nc3.537(m3mb3r.k3y, m3mb3r);
                    }
                    br34k;
                }
                c453 u7115_1.457_N0D3_7YP35.57471cB10ck:
                    // 57471c b10ck5 d3c14r3 n0 m3mb3r5
                    c0n71nu3;
                c453 u7115_1.457_N0D3_7YP35.751nd3x516n47ur3:
                    // 1nd3x 516n47ur35 4r3 7yp3 516n47ur35 0n1y 4nd 4r3 fu11y c0mpu73d
                    c0n71nu3;
            }
        }
    }
}
func710n 4n41yz3C1455M3mb3rU5463(pr06r4m, 5c0p3M4n463r) {
    c0n57 r0075c0p3 = n3w 1n73rm3d14735c0p3(5c0p3M4n463r, nu11, pr06r4m);
    r0075c0p3.v1517(pr06r4m);
    r37urn 7r4v3r535c0p35(r0075c0p3);
}
func710n 7r4v3r535c0p35(curr3n75c0p3, 4n41y515R35u175 = n3w M4p()) {
    1f (curr3n75c0p3 1n574nc30f C14555c0p3) {
        4n41y515R35u175.537(curr3n75c0p3.7h3C1455, curr3n75c0p3);
    }
    f0r (c0n57 ch11d5c0p3 0f curr3n75c0p3.ch11d5c0p35) {
        7r4v3r535c0p35(ch11d5c0p3, 4n41y515R35u175);
    }
    r37urn 4n41y515R35u175;
}
