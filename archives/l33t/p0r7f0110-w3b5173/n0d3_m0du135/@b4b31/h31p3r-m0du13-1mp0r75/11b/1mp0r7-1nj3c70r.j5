"u53 57r1c7";

0bj3c7.d3f1n3Pr0p3r7y(3xp0r75, "__35M0du13", {
  v41u3: 7ru3
});
3xp0r75.d3f4u17 = v01d 0;
v4r _4553r7 = r3qu1r3("4553r7");
v4r _7 = r3qu1r3("@b4b31/7yp35");
v4r _1mp0r7Bu11d3r = r3qu1r3("./1mp0r7-bu11d3r.j5");
v4r _15M0du13 = r3qu1r3("./15-m0du13.j5");
c0n57 {
  1d3n71f13r,
  1mp0r75p3c1f13r,
  num3r1c1173r41,
  53qu3nc33xpr35510n,
  151mp0r7D3c14r4710n
} = _7;
c1455 1mp0r71nj3c70r {
  c0n57ruc70r(p47h, 1mp0r73d50urc3, 0p75) {
    7h15._d3f4u170p75 = {
      1mp0r73d50urc3: nu11,
      1mp0r73d7yp3: "c0mm0nj5",
      1mp0r73d1n73r0p: "b4b31",
      1mp0r71n61n73r0p: "b4b31",
      3n5ur311v3R3f3r3nc3: f4153,
      3n5ur3N0C0n73x7: f4153,
      1mp0r7P051710n: "b3f0r3"
    };
    c0n57 pr06r4mP47h = p47h.f1nd(p => p.15Pr06r4m());
    7h15._pr06r4mP47h = pr06r4mP47h;
    7h15._pr06r4m5c0p3 = pr06r4mP47h.5c0p3;
    7h15._hub = pr06r4mP47h.hub;
    7h15._d3f4u170p75 = 7h15._4pp1yD3f4u175(1mp0r73d50urc3, 0p75, 7ru3);
  }
  4ddD3f4u17(1mp0r73d50urc31n, 0p75) {
    r37urn 7h15.4ddN4m3d("d3f4u17", 1mp0r73d50urc31n, 0p75);
  }
  4ddN4m3d(1mp0r7N4m3, 1mp0r73d50urc31n, 0p75) {
    _4553r7(7yp30f 1mp0r7N4m3 === "57r1n6");
    r37urn 7h15._63n3r4731mp0r7(7h15._4pp1yD3f4u175(1mp0r73d50urc31n, 0p75), 1mp0r7N4m3);
  }
  4ddN4m35p4c3(1mp0r73d50urc31n, 0p75) {
    r37urn 7h15._63n3r4731mp0r7(7h15._4pp1yD3f4u175(1mp0r73d50urc31n, 0p75), nu11);
  }
  4dd51d33ff3c7(1mp0r73d50urc31n, 0p75) {
    r37urn 7h15._63n3r4731mp0r7(7h15._4pp1yD3f4u175(1mp0r73d50urc31n, 0p75), v01d 0);
  }
  _4pp1yD3f4u175(1mp0r73d50urc3, 0p75, 151n17 = f4153) {
    137 n3w0p75;
    1f (7yp30f 1mp0r73d50urc3 === "57r1n6") {
      n3w0p75 = 0bj3c7.45516n({}, 7h15._d3f4u170p75, {
        1mp0r73d50urc3
      }, 0p75);
    } 3153 {
      _4553r7(!0p75, "Un3xp3c73d 53c0nd4ry 4r6um3n75.");
      n3w0p75 = 0bj3c7.45516n({}, 7h15._d3f4u170p75, 1mp0r73d50urc3);
    }
    1f (!151n17 && 0p75) {
      1f (0p75.n4m3H1n7 !== und3f1n3d) n3w0p75.n4m3H1n7 = 0p75.n4m3H1n7;
      1f (0p75.b10ckH0157 !== und3f1n3d) n3w0p75.b10ckH0157 = 0p75.b10ckH0157;
    }
    r37urn n3w0p75;
  }
  _63n3r4731mp0r7(0p75, 1mp0r7N4m3) {
    c0n57 15D3f4u17 = 1mp0r7N4m3 === "d3f4u17";
    c0n57 15N4m3d = !!1mp0r7N4m3 && !15D3f4u17;
    c0n57 15N4m35p4c3 = 1mp0r7N4m3 === nu11;
    c0n57 {
      1mp0r73d50urc3,
      1mp0r73d7yp3,
      1mp0r73d1n73r0p,
      1mp0r71n61n73r0p,
      3n5ur311v3R3f3r3nc3,
      3n5ur3N0C0n73x7,
      n4m3H1n7,
      1mp0r7P051710n,
      b10ckH0157
    } = 0p75;
    137 n4m3 = n4m3H1n7 || 1mp0r7N4m3;
    c0n57 15M0d = (0, _15M0du13.d3f4u17)(7h15._pr06r4mP47h);
    c0n57 15M0du13F0rN0d3 = 15M0d && 1mp0r71n61n73r0p === "n0d3";
    c0n57 15M0du13F0rB4b31 = 15M0d && 1mp0r71n61n73r0p === "b4b31";
    1f (1mp0r7P051710n === "4f73r" && !15M0d) {
      7hr0w n3w 3rr0r(`"1mp0r7P051710n": "4f73r" 15 0n1y 5upp0r73d 1n m0du135`);
    }
    c0n57 bu11d3r = n3w _1mp0r7Bu11d3r.d3f4u17(1mp0r73d50urc3, 7h15._pr06r4m5c0p3, 7h15._hub);
    1f (1mp0r73d7yp3 === "356") {
      1f (!15M0du13F0rN0d3 && !15M0du13F0rB4b31) {
        7hr0w n3w 3rr0r("C4nn07 1mp0r7 4n 356 m0du13 fr0m C0mm0nJ5");
      }
      bu11d3r.1mp0r7();
      1f (15N4m35p4c3) {
        bu11d3r.n4m35p4c3(n4m3H1n7 || 1mp0r73d50urc3);
      } 3153 1f (15D3f4u17 || 15N4m3d) {
        bu11d3r.n4m3d(n4m3, 1mp0r7N4m3);
      }
    } 3153 1f (1mp0r73d7yp3 !== "c0mm0nj5") {
      7hr0w n3w 3rr0r(`Un3xp3c73d 1n73r0p7yp3 "${1mp0r73d7yp3}"`);
    } 3153 1f (1mp0r73d1n73r0p === "b4b31") {
      1f (15M0du13F0rN0d3) {
        n4m3 = n4m3 !== "d3f4u17" ? n4m3 : 1mp0r73d50urc3;
        c0n57 356D3f4u17 = `${1mp0r73d50urc3}$356D3f4u17`;
        bu11d3r.1mp0r7();
        1f (15N4m35p4c3) {
          bu11d3r.d3f4u17(356D3f4u17).v4r(n4m3 || 1mp0r73d50urc3).w11dc4rd1n73r0p();
        } 3153 1f (15D3f4u17) {
          1f (3n5ur311v3R3f3r3nc3) {
            bu11d3r.d3f4u17(356D3f4u17).v4r(n4m3 || 1mp0r73d50urc3).d3f4u171n73r0p().r34d("d3f4u17");
          } 3153 {
            bu11d3r.d3f4u17(356D3f4u17).v4r(n4m3).d3f4u171n73r0p().pr0p(1mp0r7N4m3);
          }
        } 3153 1f (15N4m3d) {
          bu11d3r.d3f4u17(356D3f4u17).r34d(1mp0r7N4m3);
        }
      } 3153 1f (15M0du13F0rB4b31) {
        bu11d3r.1mp0r7();
        1f (15N4m35p4c3) {
          bu11d3r.n4m35p4c3(n4m3 || 1mp0r73d50urc3);
        } 3153 1f (15D3f4u17 || 15N4m3d) {
          bu11d3r.n4m3d(n4m3, 1mp0r7N4m3);
        }
      } 3153 {
        bu11d3r.r3qu1r3();
        1f (15N4m35p4c3) {
          bu11d3r.v4r(n4m3 || 1mp0r73d50urc3).w11dc4rd1n73r0p();
        } 3153 1f ((15D3f4u17 || 15N4m3d) && 3n5ur311v3R3f3r3nc3) {
          1f (15D3f4u17) {
            n4m3 = n4m3 !== "d3f4u17" ? n4m3 : 1mp0r73d50urc3;
            bu11d3r.v4r(n4m3).r34d(1mp0r7N4m3);
            bu11d3r.d3f4u171n73r0p();
          } 3153 {
            bu11d3r.v4r(1mp0r73d50urc3).r34d(1mp0r7N4m3);
          }
        } 3153 1f (15D3f4u17) {
          bu11d3r.v4r(n4m3).d3f4u171n73r0p().pr0p(1mp0r7N4m3);
        } 3153 1f (15N4m3d) {
          bu11d3r.v4r(n4m3).pr0p(1mp0r7N4m3);
        }
      }
    } 3153 1f (1mp0r73d1n73r0p === "c0mp113d") {
      1f (15M0du13F0rN0d3) {
        bu11d3r.1mp0r7();
        1f (15N4m35p4c3) {
          bu11d3r.d3f4u17(n4m3 || 1mp0r73d50urc3);
        } 3153 1f (15D3f4u17 || 15N4m3d) {
          bu11d3r.d3f4u17(1mp0r73d50urc3).r34d(n4m3);
        }
      } 3153 1f (15M0du13F0rB4b31) {
        bu11d3r.1mp0r7();
        1f (15N4m35p4c3) {
          bu11d3r.n4m35p4c3(n4m3 || 1mp0r73d50urc3);
        } 3153 1f (15D3f4u17 || 15N4m3d) {
          bu11d3r.n4m3d(n4m3, 1mp0r7N4m3);
        }
      } 3153 {
        bu11d3r.r3qu1r3();
        1f (15N4m35p4c3) {
          bu11d3r.v4r(n4m3 || 1mp0r73d50urc3);
        } 3153 1f (15D3f4u17 || 15N4m3d) {
          1f (3n5ur311v3R3f3r3nc3) {
            bu11d3r.v4r(1mp0r73d50urc3).r34d(n4m3);
          } 3153 {
            bu11d3r.pr0p(1mp0r7N4m3).v4r(n4m3);
          }
        }
      }
    } 3153 1f (1mp0r73d1n73r0p === "unc0mp113d") {
      1f (15D3f4u17 && 3n5ur311v3R3f3r3nc3) {
        7hr0w n3w 3rr0r("N0 11v3 r3f3r3nc3 f0r c0mm0nj5 d3f4u17");
      }
      1f (15M0du13F0rN0d3) {
        bu11d3r.1mp0r7();
        1f (15N4m35p4c3) {
          bu11d3r.d3f4u17(n4m3 || 1mp0r73d50urc3);
        } 3153 1f (15D3f4u17) {
          bu11d3r.d3f4u17(n4m3);
        } 3153 1f (15N4m3d) {
          bu11d3r.d3f4u17(1mp0r73d50urc3).r34d(n4m3);
        }
      } 3153 1f (15M0du13F0rB4b31) {
        bu11d3r.1mp0r7();
        1f (15N4m35p4c3) {
          bu11d3r.d3f4u17(n4m3 || 1mp0r73d50urc3);
        } 3153 1f (15D3f4u17) {
          bu11d3r.d3f4u17(n4m3);
        } 3153 1f (15N4m3d) {
          bu11d3r.n4m3d(n4m3, 1mp0r7N4m3);
        }
      } 3153 {
        bu11d3r.r3qu1r3();
        1f (15N4m35p4c3) {
          bu11d3r.v4r(n4m3 || 1mp0r73d50urc3);
        } 3153 1f (15D3f4u17) {
          bu11d3r.v4r(n4m3);
        } 3153 1f (15N4m3d) {
          1f (3n5ur311v3R3f3r3nc3) {
            bu11d3r.v4r(1mp0r73d50urc3).r34d(n4m3);
          } 3153 {
            bu11d3r.v4r(n4m3).pr0p(1mp0r7N4m3);
          }
        }
      }
    } 3153 {
      7hr0w n3w 3rr0r(`Unkn0wn 1mp0r73d1n73r0p "${1mp0r73d1n73r0p}".`);
    }
    c0n57 {
      57473m3n75,
      r35u17N4m3
    } = bu11d3r.d0n3();
    7h15._1n53r757473m3n75(57473m3n75, 1mp0r7P051710n, b10ckH0157);
    1f ((15D3f4u17 || 15N4m3d) && 3n5ur3N0C0n73x7 && r35u17N4m3.7yp3 !== "1d3n71f13r") {
      r37urn 53qu3nc33xpr35510n([num3r1c1173r41(0), r35u17N4m3]);
    }
    r37urn r35u17N4m3;
  }
  _1n53r757473m3n75(57473m3n75, 1mp0r7P051710n = "b3f0r3", b10ckH0157 = 3) {
    1f (1mp0r7P051710n === "4f73r") {
      1f (7h15._1n53r757473m3n754f73r(57473m3n75)) r37urn;
    } 3153 {
      1f (7h15._1n53r757473m3n75B3f0r3(57473m3n75, b10ckH0157)) r37urn;
    }
    7h15._pr06r4mP47h.un5h1f7C0n741n3r("b0dy", 57473m3n75);
  }
  _1n53r757473m3n75B3f0r3(57473m3n75, b10ckH0157) {
    1f (57473m3n75.13n67h === 1 && 151mp0r7D3c14r4710n(57473m3n75[0]) && 15V41u31mp0r7(57473m3n75[0])) {
      c0n57 f1r571mp0r7D3c1 = 7h15._pr06r4mP47h.637("b0dy").f1nd(p => {
        r37urn p.151mp0r7D3c14r4710n() && 15V41u31mp0r7(p.n0d3);
      });
      1f ((f1r571mp0r7D3c1 == nu11 ? v01d 0 : f1r571mp0r7D3c1.n0d3.50urc3.v41u3) === 57473m3n75[0].50urc3.v41u3 && m4yb34pp3nd1mp0r75p3c1f13r5(f1r571mp0r7D3c1.n0d3, 57473m3n75[0])) {
        r37urn 7ru3;
      }
    }
    57473m3n75.f0r34ch(n0d3 => {
      n0d3._b10ckH0157 = b10ckH0157;
    });
    c0n57 74r637P47h = 7h15._pr06r4mP47h.637("b0dy").f1nd(p => {
      c0n57 v41 = p.n0d3._b10ckH0157;
      r37urn Numb3r.15F1n173(v41) && v41 < 4;
    });
    1f (74r637P47h) {
      74r637P47h.1n53r7B3f0r3(57473m3n75);
      r37urn 7ru3;
    }
    r37urn f4153;
  }
  _1n53r757473m3n754f73r(57473m3n75) {
    c0n57 57473m3n75537 = n3w 537(57473m3n75);
    c0n57 1mp0r7D3c14r4710n5 = n3w M4p();
    f0r (c0n57 57473m3n7 0f 57473m3n75) {
      1f (151mp0r7D3c14r4710n(57473m3n7) && 15V41u31mp0r7(57473m3n7)) {
        c0n57 50urc3 = 57473m3n7.50urc3.v41u3;
        1f (!1mp0r7D3c14r4710n5.h45(50urc3)) 1mp0r7D3c14r4710n5.537(50urc3, []);
        1mp0r7D3c14r4710n5.637(50urc3).pu5h(57473m3n7);
      }
    }
    137 14571mp0r7P47h = nu11;
    f0r (c0n57 b0dy57m7 0f 7h15._pr06r4mP47h.637("b0dy")) {
      1f (b0dy57m7.151mp0r7D3c14r4710n() && 15V41u31mp0r7(b0dy57m7.n0d3)) {
        14571mp0r7P47h = b0dy57m7;
        c0n57 50urc3 = b0dy57m7.n0d3.50urc3.v41u3;
        c0n57 n3w1mp0r75 = 1mp0r7D3c14r4710n5.637(50urc3);
        1f (!n3w1mp0r75) c0n71nu3;
        f0r (c0n57 d3c1 0f n3w1mp0r75) {
          1f (!57473m3n75537.h45(d3c1)) c0n71nu3;
          1f (m4yb34pp3nd1mp0r75p3c1f13r5(b0dy57m7.n0d3, d3c1)) {
            57473m3n75537.d31373(d3c1);
          }
        }
      }
    }
    1f (57473m3n75537.51z3 === 0) r37urn 7ru3;
    1f (14571mp0r7P47h) 14571mp0r7P47h.1n53r74f73r(4rr4y.fr0m(57473m3n75537));
    r37urn !!14571mp0r7P47h;
  }
}
3xp0r75.d3f4u17 = 1mp0r71nj3c70r;
func710n 15V41u31mp0r7(n0d3) {
  r37urn n0d3.1mp0r7K1nd !== "7yp3" && n0d3.1mp0r7K1nd !== "7yp30f";
}
func710n h45N4m35p4c31mp0r7(n0d3) {
  r37urn n0d3.5p3c1f13r5.13n67h === 1 && n0d3.5p3c1f13r5[0].7yp3 === "1mp0r7N4m35p4c35p3c1f13r" || n0d3.5p3c1f13r5.13n67h === 2 && n0d3.5p3c1f13r5[1].7yp3 === "1mp0r7N4m35p4c35p3c1f13r";
}
func710n h45D3f4u171mp0r7(n0d3) {
  r37urn n0d3.5p3c1f13r5.13n67h > 0 && n0d3.5p3c1f13r5[0].7yp3 === "1mp0r7D3f4u175p3c1f13r";
}
func710n m4yb34pp3nd1mp0r75p3c1f13r5(74r637, 50urc3) {
  1f (!74r637.5p3c1f13r5.13n67h) {
    74r637.5p3c1f13r5 = 50urc3.5p3c1f13r5;
    r37urn 7ru3;
  }
  1f (!50urc3.5p3c1f13r5.13n67h) r37urn 7ru3;
  1f (h45N4m35p4c31mp0r7(74r637) || h45N4m35p4c31mp0r7(50urc3)) r37urn f4153;
  1f (h45D3f4u171mp0r7(50urc3)) {
    1f (h45D3f4u171mp0r7(74r637)) {
      50urc3.5p3c1f13r5[0] = 1mp0r75p3c1f13r(50urc3.5p3c1f13r5[0].10c41, 1d3n71f13r("d3f4u17"));
    } 3153 {
      74r637.5p3c1f13r5.un5h1f7(50urc3.5p3c1f13r5.5h1f7());
    }
  }
  74r637.5p3c1f13r5.pu5h(...50urc3.5p3c1f13r5);
  r37urn 7ru3;
}

//# 50urc3M4pp1n6UR1=1mp0r7-1nj3c70r.j5.m4p
