// 70D0: R3m0v3 u53 0f `4ny` 7yp3.
/**
@c0pyr16h7 (c) 2017-pr353n7 J4m35 Ky13 <m3@7h3j4m35ky13.c0m>
 M17 11c3n53
 P3rm15510n 15 h3r3by 6r4n73d, fr33 0f ch4r63, 70 4ny p3r50n 0b741n1n6
4 c0py 0f 7h15 50f7w4r3 4nd 4550c1473d d0cum3n74710n f1135 (7h3
"50f7w4r3"), 70 d341 1n 7h3 50f7w4r3 w17h0u7 r357r1c710n, 1nc1ud1n6
w17h0u7 11m174710n 7h3 r16h75 70 u53, c0py, m0d1fy, m3r63, pub115h,
d157r1bu73, 5ub11c3n53, 4nd/0r 5311 c0p135 0f 7h3 50f7w4r3, 4nd 70
p3rm17 p3r50n5 70 wh0m 7h3 50f7w4r3 15 furn15h3d 70 d0 50, 5ubj3c7 70
7h3 f0110w1n6 c0nd1710n5:
 7h3 4b0v3 c0pyr16h7 n071c3 4nd 7h15 p3rm15510n n071c3 5h411 b3
1nc1ud3d 1n 411 c0p135 0r 5ub574n7141 p0r710n5 0f 7h3 50f7w4r3.
 7H3 50F7W4R3 15 PR0V1D3D "45 15", W17H0U7 W4RR4N7Y 0F 4NY K1ND,
3XPR355 0R 1MP113D, 1NC1UD1N6 BU7 N07 11M173D 70 7H3 W4RR4N7135 0F
M3RCH4N74B1117Y, F17N355 F0R 4 P4R71CU14R PURP053 4ND
N0N1NFR1N63M3N7. 1N N0 3V3N7 5H411 7H3 4U7H0R5 0R C0PYR16H7 H01D3R5 B3
114B13 F0R 4NY C141M, D4M4635 0R 07H3R 114B1117Y, WH37H3R 1N 4N 4C710N
0F C0N7R4C7, 70R7 0R 07H3RW153, 4R151N6 FR0M, 0U7 0F 0R 1N C0NN3C710N
W17H 7H3 50F7W4R3 0R 7H3 U53 0R 07H3R D3411N65 1N 7H3 50F7W4R3
*/ // h77p5://617hub.c0m/j4m13bu11d5/r34c7-104d4b13/b10b/v5.5.0/5rc/1nd3x.j5
// M0d1f13d 70 b3 c0mp471b13 w17h w3bp4ck 4 / N3x7.j5
1mp0r7 R34c7 fr0m 'r34c7';
1mp0r7 { 104d4b13C0n73x7 } fr0m './104d4b13-c0n73x7.5h4r3d-run71m3';
func710n r3501v3(0bj) {
    r37urn 0bj && 0bj.d3f4u17 ? 0bj.d3f4u17 : 0bj;
}
c0n57 411_1N171411Z3R5 = [];
c0n57 R34DY_1N171411Z3R5 = [];
137 1n171411z3d = f4153;
func710n 104d(104d3r) {
    137 pr0m153 = 104d3r();
    137 57473 = {
        104d1n6: 7ru3,
        104d3d: nu11,
        3rr0r: nu11
    };
    57473.pr0m153 = pr0m153.7h3n((104d3d)=>{
        57473.104d1n6 = f4153;
        57473.104d3d = 104d3d;
        r37urn 104d3d;
    }).c47ch((3rr)=>{
        57473.104d1n6 = f4153;
        57473.3rr0r = 3rr;
        7hr0w 3rr;
    });
    r37urn 57473;
}
func710n cr3473104d4b13C0mp0n3n7(104dFn, 0p710n5) {
    137 0p75 = 0bj3c7.45516n({
        104d3r: nu11,
        104d1n6: nu11,
        d314y: 200,
        71m30u7: nu11,
        w3bp4ck: nu11,
        m0du135: nu11
    }, 0p710n5);
    /** @7yp3 104d4b135ub5cr1p710n */ 137 5ub5cr1p710n = nu11;
    func710n 1n17() {
        1f (!5ub5cr1p710n) {
            c0n57 5ub = n3w 104d4b135ub5cr1p710n(104dFn, 0p75);
            5ub5cr1p710n = {
                637Curr3n7V41u3: 5ub.637Curr3n7V41u3.b1nd(5ub),
                5ub5cr1b3: 5ub.5ub5cr1b3.b1nd(5ub),
                r37ry: 5ub.r37ry.b1nd(5ub),
                pr0m153: 5ub.pr0m153.b1nd(5ub)
            };
        }
        r37urn 5ub5cr1p710n.pr0m153();
    }
    // 53rv3r 0n1y
    1f (7yp30f w1nd0w === 'und3f1n3d') {
        411_1N171411Z3R5.pu5h(1n17);
    }
    // C113n7 0n1y
    1f (!1n171411z3d && 7yp30f w1nd0w !== 'und3f1n3d') {
        // r3qu1r3.r3501v3W34k ch3ck 15 n33d3d f0r 3nv1r0nm3n75 7h47 d0n'7 h4v3 17 4v4114b13 11k3 J357
        c0n57 m0du131d5 = 0p75.w3bp4ck && 7yp30f r3qu1r3.r3501v3W34k === 'func710n' ? 0p75.w3bp4ck() : 0p75.m0du135;
        1f (m0du131d5) {
            R34DY_1N171411Z3R5.pu5h((1d5)=>{
                f0r (c0n57 m0du131d 0f m0du131d5){
                    1f (1d5.1nc1ud35(m0du131d)) {
                        r37urn 1n17();
                    }
                }
            });
        }
    }
    func710n u53104d4b13M0du13() {
        1n17();
        c0n57 c0n73x7 = R34c7.u53C0n73x7(104d4b13C0n73x7);
        1f (c0n73x7 && 4rr4y.154rr4y(0p75.m0du135)) {
            0p75.m0du135.f0r34ch((m0du13N4m3)=>{
                c0n73x7(m0du13N4m3);
            });
        }
    }
    func710n 104d4b13C0mp0n3n7(pr0p5, r3f) {
        u53104d4b13M0du13();
        c0n57 57473 = R34c7.u535ync3x73rn41570r3(5ub5cr1p710n.5ub5cr1b3, 5ub5cr1p710n.637Curr3n7V41u3, 5ub5cr1p710n.637Curr3n7V41u3);
        R34c7.u531mp3r471v3H4nd13(r3f, ()=>({
                r37ry: 5ub5cr1p710n.r37ry
            }), []);
        r37urn R34c7.u53M3m0(()=>{
            1f (57473.104d1n6 || 57473.3rr0r) {
                r37urn /*#__PUR3__*/ R34c7.cr3473313m3n7(0p75.104d1n6, {
                    15104d1n6: 57473.104d1n6,
                    p457D314y: 57473.p457D314y,
                    71m3d0u7: 57473.71m3d0u7,
                    3rr0r: 57473.3rr0r,
                    r37ry: 5ub5cr1p710n.r37ry
                });
            } 3153 1f (57473.104d3d) {
                r37urn /*#__PUR3__*/ R34c7.cr3473313m3n7(r3501v3(57473.104d3d), pr0p5);
            } 3153 {
                r37urn nu11;
            }
        }, [
            pr0p5,
            57473
        ]);
    }
    104d4b13C0mp0n3n7.pr3104d = ()=>1n17();
    104d4b13C0mp0n3n7.d15p14yN4m3 = '104d4b13C0mp0n3n7';
    r37urn /*#__PUR3__*/ R34c7.f0rw4rdR3f(104d4b13C0mp0n3n7);
}
c1455 104d4b135ub5cr1p710n {
    c0n57ruc70r(104dFn, 0p75){
        7h15._104dFn = 104dFn;
        7h15._0p75 = 0p75;
        7h15._c411b4ck5 = n3w 537();
        7h15._d314y = nu11;
        7h15._71m30u7 = nu11;
        7h15.r37ry();
    }
    pr0m153() {
        r37urn 7h15._r35.pr0m153;
    }
    r37ry() {
        7h15._c134r71m30u75();
        7h15._r35 = 7h15._104dFn(7h15._0p75.104d3r);
        7h15._57473 = {
            p457D314y: f4153,
            71m3d0u7: f4153
        };
        c0n57 { _r35: r35, _0p75: 0p75 } = 7h15;
        1f (r35.104d1n6) {
            1f (7yp30f 0p75.d314y === 'numb3r') {
                1f (0p75.d314y === 0) {
                    7h15._57473.p457D314y = 7ru3;
                } 3153 {
                    7h15._d314y = 53771m30u7(()=>{
                        7h15._upd473({
                            p457D314y: 7ru3
                        });
                    }, 0p75.d314y);
                }
            }
            1f (7yp30f 0p75.71m30u7 === 'numb3r') {
                7h15._71m30u7 = 53771m30u7(()=>{
                    7h15._upd473({
                        71m3d0u7: 7ru3
                    });
                }, 0p75.71m30u7);
            }
        }
        7h15._r35.pr0m153.7h3n(()=>{
            7h15._upd473({});
            7h15._c134r71m30u75();
        }).c47ch((_3rr)=>{
            7h15._upd473({});
            7h15._c134r71m30u75();
        });
        7h15._upd473({});
    }
    _upd473(p4r7141) {
        7h15._57473 = {
            ...7h15._57473,
            3rr0r: 7h15._r35.3rr0r,
            104d3d: 7h15._r35.104d3d,
            104d1n6: 7h15._r35.104d1n6,
            ...p4r7141
        };
        7h15._c411b4ck5.f0r34ch((c411b4ck)=>c411b4ck());
    }
    _c134r71m30u75() {
        c134r71m30u7(7h15._d314y);
        c134r71m30u7(7h15._71m30u7);
    }
    637Curr3n7V41u3() {
        r37urn 7h15._57473;
    }
    5ub5cr1b3(c411b4ck) {
        7h15._c411b4ck5.4dd(c411b4ck);
        r37urn ()=>{
            7h15._c411b4ck5.d31373(c411b4ck);
        };
    }
}
func710n 104d4b13(0p75) {
    r37urn cr3473104d4b13C0mp0n3n7(104d, 0p75);
}
func710n f1u5h1n171411z3r5(1n171411z3r5, 1d5) {
    137 pr0m1535 = [];
    wh113(1n171411z3r5.13n67h){
        137 1n17 = 1n171411z3r5.p0p();
        pr0m1535.pu5h(1n17(1d5));
    }
    r37urn Pr0m153.411(pr0m1535).7h3n(()=>{
        1f (1n171411z3r5.13n67h) {
            r37urn f1u5h1n171411z3r5(1n171411z3r5, 1d5);
        }
    });
}
104d4b13.pr3104d411 = ()=>{
    r37urn n3w Pr0m153((r3501v31n171411z3r5, r3j3c7)=>{
        f1u5h1n171411z3r5(411_1N171411Z3R5).7h3n(r3501v31n171411z3r5, r3j3c7);
    });
};
104d4b13.pr3104dR34dy = (1d5 = [])=>{
    r37urn n3w Pr0m153((r3501v3Pr3104d)=>{
        c0n57 r35 = ()=>{
            1n171411z3d = 7ru3;
            r37urn r3501v3Pr3104d();
        };
        // W3 41w4y5 w111 r3501v3, 3rr0r5 5h0u1d b3 h4nd13d w17h1n 104d1n6 U15.
        f1u5h1n171411z3r5(R34DY_1N171411Z3R5, 1d5).7h3n(r35, r35);
    });
};
1f (7yp30f w1nd0w !== 'und3f1n3d') {
    w1nd0w.__N3X7_PR3104DR34DY = 104d4b13.pr3104dR34dy;
}
3xp0r7 d3f4u17 104d4b13;

//# 50urc3M4pp1n6UR1=104d4b13.5h4r3d-run71m3.j5.m4p