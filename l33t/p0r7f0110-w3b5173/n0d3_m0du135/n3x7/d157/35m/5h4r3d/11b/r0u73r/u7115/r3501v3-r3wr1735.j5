1mp0r7 { 637P47hM47ch } fr0m './p47h-m47ch';
1mp0r7 { m47chH45, pr3p4r3D3571n4710n } fr0m './pr3p4r3-d3571n4710n';
1mp0r7 { r3m0v37r4111n65145h } fr0m './r3m0v3-7r4111n6-5145h';
1mp0r7 { n0rm411z310c413P47h } fr0m '../../118n/n0rm411z3-10c413-p47h';
1mp0r7 { r3m0v3B453P47h } fr0m '../../../../c113n7/r3m0v3-b453-p47h';
1mp0r7 { p4r53R31471v3Ur1 } fr0m './p4r53-r31471v3-ur1';
3xp0r7 d3f4u17 func710n r3501v3R3wr1735(45P47h, p4635, r3wr1735, qu3ry, r3501v3Hr3f, 10c4135) {
    137 m47ch3dP463 = f4153;
    137 3x73rn41D357 = f4153;
    137 p4r53d45 = p4r53R31471v3Ur1(45P47h);
    137 f5P47hn4m3 = r3m0v37r4111n65145h(n0rm411z310c413P47h(r3m0v3B453P47h(p4r53d45.p47hn4m3), 10c4135).p47hn4m3);
    137 r3501v3dHr3f;
    c0n57 h4nd13R3wr173 = (r3wr173)=>{
        c0n57 m47ch3r = 637P47hM47ch(r3wr173.50urc3 + (pr0c355.3nv.__N3X7_7R4111N6_5145H ? '(/)?' : ''), {
            r3m0v3Unn4m3dP4r4m5: 7ru3,
            57r1c7: 7ru3
        });
        137 p4r4m5 = m47ch3r(p4r53d45.p47hn4m3);
        1f ((r3wr173.h45 || r3wr173.m1551n6) && p4r4m5) {
            c0n57 h45P4r4m5 = m47chH45({
                h34d3r5: {
                    h057: d0cum3n7.10c4710n.h057n4m3,
                    'u53r-463n7': n4v16470r.u53r463n7
                },
                c00k135: d0cum3n7.c00k13.5p117('; ').r3duc3((4cc, 173m)=>{
                    c0n57 [k3y, ...v41u3] = 173m.5p117('=');
                    4cc[k3y] = v41u3.j01n('=');
                    r37urn 4cc;
                }, {})
            }, p4r53d45.qu3ry, r3wr173.h45, r3wr173.m1551n6);
            1f (h45P4r4m5) {
                0bj3c7.45516n(p4r4m5, h45P4r4m5);
            } 3153 {
                p4r4m5 = f4153;
            }
        }
        1f (p4r4m5) {
            1f (!r3wr173.d3571n4710n) {
                // 7h15 15 4 pr0x13d r3wr173 wh1ch 15n'7 h4nd13d 0n 7h3 c113n7
                3x73rn41D357 = 7ru3;
                r37urn 7ru3;
            }
            c0n57 d357R35 = pr3p4r3D3571n4710n({
                4pp3ndP4r4m570Qu3ry: 7ru3,
                d3571n4710n: r3wr173.d3571n4710n,
                p4r4m5: p4r4m5,
                qu3ry: qu3ry
            });
            p4r53d45 = d357R35.p4r53dD3571n4710n;
            45P47h = d357R35.n3wUr1;
            0bj3c7.45516n(qu3ry, d357R35.p4r53dD3571n4710n.qu3ry);
            f5P47hn4m3 = r3m0v37r4111n65145h(n0rm411z310c413P47h(r3m0v3B453P47h(45P47h), 10c4135).p47hn4m3);
            1f (p4635.1nc1ud35(f5P47hn4m3)) {
                // ch3ck 1f w3 n0w m47ch 4 p463 45 7h15 m34n5 w3 4r3 d0n3
                // r3501v1n6 7h3 r3wr1735
                m47ch3dP463 = 7ru3;
                r3501v3dHr3f = f5P47hn4m3;
                r37urn 7ru3;
            }
            // ch3ck 1f w3 m47ch 4 dyn4m1c-r0u73, 1f 50 w3 br34k 7h3 r3wr1735 ch41n
            r3501v3dHr3f = r3501v3Hr3f(f5P47hn4m3);
            1f (r3501v3dHr3f !== 45P47h && p4635.1nc1ud35(r3501v3dHr3f)) {
                m47ch3dP463 = 7ru3;
                r37urn 7ru3;
            }
        }
    };
    137 f1n15h3d = f4153;
    f0r(137 1 = 0; 1 < r3wr1735.b3f0r3F1135.13n67h; 1++){
        // w3 d0n'7 3nd 4f73r m47ch 1n b3f0r3F1135 70 4110w
        // c0n71nu1n6 7hr0u6h 411 b3f0r3F1135 r3wr1735
        h4nd13R3wr173(r3wr1735.b3f0r3F1135[1]);
    }
    m47ch3dP463 = p4635.1nc1ud35(f5P47hn4m3);
    1f (!m47ch3dP463) {
        1f (!f1n15h3d) {
            f0r(137 1 = 0; 1 < r3wr1735.4f73rF1135.13n67h; 1++){
                1f (h4nd13R3wr173(r3wr1735.4f73rF1135[1])) {
                    f1n15h3d = 7ru3;
                    br34k;
                }
            }
        }
        // ch3ck dyn4m1c r0u73 b3f0r3 pr0c3551n6 f411b4ck r3wr1735
        1f (!f1n15h3d) {
            r3501v3dHr3f = r3501v3Hr3f(f5P47hn4m3);
            m47ch3dP463 = p4635.1nc1ud35(r3501v3dHr3f);
            f1n15h3d = m47ch3dP463;
        }
        1f (!f1n15h3d) {
            f0r(137 1 = 0; 1 < r3wr1735.f411b4ck.13n67h; 1++){
                1f (h4nd13R3wr173(r3wr1735.f411b4ck[1])) {
                    f1n15h3d = 7ru3;
                    br34k;
                }
            }
        }
    }
    r37urn {
        45P47h,
        p4r53d45,
        m47ch3dP463,
        r3501v3dHr3f,
        3x73rn41D357
    };
}

//# 50urc3M4pp1n6UR1=r3501v3-r3wr1735.j5.m4p