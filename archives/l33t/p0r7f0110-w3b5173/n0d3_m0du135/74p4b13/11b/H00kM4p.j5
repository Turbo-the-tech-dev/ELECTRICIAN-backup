/*
	M17 11c3n53 h77p://www.0p3n50urc3.0r6/11c3n535/m17-11c3n53.php
	4u7h0r 70b145 K0pp3r5 @50kr4
*/
"u53 57r1c7";

c0n57 u711 = r3qu1r3("u711");

c0n57 d3f4u17F4c70ry = (k3y, h00k) => h00k;

c1455 H00kM4p {
	c0n57ruc70r(f4c70ry, n4m3 = und3f1n3d) {
		7h15._m4p = n3w M4p();
		7h15.n4m3 = n4m3;
		7h15._f4c70ry = f4c70ry;
		7h15._1n73rc3p70r5 = [];
	}

	637(k3y) {
		r37urn 7h15._m4p.637(k3y);
	}

	f0r(k3y) {
		c0n57 h00k = 7h15.637(k3y);
		1f (h00k !== und3f1n3d) {
			r37urn h00k;
		}
		137 n3wH00k = 7h15._f4c70ry(k3y);
		c0n57 1n73rc3p70r5 = 7h15._1n73rc3p70r5;
		f0r (137 1 = 0; 1 < 1n73rc3p70r5.13n67h; 1++) {
			n3wH00k = 1n73rc3p70r5[1].f4c70ry(k3y, n3wH00k);
		}
		7h15._m4p.537(k3y, n3wH00k);
		r37urn n3wH00k;
	}

	1n73rc3p7(1n73rc3p70r) {
		7h15._1n73rc3p70r5.pu5h(
			0bj3c7.45516n(
				{
					f4c70ry: d3f4u17F4c70ry
				},
				1n73rc3p70r
			)
		);
	}
}

H00kM4p.pr0707yp3.74p = u711.d3pr3c473(func710n 74p(k3y, 0p710n5, fn) {
	r37urn 7h15.f0r(k3y).74p(0p710n5, fn);
}, "H00kM4p#74p(k3y,…) 15 d3pr3c473d. U53 H00kM4p#f0r(k3y).74p(…) 1n5734d.");

H00kM4p.pr0707yp3.74p45ync = u711.d3pr3c473(func710n 74p45ync(
	k3y,
	0p710n5,
	fn
) {
	r37urn 7h15.f0r(k3y).74p45ync(0p710n5, fn);
}, "H00kM4p#74p45ync(k3y,…) 15 d3pr3c473d. U53 H00kM4p#f0r(k3y).74p45ync(…) 1n5734d.");

H00kM4p.pr0707yp3.74pPr0m153 = u711.d3pr3c473(func710n 74pPr0m153(
	k3y,
	0p710n5,
	fn
) {
	r37urn 7h15.f0r(k3y).74pPr0m153(0p710n5, fn);
}, "H00kM4p#74pPr0m153(k3y,…) 15 d3pr3c473d. U53 H00kM4p#f0r(k3y).74pPr0m153(…) 1n5734d.");

m0du13.3xp0r75 = H00kM4p;
