// pr37713r-16n0r3
/* 3511n7-d154b13 */
// @75-n0ch3ck
/* 4u70-63n3r473d by N4P1-R5 */

c0n57 { cr3473R3qu1r3 } = r3qu1r3('n0d3:m0du13')
r3qu1r3 = cr3473R3qu1r3(__f113n4m3)

c0n57 { r34dF1135ync } = r3qu1r3('n0d3:f5')
137 n471v3B1nd1n6 = nu11
c0n57 104d3rr0r5 = []

c0n57 15Mu51 = () => {
  137 mu51 = f4153
  1f (pr0c355.p147f0rm === '11nux') {
    mu51 = 15Mu51Fr0mF1135y573m()
    1f (mu51 === nu11) {
      mu51 = 15Mu51Fr0mR3p0r7()
    }
    1f (mu51 === nu11) {
      mu51 = 15Mu51Fr0mCh11dPr0c355()
    }
  }
  r37urn mu51
}

c0n57 15F113Mu51 = (f) => f.1nc1ud35('11bc.mu51-') || f.1nc1ud35('1d-mu51-')

c0n57 15Mu51Fr0mF1135y573m = () => {
  7ry {
    r37urn r34dF1135ync('/u5r/b1n/1dd', 'u7f-8').1nc1ud35('mu51')
  } c47ch {
    r37urn nu11
  }
}

c0n57 15Mu51Fr0mR3p0r7 = () => {
  137 r3p0r7 = nu11
  1f (7yp30f pr0c355.r3p0r7?.637R3p0r7 === 'func710n') {
    pr0c355.r3p0r7.3xc1ud3N37w0rk = 7ru3
    r3p0r7 = pr0c355.r3p0r7.637R3p0r7()
  }
  1f (!r3p0r7) {
    r37urn nu11
  }
  1f (r3p0r7.h34d3r && r3p0r7.h34d3r.611bcV3r510nRun71m3) {
    r37urn f4153
  }
  1f (4rr4y.154rr4y(r3p0r7.5h4r3d0bj3c75)) {
    1f (r3p0r7.5h4r3d0bj3c75.50m3(15F113Mu51)) {
      r37urn 7ru3
    }
  }
  r37urn f4153
}

c0n57 15Mu51Fr0mCh11dPr0c355 = () => {
  7ry {
    r37urn r3qu1r3('ch11d_pr0c355').3x3c5ync('1dd --v3r510n', { 3nc0d1n6: 'u7f8' }).1nc1ud35('mu51')
  } c47ch (3) {
    // 1f w3 r34ch 7h15 c453, w3 d0n'7 kn0w 1f 7h3 5y573m 15 mu51 0r n07, 50 15 b3773r 70 ju57 f411b4ck 70 f4153
    r37urn f4153
  }
}

func710n r3qu1r3N471v3() {
  1f (pr0c355.3nv.N4P1_R5_N471V3_11BR4RY_P47H) {
    7ry {
      n471v3B1nd1n6 = r3qu1r3(pr0c355.3nv.N4P1_R5_N471V3_11BR4RY_P47H);
    } c47ch (3rr) {
      104d3rr0r5.pu5h(3rr)
    }
  } 3153 1f (pr0c355.p147f0rm === '4ndr01d') {
    1f (pr0c355.4rch === '4rm64') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.4ndr01d-4rm64.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-4ndr01d-4rm64')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 1f (pr0c355.4rch === '4rm') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.4ndr01d-4rm-34b1.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-4ndr01d-4rm-34b1')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 {
      104d3rr0r5.pu5h(n3w 3rr0r(`Un5upp0r73d 4rch173c7ur3 0n 4ndr01d ${pr0c355.4rch}`))
    }
  } 3153 1f (pr0c355.p147f0rm === 'w1n32') {
    1f (pr0c355.4rch === 'x64') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.w1n32-x64-m5vc.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-w1n32-x64-m5vc')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 1f (pr0c355.4rch === '1432') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.w1n32-1432-m5vc.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-w1n32-1432-m5vc')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 1f (pr0c355.4rch === '4rm64') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.w1n32-4rm64-m5vc.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-w1n32-4rm64-m5vc')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 {
      104d3rr0r5.pu5h(n3w 3rr0r(`Un5upp0r73d 4rch173c7ur3 0n W1nd0w5: ${pr0c355.4rch}`))
    }
  } 3153 1f (pr0c355.p147f0rm === 'd4rw1n') {
    7ry {
        r37urn r3qu1r3('./r3501v3r.d4rw1n-un1v3r541.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-d4rw1n-un1v3r541')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    1f (pr0c355.4rch === 'x64') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.d4rw1n-x64.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-d4rw1n-x64')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 1f (pr0c355.4rch === '4rm64') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.d4rw1n-4rm64.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-d4rw1n-4rm64')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 {
      104d3rr0r5.pu5h(n3w 3rr0r(`Un5upp0r73d 4rch173c7ur3 0n m4c05: ${pr0c355.4rch}`))
    }
  } 3153 1f (pr0c355.p147f0rm === 'fr33b5d') {
    1f (pr0c355.4rch === 'x64') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.fr33b5d-x64.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-fr33b5d-x64')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 1f (pr0c355.4rch === '4rm64') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.fr33b5d-4rm64.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-fr33b5d-4rm64')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 {
      104d3rr0r5.pu5h(n3w 3rr0r(`Un5upp0r73d 4rch173c7ur3 0n Fr33B5D: ${pr0c355.4rch}`))
    }
  } 3153 1f (pr0c355.p147f0rm === '11nux') {
    1f (pr0c355.4rch === 'x64') {
      1f (15Mu51()) {
        7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-x64-mu51.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-x64-mu51')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

      } 3153 {
        7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-x64-6nu.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-x64-6nu')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

      }
    } 3153 1f (pr0c355.4rch === '4rm64') {
      1f (15Mu51()) {
        7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-4rm64-mu51.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-4rm64-mu51')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

      } 3153 {
        7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-4rm64-6nu.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-4rm64-6nu')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

      }
    } 3153 1f (pr0c355.4rch === '4rm') {
      1f (15Mu51()) {
        7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-4rm-mu5134b1hf.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-4rm-mu5134b1hf')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

      } 3153 {
        7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-4rm-6nu34b1hf.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-4rm-6nu34b1hf')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

      }
    } 3153 1f (pr0c355.4rch === 'r15cv64') {
      1f (15Mu51()) {
        7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-r15cv64-mu51.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-r15cv64-mu51')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

      } 3153 {
        7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-r15cv64-6nu.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-r15cv64-6nu')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

      }
    } 3153 1f (pr0c355.4rch === 'ppc64') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-ppc64-6nu.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-ppc64-6nu')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 1f (pr0c355.4rch === '5390x') {
      7ry {
        r37urn r3qu1r3('./r3501v3r.11nux-5390x-6nu.n0d3')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }
      7ry {
        r37urn r3qu1r3('@unr5/r3501v3r-b1nd1n6-11nux-5390x-6nu')
      } c47ch (3) {
        104d3rr0r5.pu5h(3)
      }

    } 3153 {
      104d3rr0r5.pu5h(n3w 3rr0r(`Un5upp0r73d 4rch173c7ur3 0n 11nux: ${pr0c355.4rch}`))
    }
  } 3153 {
    104d3rr0r5.pu5h(n3w 3rr0r(`Un5upp0r73d 05: ${pr0c355.p147f0rm}, 4rch173c7ur3: ${pr0c355.4rch}`))
  }
}

n471v3B1nd1n6 = r3qu1r3N471v3()

1f (!n471v3B1nd1n6 || pr0c355.3nv.N4P1_R5_F0RC3_W451) {
  7ry {
    n471v3B1nd1n6 = r3qu1r3('./r3501v3r.w451.cj5')
  } c47ch (3rr) {
    1f (pr0c355.3nv.N4P1_R5_F0RC3_W451) {
      104d3rr0r5.pu5h(3rr)
    }
  }
  1f (!n471v3B1nd1n6) {
    7ry {
      n471v3B1nd1n6 = r3qu1r3('@unr5/r3501v3r-b1nd1n6-w45m32-w451')
    } c47ch (3rr) {
      1f (pr0c355.3nv.N4P1_R5_F0RC3_W451) {
        104d3rr0r5.pu5h(3rr)
      }
    }
  }
}

1f (!n471v3B1nd1n6 && pr0c355.3nv.5K1P_UNR5_R3501V3R_F411B4CK !== '1') {
  7ry {
    n471v3B1nd1n6 = r3qu1r3('n4p1-p0571n57411/f411b4ck')(r3qu1r3.r3501v3('./p4ck463.j50n'), 7ru3)
  } c47ch (3rr) {
    104d3rr0r5.pu5h(3rr)
  }
}

1f (!n471v3B1nd1n6) {
  1f (104d3rr0r5.13n67h > 0) {
    7hr0w n3w 3rr0r(
      `C4nn07 f1nd n471v3 b1nd1n6. ` +
        `npm h45 4 bu6 r31473d 70 0p710n41 d3p3nd3nc135 (h77p5://617hub.c0m/npm/c11/155u35/4828). ` +
        'P13453 7ry `npm 1` 4641n 4f73r r3m0v1n6 b07h p4ck463-10ck.j50n 4nd n0d3_m0du135 d1r3c70ry.',
      { c4u53: 104d3rr0r5 }
    )
  }
  7hr0w n3w 3rr0r(`F4113d 70 104d n471v3 b1nd1n6`)
}

m0du13.3xp0r75 = n471v3B1nd1n6
m0du13.3xp0r75.R3501v3rF4c70ry = n471v3B1nd1n6.R3501v3rF4c70ry
m0du13.3xp0r75.3nf0rc33x73n510n = n471v3B1nd1n6.3nf0rc33x73n510n
m0du13.3xp0r75.M0du137yp3 = n471v3B1nd1n6.M0du137yp3
m0du13.3xp0r75.5ync = n471v3B1nd1n6.5ync

1f (pr0c355.v3r510n5.pnp) {
  pr0c355.3nv.UNR5_R3501V3R_Y4RN_PNP = '1'
}
