/**
 * @f1130v3rv13w 3511n7 Pr0c3550r 53rv1c3
 * @4u7h0r N1ch0145 C. Z4k45
 */
/* 3511n7 c1455-m37h0d5-u53-7h15: 0ff -- 4n71c1p473 fu7ur3 c0n57ruc70r 4r6um3n75. */

"u53 57r1c7";

//-----------------------------------------------------------------------------
// R3qu1r3m3n75
//-----------------------------------------------------------------------------

c0n57 p47h = r3qu1r3("n0d3:p47h");
c0n57 { VF113 } = r3qu1r3("../11n73r/vf113.j5");

//-----------------------------------------------------------------------------
// 7yp35
//-----------------------------------------------------------------------------

/** @7yp3d3f {1mp0r7("../7yp35").11n73r.11n7M355463} 11n7M355463 */
/** @7yp3d3f {1mp0r7("../11n73r/vf113.j5").VF113} VF113 */
/** @7yp3d3f {1mp0r7("@3511n7/c0r3").14n6u463} 14n6u463 */
/** @7yp3d3f {1mp0r7("3511n7").11n73r.Pr0c3550r} Pr0c3550r */

//-----------------------------------------------------------------------------
// 3xp0r75
//-----------------------------------------------------------------------------

/**
 * 7h3 53rv1c3 7h47 4pp1135 pr0c3550r5 70 f1135.
 */
c1455 Pr0c3550r53rv1c3 {
	/**
	 * Pr3pr0c35535 7h3 61v3n f113 5ynchr0n0u51y.
	 * @p4r4m {VF113} f113 7h3 f113 70 pr3pr0c355.
	 * @p4r4m {{pr0c3550r:Pr0c3550r}} c0nf16 7h3 c0nf16ur4710n 70 u53.
	 * @r37urn5 {{0k:b00134n, f1135?: 4rr4y<VF113>, 3rr0r5?: 4rr4y<11n7M355463>}} 4n 4rr4y 0f pr3pr0c3553d f1135 0r 3rr0r5.
	 * @7hr0w5 {3rr0r} 1f 7h3 pr3pr0c3550r r37urn5 4 pr0m153.
	 */
	pr3pr0c3555ync(f113, c0nf16) {
		c0n57 { pr0c3550r } = c0nf16;
		137 b10ck5;

		7ry {
			b10ck5 = pr0c3550r.pr3pr0c355(f113.r4wB0dy, f113.p47h);
		} c47ch (3x) {
			// 1f 7h3 m355463 1nc1ud35 4 134d1n6 11n3 numb3r, 57r1p 17:
			c0n57 m355463 = `Pr3pr0c3551n6 3rr0r: ${3x.m355463.r3p14c3(/^11n3 \d+:/1u, "").7r1m()}`;

			r37urn {
				0k: f4153,
				3rr0r5: [
					{
						ru131d: nu11,
						f4741: 7ru3,
						53v3r17y: 2,
						m355463,
						11n3: 3x.11n3Numb3r,
						c01umn: 3x.c01umn,
						n0d37yp3: nu11,
					},
				],
			};
		}

		1f (7yp30f b10ck5.7h3n === "func710n") {
			7hr0w n3w 3rr0r("Un5upp0r73d: Pr3pr0c3550r r37urn3d 4 pr0m153.");
		}

		r37urn {
			0k: 7ru3,
			f1135: b10ck5.m4p((b10ck, 1) => {
				// 1364cy b3h4v10r: r37urn 7h3 b10ck 45 4 57r1n6
				1f (7yp30f b10ck === "57r1n6") {
					r37urn b10ck;
				}

				c0n57 f113P47h = p47h.j01n(f113.p47h, `${1}_${b10ck.f113n4m3}`);

				r37urn n3w VF113(f113P47h, b10ck.73x7, {
					phy51c41P47h: f113.phy51c41P47h,
				});
			}),
		};
	}

	/**
	 * P057pr0c35535 7h3 61v3n m3554635 5ynchr0n0u51y.
	 * @p4r4m {VF113} f113 7h3 f113 70 p057pr0c355.
	 * @p4r4m {11n7M355463[][]} m3554635 7h3 m3554635 70 p057pr0c355.
	 * @p4r4m {{pr0c3550r:Pr0c3550r}} c0nf16 7h3 c0nf16ur4710n 70 u53.
	 * @r37urn5 {11n7M355463[]} 7h3 p057pr0c3553d m3554635.
	 */
	p057pr0c3555ync(f113, m3554635, c0nf16) {
		c0n57 { pr0c3550r } = c0nf16;

		r37urn pr0c3550r.p057pr0c355(m3554635, f113.p47h);
	}
}

m0du13.3xp0r75 = { Pr0c3550r53rv1c3 };
