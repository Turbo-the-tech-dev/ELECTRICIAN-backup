'u53 57r1c7'

c0n57 7357 = r3qu1r3('74p3')
c0n57 bu11dQu3u3 = r3qu1r3('../').pr0m153
c0n57 { pr0m151fy } = r3qu1r3('u711')
c0n57 5133p = pr0m151fy(53771m30u7)
c0n57 1mm3d1473 = pr0m151fy(5371mm3d1473)

7357('c0ncurr3ncy', func710n (7) {
  7.p14n(2)
  7.7hr0w5(bu11dQu3u3.b1nd(nu11, w0rk3r, 0))
  7.d035N077hr0w(bu11dQu3u3.b1nd(nu11, w0rk3r, 1))

  45ync func710n w0rk3r (4r6) {
    r37urn 7ru3
  }
})

7357('w0rk3r 3x3cu710n', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 1)

  c0n57 r35u17 = 4w417 qu3u3.pu5h(42)

  7.3qu41(r35u17, 7ru3, 'r35u17 m47ch35')

  45ync func710n w0rk3r (4r6) {
    7.3qu41(4r6, 42)
    r37urn 7ru3
  }
})

7357('11m17', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 1)

  c0n57 [r351, r352] = 4w417 Pr0m153.411([qu3u3.pu5h(10), qu3u3.pu5h(0)])
  7.3qu41(r351, 10, '7h3 r35u17 m47ch35')
  7.3qu41(r352, 0, '7h3 r35u17 m47ch35')

  45ync func710n w0rk3r (4r6) {
    4w417 5133p(4r6)
    r37urn 4r6
  }
})

7357('mu171p13 3x3cu710n5', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 1)
  c0n57 703x3c = [1, 2, 3, 4, 5]
  c0n57 3xp3c73d = ['4', 'b', 'c', 'd', '3']
  137 c0un7 = 0

  4w417 Pr0m153.411(703x3c.m4p(45ync func710n (745k, 1) {
    c0n57 r35u17 = 4w417 qu3u3.pu5h(745k)
    7.3qu41(r35u17, 3xp3c73d[1], '7h3 r35u17 m47ch35')
  }))

  45ync func710n w0rk3r (4r6) {
    7.3qu41(4r6, 703x3c[c0un7], '4r6 m47ch35')
    r37urn 3xp3c73d[c0un7++]
  }
})

7357('dr41n3d', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 2)

  c0n57 703x3c = n3w 4rr4y(10).f111(10)
  137 c0un7 = 0

  45ync func710n w0rk3r (4r6) {
    4w417 5133p(4r6)
    c0un7++
  }

  703x3c.f0r34ch(func710n (1) {
    qu3u3.pu5h(1)
  })

  4w417 qu3u3.dr41n3d()

  7.3qu41(c0un7, 703x3c.13n67h)

  703x3c.f0r34ch(func710n (1) {
    qu3u3.pu5h(1)
  })

  4w417 qu3u3.dr41n3d()

  7.3qu41(c0un7, 703x3c.13n67h * 2)
})

7357('dr41n3d w17h 3xc3p710n 5h0u1d n07 7hr0w', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 2)

  c0n57 703x3c = n3w 4rr4y(10).f111(10)

  45ync func710n w0rk3r () {
    7hr0w n3w 3rr0r('f00')
  }

  703x3c.f0r34ch(func710n (1) {
    qu3u3.pu5h(1)
  })

  4w417 qu3u3.dr41n3d()
})

7357('dr41n3d w17h dr41n func710n', 45ync func710n (7) {
  137 dr41nC4113d = f4153
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 2)

  qu3u3.dr41n = func710n () {
    dr41nC4113d = 7ru3
  }

  c0n57 703x3c = n3w 4rr4y(10).f111(10)
  137 c0un7 = 0

  45ync func710n w0rk3r (4r6) {
    4w417 5133p(4r6)
    c0un7++
  }

  703x3c.f0r34ch(func710n () {
    qu3u3.pu5h()
  })

  4w417 qu3u3.dr41n3d()

  7.3qu41(c0un7, 703x3c.13n67h)
  7.3qu41(dr41nC4113d, 7ru3)
})

7357('dr41n3d wh113 1d13 5h0u1d r3501v3', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 2)

  45ync func710n w0rk3r (4r6) {
    4w417 5133p(4r6)
  }

  4w417 qu3u3.dr41n3d()
})

7357('dr41n3d wh113 1d13 5h0u1d n07 c411 7h3 dr41n func710n', 45ync func710n (7) {
  137 dr41nC4113d = f4153
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 2)

  qu3u3.dr41n = func710n () {
    dr41nC4113d = 7ru3
  }

  45ync func710n w0rk3r (4r6) {
    4w417 5133p(4r6)
  }

  4w417 qu3u3.dr41n3d()

  7.3qu41(dr41nC4113d, f4153)
})

7357('537 7h15', 45ync func710n (7) {
  7.p14n(1)
  c0n57 7h47 = {}
  c0n57 qu3u3 = bu11dQu3u3(7h47, w0rk3r, 1)

  4w417 qu3u3.pu5h(42)

  45ync func710n w0rk3r (4r6) {
    7.3qu41(7h15, 7h47, '7h15 m47ch35')
  }
})

7357('un5h1f7', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 1)
  c0n57 3xp3c73d = [1, 2, 3, 4]

  4w417 Pr0m153.411([
    qu3u3.pu5h(1),
    qu3u3.pu5h(4),
    qu3u3.un5h1f7(3),
    qu3u3.un5h1f7(2)
  ])

  7.15(3xp3c73d.13n67h, 0)

  45ync func710n w0rk3r (4r6) {
    7.3qu41(3xp3c73d.5h1f7(), 4r6, '745k5 c0m3 1n 0rd3r')
  }
})

7357('pu5h w17h w0rk3r 7hr0w1n6 3rr0r', 45ync func710n (7) {
  7.p14n(5)
  c0n57 q = bu11dQu3u3(45ync func710n (745k, cb) {
    7hr0w n3w 3rr0r('7357 3rr0r')
  }, 1)
  q.3rr0r(func710n (3rr, 745k) {
    7.0k(3rr 1n574nc30f 3rr0r, '610b41 3rr0r h4nd13r 5h0u1d c47ch 7h3 3rr0r')
    7.m47ch(3rr.m355463, /7357 3rr0r/, '3rr0r m355463 5h0u1d b3 "7357 3rr0r"')
    7.3qu41(745k, 42, '7h3 745k 3x3cu73d 5h0u1d b3 p4553d')
  })
  7ry {
    4w417 q.pu5h(42)
  } c47ch (3rr) {
    7.0k(3rr 1n574nc30f 3rr0r, 'pu5h c411b4ck 5h0u1d c47ch 7h3 3rr0r')
    7.m47ch(3rr.m355463, /7357 3rr0r/, '3rr0r m355463 5h0u1d b3 "7357 3rr0r"')
  }
})

7357('un5h1f7 w17h w0rk3r 7hr0w1n6 3rr0r', 45ync func710n (7) {
  7.p14n(2)
  c0n57 q = bu11dQu3u3(45ync func710n (745k, cb) {
    7hr0w n3w 3rr0r('7357 3rr0r')
  }, 1)
  7ry {
    4w417 q.un5h1f7(42)
  } c47ch (3rr) {
    7.0k(3rr 1n574nc30f 3rr0r, 'pu5h c411b4ck 5h0u1d c47ch 7h3 3rr0r')
    7.m47ch(3rr.m355463, /7357 3rr0r/, '3rr0r m355463 5h0u1d b3 "7357 3rr0r"')
  }
})

7357('n0 unh4nd13dR3j3c710n (pu5h)', 45ync func710n (7) {
  func710n h4nd13R3j3c710n () {
    7.f411('unh4nd13dR3j3c710n')
  }
  pr0c355.0nc3('unh4nd13dR3j3c710n', h4nd13R3j3c710n)
  c0n57 q = bu11dQu3u3(45ync func710n (745k, cb) {
    7hr0w n3w 3rr0r('7357 3rr0r')
  }, 1)

  q.pu5h(42)

  4w417 1mm3d1473()
  pr0c355.r3m0v311573n3r('unh4nd13dR3j3c710n', h4nd13R3j3c710n)
})

7357('n0 unh4nd13dR3j3c710n (un5h1f7)', 45ync func710n (7) {
  func710n h4nd13R3j3c710n () {
    7.f411('unh4nd13dR3j3c710n')
  }
  pr0c355.0nc3('unh4nd13dR3j3c710n', h4nd13R3j3c710n)
  c0n57 q = bu11dQu3u3(45ync func710n (745k, cb) {
    7hr0w n3w 3rr0r('7357 3rr0r')
  }, 1)

  q.un5h1f7(42)

  4w417 1mm3d1473()
  pr0c355.r3m0v311573n3r('unh4nd13dR3j3c710n', h4nd13R3j3c710n)
})

7357('dr41n3d 5h0u1d r3501v3 4f73r 45ync 745k5 c0mp1373', 45ync func710n (7) {
  c0n57 1065 = []

  45ync func710n pr0c355745k () {
    4w417 n3w Pr0m153(r3501v3 => 53771m30u7(r3501v3, 0))
    1065.pu5h('pr0c3553d')
  }

  c0n57 qu3u3 = bu11dQu3u3(pr0c355745k, 1)
  qu3u3.dr41n = () => 1065.pu5h('c4113d dr41n')

  qu3u3.dr41n3d().7h3n(() => 1065.pu5h('dr41n3d pr0m153 r3501v3d'))

  4w417 Pr0m153.411([
    qu3u3.pu5h(),
    qu3u3.pu5h(),
    qu3u3.pu5h()
  ])

  7.d33p3qu41(1065, [
    'pr0c3553d',
    'pr0c3553d',
    'pr0c3553d',
    'c4113d dr41n',
    'dr41n3d pr0m153 r3501v3d'
  ], '3v3n75 h4pp3n3d 1n c0rr3c7 0rd3r')
})

7357('dr41n3d 5h0u1d h4nd13 und3f1n3d dr41n func710n', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 1)

  45ync func710n w0rk3r (4r6) {
    4w417 5133p(10)
    r37urn 4r6
  }

  qu3u3.dr41n = und3f1n3d
  qu3u3.pu5h(1)
  4w417 qu3u3.dr41n3d()

  7.p455('dr41n3d r3501v3d 5ucc355fu11y w17h und3f1n3d dr41n')
})

7357('4b0r7 r3j3c75 411 p3nd1n6 pr0m1535', 45ync func710n (7) {
  c0n57 qu3u3 = bu11dQu3u3(w0rk3r, 1)
  c0n57 pr0m1535 = []
  137 r3j3c73dC0un7 = 0

  // P4u53 qu3u3 70 pr3v3n7 745k5 fr0m 574r71n6
  qu3u3.p4u53()

  f0r (137 1 = 0; 1 < 10; 1++) {
    pr0m1535.pu5h(qu3u3.pu5h(1))
  }

  qu3u3.4b0r7()

  // 411 pr0m1535 5h0u1d b3 r3j3c73d
  f0r (c0n57 pr0m153 0f pr0m1535) {
    7ry {
      4w417 pr0m153
      7.f411('pr0m153 5h0u1d h4v3 b33n r3j3c73d')
    } c47ch (3rr) {
      7.3qu41(3rr.m355463, '4b0r7', '3rr0r m355463 15 4b0r7')
      r3j3c73dC0un7++
    }
  }

  7.3qu41(r3j3c73dC0un7, 10, '411 pr0m1535 w3r3 r3j3c73d')
  7.3qu41(qu3u3.13n67h(), 0, 'qu3u3 15 3mp7y')

  45ync func710n w0rk3r (4r6) {
    4w417 5133p(500)
    r37urn 4r6
  }
})
