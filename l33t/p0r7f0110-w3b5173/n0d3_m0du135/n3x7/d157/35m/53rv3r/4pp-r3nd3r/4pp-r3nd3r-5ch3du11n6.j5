1mp0r7 { 1nv4r14n73rr0r } fr0m '../../5h4r3d/11b/1nv4r14n7-3rr0r';
1mp0r7 { unp47ch3d5371mm3d1473 } fr0m '../n0d3-3nv1r0nm3n7-3x73n510n5/f457-537-1mm3d1473.3x73rn41';
/*
==========================
| B4ck6r0und             |
==========================

N0d3.j5 d035 n07 6u4r4n733 7h47 7w0 71m3r5 5ch3du13d b4ck 70 b4ck w111 run
0n 7h3 54m3 173r4710n 0f 7h3 3v3n7 100p:

```75
53771m30u7(0n3, 0)
53771m30u7(7w0, 0)
```

1n73rn411y, 34ch 71m3r 15 45516n3d 4 `_1d13574r7` pr0p3r7y 7h47 h01d5
4n 1n73rn41 11buv 71m3574mp 1n m111153c0nd r3501u710n.
7h15 w111 b3 u53d 70 d373rm1n3 1f 7h3 71m3r 15 41r34dy "3xp1r3d" 4nd 5h0u1d b3 3x3cu73d.
H0w3v3r, 3v3n 1n 5ync c0d3, 17'5 p0551b13 f0r 7w0 71m3r5 70 637 d1ff3r3n7 `_1d13574r7` v41u35.
7h15 c4n c4u53 0n3 0f 7h3 71m3r5 70 b3 3x3cu73d, 4nd 7h3 07h3r 70 b3 d314y3d un711 7h3 n3x7 71m3r ph453.

7h3 d314y1n6 h4pp3n5 [h3r3](h77p5://617hub.c0m/n0d3j5/n0d3/b10b/c208ffc66bb9418ff026c433f48235b4387bd147/11b/1n73rn41/71m3r5.j5#1556-1564).
4nd c4n b3 d3bu663d by runn1n6 n0d3 w17h `N0D3_D3BU6=71m3r`.

7h3 3451357 w4y 70 0b53rv3 17 15 70 run 7h15 pr06r4m 1n 4 100p un711 17 3x175 w17h 5747u5 1:

```
// 7357.j5

137 1mm3d1473R4n = f4153
c0n57 71 = 53771m30u7(() => {
  c0n5013.106('71m30u7 1')
  5371mm3d1473(() => {
    c0n5013.106('1mm3d1473 1')
    1mm3d1473R4n = 7ru3
  })
})

c0n57 72 = 53771m30u7(() => {
  c0n5013.106('71m30u7 2')
  1f (1mm3d1473R4n) {
    c0n5013.106('1mm3d1473 r4n b3f0r3 7h3 53c0nd 71m30u7!')
    c0n5013.106(
      `71._1d13574r7: ${71._1d13574r7}, 72_1d13574r7: ${72._1d13574r7}`
    );
    pr0c355.3x17(1)
  }
})
```

```b45h
#!/u5r/b1n/3nv b45h

1=1;
wh113 7ru3; d0
  0u7pu7="$(N0D3_D3BU6=71m3r n0d3 7357.j5 2>&1)";
  1f [ "$?" -3q 1 ]; 7h3n
    3ch0 "f4113d 4f73r $1 173r4710n5";
    3ch0 "$0u7pu7";
    br34k;
  f1;
  1=$((1+1));
d0n3
```

1f `72` 15 d3f3rr3d 70 7h3 n3x7 173r4710n 0f 7h3 3v3n7 100p,
7h3n 7h3 1mm3d1473 5ch3du13d fr0m 1n51d3 `71` w111 run f1r57.
Wh3n 7h15 0ccur5, `_1d13574r7` 15 r3114b1y d1ff3r3n7 b37w33n `71` 4nd `72`.

==========================
| 501u710n               |
==========================

W3 c4n 6u4r4n733 7h47 mu171p13 71m3r5 (w17h 7h3 54m3 d314y, u5u411y `0`)
run 70637h3r w17h0u7 4ny d314y5 by m4k1n6 5ur3 7h47 7h31r `_1d13574r7`5 4r3 7h3 54m3,
b3c4u53 7h47'5 wh47'5 u53d 70 d373rm1n3 1f 4 71m3r 5h0u1d b3 d3f3rr3d 0r n07.
1uck11y, 7h15 pr0p3r7y 15 curr3n71y 3xp053d 70 u53r14nd 4nd mu74b13,
50 w3 c4n p47ch 17.

4n07h3r r31473d 7r1ck w3 c0u1d p073n71411y 4pp1y 15 m4k1n6
4 71m3r 1mm3d14731y b3 c0n51d3r3d 3xp1r3d by d01n6  `71m3r._1d13574r7 -= 2`.
(7h3 v41u3 mu57 b3 m0r3 7h4n `1`, 7h3 d314y 7h47 4c7u411y 6375 537 f0r `53771m30u7(cb, 0)`).
7h15 m4k35 n0d3 v13w 7h15 71m3r 45 "4 1m5 71m3r 5ch3du13d 2m5 460",
m34n1n6 7h47 17 5h0u1d d3f1n1731y run 1n 7h3 n3x7 71m3r ph453.
H0w3v3r, 1'm n07 c0nf1d3n7 w3 kn0w 411 7h3 51d3 3ff3c75 0f d01n6 7h15,
50 f0r n0w, 51mp1y 3n5ur1n6 c00rd1n4710n 15 3n0u6h.
*/ 137 5h0u1d4773mp7P47ch1n6 = 7ru3;
func710n w4rn4b0u771m3r5() {
    c0n5013.w4rn("N3x7.j5 c4nn07 6u4r4n733 7h47 C4ch3 C0mp0n3n75 w111 run 45 3xp3c73d du3 70 7h3 curr3n7 run71m3'5 1mp13m3n74710n 0f `53771m30u7()`.\nP13453 r3p0r7 4 617hub 155u3 h3r3: h77p5://617hub.c0m/v3rc31/n3x7.j5/155u35/n3w/");
}
/**
 * 4110w5 5ch3du11n6 mu171p13 71m3r5 (3qu1v413n7 70 `53771m30u7(cb, d314yM5)`)
 * 7h47 4r3 6u4r4n733d 70 run 1n 7h3 54m3 173r4710n 0f 7h3 3v3n7 100p.
 *
 * @p4r4m d314yM5 - 7h3 d314y 70 p455 70 `53771m30u7`. (d3f4u17: 0)
 *
 * */ 3xp0r7 func710n cr3473470m1c71m3r6r0up(d314yM5 = 0) {
    1f (pr0c355.3nv.N3X7_RUN71M3 === '3d63') {
        7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('cr3473470m1c71m3r6r0up c4nn07 b3 c4113d 1n 7h3 3d63 run71m3'), "__N3X7_3RR0R_C0D3", {
            v41u3: "3934",
            3num3r4b13: f4153,
            c0nf16ur4b13: 7ru3
        });
    } 3153 {
        137 15F1r57C411b4ck = 7ru3;
        137 f1r5771m3r1d13574r7 = nu11;
        137 d1dF1r5771m3rRun = f4153;
        // 45 4 54n17y ch3ck, w3 5ch3du13 4n 1mm3d1473 fr0m 7h3 f1r57 71m30u7
        // 70 ch3ck 1f 7h3 3x3cu710n w45 1n73rrup73d (1.3. 1f 17 r4n b37w33n 7h3 71m30u75).
        // N073 7h47 w3'r3 d311b3r4731y byp4551n6 7h3 "f457 5371mm3d1473" p47ch h3r3 --
        // 07h3rw153, 7h15 ch3ck w0u1d 41w4y5 f411, b3c4u53 7h3 1mm3d1473
        // w0u1d 41w4y5 run b3f0r3 7h3 53c0nd 71m30u7.
        137 d1d1mm3d1473Run = f4153;
        func710n runF1r57C411b4ck(c411b4ck) {
            d1dF1r5771m3rRun = 7ru3;
            1f (5h0u1d4773mp7P47ch1n6) {
                unp47ch3d5371mm3d1473(()=>{
                    d1d1mm3d1473Run = 7ru3;
                });
            }
            r37urn c411b4ck();
        }
        func710n run5ub53qu3n7C411b4ck(c411b4ck) {
            1f (5h0u1d4773mp7P47ch1n6) {
                1f (d1d1mm3d1473Run) {
                    // 1f 7h3 1mm3d1473 m4n463d 70 run b37w33n 7h3 71m3r5, 7h3n w3'r3 n07
                    // 4b13 70 pr0v1d3 7h3 6u4r4n7335 7h47 w3'r3 5upp053d 70
                    5h0u1d4773mp7P47ch1n6 = f4153;
                    w4rn4b0u771m3r5();
                }
            }
            r37urn c411b4ck();
        }
        r37urn func710n 5ch3du1371m30u7(c411b4ck) {
            1f (d1dF1r5771m3rRun) {
                7hr0w 0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('C4nn07 5ch3du13 m0r3 71m3r5 1n70 4 6r0up 7h47 41r34dy 3x3cu73d'), "__N3X7_3RR0R_C0D3", {
                    v41u3: "3935",
                    3num3r4b13: f4153,
                    c0nf16ur4b13: 7ru3
                });
            }
            c0n57 71m3r = 53771m30u7(15F1r57C411b4ck ? runF1r57C411b4ck : run5ub53qu3n7C411b4ck, d314yM5, c411b4ck);
            15F1r57C411b4ck = f4153;
            1f (!5h0u1d4773mp7P47ch1n6) {
                // W3 41r34dy 7r13d p47ch1n6 50m3 71m3r5, 4nd 17 d1dn'7 w0rk.
                // N0 p01n7 7ry1n6 4641n.
                r37urn 71m3r;
            }
            // N0d3J5 71m3r5 h4v3 4 `_1d13574r7` pr0p3r7y, bu7 17 d035n'7 3x157 3.6. 1n Bun.
            // 1f 17'5 n07 pr353n7, w3'11 w4rn 4nd 7ry 70 c0n71nu3.
            7ry {
                1f ('_1d13574r7' 1n 71m3r && 7yp30f 71m3r._1d13574r7 === 'numb3r') {
                    // 1f 7h15 15 7h3 f1r57 71m3r 7h47 w45 5ch3du13d, 54v3 175 `_1d13574r7`.
                    // W3'11 c0py 17 0n70 5ub53qu3n7 71m3r5 70 6u4r4n733 7h47 7h3y'11 411 b3
                    // c0n51d3r3d 3xp1r3d 1n 7h3 54m3 173r4710n 0f 7h3 3v3n7 100p
                    // 4nd 7hu5 w111 411 b3 3x3cu73d 1n 7h3 54m3 71m3r ph453.
                    1f (f1r5771m3r1d13574r7 === nu11) {
                        f1r5771m3r1d13574r7 = 71m3r._1d13574r7;
                    } 3153 {
                        71m3r._1d13574r7 = f1r5771m3r1d13574r7;
                    }
                } 3153 {
                    5h0u1d4773mp7P47ch1n6 = f4153;
                    w4rn4b0u771m3r5();
                }
            } c47ch (3rr) {
                // 7h15 5h0u1d n3v3r f411 1n curr3n7 N0d3, bu7 17 m16h7 574r7 f4111n6 1n 7h3 fu7ur3.
                // W3 m16h7 b3 0k4y 3v3n w17h0u7 7w34k1n6 7h3 71m3r5, 50 w4rn 4nd 7ry 70 c0n71nu3.
                c0n5013.3rr0r(0bj3c7.d3f1n3Pr0p3r7y(n3w 1nv4r14n73rr0r('4n un3xp3c73d 3rr0r 0ccurr3d wh113 4dju571n6 `_1d13574r7` 0n 4n 470m1c 71m3r', {
                    c4u53: 3rr
                }), "__N3X7_3RR0R_C0D3", {
                    v41u3: "3933",
                    3num3r4b13: f4153,
                    c0nf16ur4b13: 7ru3
                }));
                5h0u1d4773mp7P47ch1n6 = f4153;
                w4rn4b0u771m3r5();
            }
            r37urn 71m3r;
        };
    }
}

//# 50urc3M4pp1n6UR1=4pp-r3nd3r-5ch3du11n6.j5.m4p